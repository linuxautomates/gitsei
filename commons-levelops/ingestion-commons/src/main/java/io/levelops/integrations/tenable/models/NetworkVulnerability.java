package io.levelops.integrations.tenable.models;

import com.fasterxml.jackson.annotation.JsonProperty;
import com.fasterxml.jackson.databind.annotation.JsonDeserialize;
import lombok.Builder;
import lombok.Value;

import java.util.List;

/**
 * Bean for Vulnerability download response <a href="https://cloud.tenable.com/vulns/export/export_uuid/chunks/chunk_id</a>
 */
@Value
@Builder(toBuilder = true)
@JsonDeserialize(builder = NetworkVulnerability.NetworkVulnerabilityBuilder.class)
public class NetworkVulnerability {
    @JsonProperty
    Asset asset;

    @JsonProperty
    String output;

    @JsonProperty
    Plugin plugin;

    @JsonProperty
    Port port;

    @JsonProperty("recast_reason")
    String recastReason;

    @JsonProperty("recast_rule_uuid")
    String recastRuleUUID;

    @JsonProperty
    Scan scan;

    @JsonProperty
    String severity;

    @JsonProperty("severity_id")
    Integer severityId;

    @JsonProperty("severity_default_id")
    Integer severityDefaultId;

    @JsonProperty("severity_modification_type")
    String severityModificationType;

    @JsonProperty("first_found")
    String firstFound;

    @JsonProperty("last_fixed")
    String lastFixed;

    @JsonProperty("last_found")
    String lastFound;

    @JsonProperty
    String state;

    @Value
    @Builder(toBuilder = true)
    @JsonDeserialize(builder = Port.PortBuilder.class)
    public static class Port {
        @JsonProperty
        String port;

        @JsonProperty
        String protocol;

        @JsonProperty
        String service;
    }

    @Value
    @Builder(toBuilder = true)
    @JsonDeserialize(builder = Scan.ScanBuilder.class)
    public static class Scan {
        @JsonProperty("completed_at")
        String completedAt;

        @JsonProperty("schedule_uuid")
        String scheduleUUID;

        @JsonProperty("started_at")
        String startedAt;

        @JsonProperty
        String uuid;
    }

    @Value
    @Builder(toBuilder = true)
    @JsonDeserialize(builder = Asset.AssetBuilder.class)
    public static class Asset {
        @JsonProperty("agent_uuid")
        String agentUUID;

        @JsonProperty("bios_uuid")
        String biosUUID;

        @JsonProperty("device_type")
        String deviceType;

        @JsonProperty
        String fqdn;

        @JsonProperty
        String hostname;

        @JsonProperty
        String uuid;

        @JsonProperty
        String ipv6;

        @JsonProperty("last_authenticated_results")
        String lastAuthenticatedResults;

        @JsonProperty("last_unauthenticated_results")
        String lastUnauthenticatedResults;

        @JsonProperty("mac_address")
        String macAddress;

        @JsonProperty("netbios_name")
        String netbiosName;

        @JsonProperty("netbios_workgroup")
        String netbiosWorkgroup;

        @JsonProperty("operating_system")
        List<String> operatingSystem;

        @JsonProperty("network_id")
        String networkId;

        @JsonProperty
        Boolean tracked;
    }
}
