{
  "records": [
    {
      "id": "hashicorp/vault",
      "name": "vault",
      "owner": {
        "type": "organization",
        "login": "hashicorp"
      },
      "owner_name": "hashicorp",
      "owner_type": "organization",
      "html_url": "https://github.com/hashicorp/vault",
      "master_branch": "master",
      "created_at": 1424823359000,
      "pushed_at": 1595019454000,
      "updated_at": 1595017827000,
      "size": 123698,
      "is_private": false,
      "languages": {
        "Go": 1
      },
      "issues": [
        {
          "id": "644183081",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDM4ODUyMjU2",
          "number": 9302,
          "html_url": "https://github.com/hashicorp/vault/pull/9302",
          "title": "Add ability to specify region for OCI Storage Backend",
          "user": {
            "type": "user",
            "login": "jwitko"
          },
          "labels": [],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 2,
          "created_at": 1592950517000,
          "updated_at": 1594432592000,
          "author_association": "NONE",
          "body": "This pull request adds the use of an OCI SDK function to the OCI Storage Backend for allowing the explicit setting of an OCI region to the ObjectStorage client.  \r\n\r\nThe current behavior is to use the SDK default behavior which pulls the region from the OCI credentials configuration.  \r\n\r\nThis behavior has not been changed in the event a region is not specified in the storage backend config.",
          "events": []
        },
        {
          "id": "439465860",
          "node_id": "MDU6SXNzdWU0Mzk0NjU4NjA=",
          "number": 6670,
          "html_url": "https://github.com/hashicorp/vault/issues/6670",
          "title": "LDAP auth method: support client certificate authentication",
          "user": {
            "type": "user",
            "login": "mberhault"
          },
          "labels": [
            {
              "id": "1657599041",
              "node_id": "MDU6TGFiZWwxNjU3NTk5MDQx",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/auth/ldap",
              "name": "auth/ldap",
              "color": "f968e8",
              "description": "",
              "default": false
            },
            {
              "id": "1488905226",
              "node_id": "MDU6TGFiZWwxNDg4OTA1MjI2",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/enhancement",
              "name": "enhancement",
              "color": "0d8232",
              "description": "",
              "default": true
            }
          ],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 18,
          "created_at": 1556783596000,
          "updated_at": 1594486226000,
          "author_association": "NONE",
          "body": "**Is your feature request related to a problem? Please describe.**\r\nUsing [GSuite Secure LDAP](https://support.google.com/a/answer/9048516?hl=en) as the LDAP server for the [LDAP auth method](https://www.vaultproject.io/docs/auth/ldap.html) is not currently possible directly due the use of client certificates for client authentication with the LDAP server. Use of the system pool for server certificate verification may also be an issue (I have not checked).\r\n\r\n**Describe the solution you'd like**\r\nThe following additional fields in the [/auth/ldap/config endpoint](https://www.vaultproject.io/api/auth/ldap/index.html#configure-ldap) should be sufficient:\r\n- path to client certificate\r\n- path to client key\r\n- empty \"certificate\" field means \"use the system pool\" (unclear whether that's already the case)\r\n\r\n**Describe alternatives you've considered**\r\nIt is possible to use stunnel to get around this restriction. This is the workaround included in the [gsuite LDAP connection docs](https://support.google.com/a/answer/9089736?hl=en).\r\n\r\n**Explain any additional use-cases**\r\nUnsure about client certificate authentication for other LDAP server. I suspect this may be useful elsewhere.\r\n\r\n**Additional context**\r\nUsername and password are not required but can still be provided.\r\nPlease see the linked [gsuite docs](https://support.google.com/a/answer/9089736?hl=en) for more details about client configuration.\r\n\r\n[GSuite secure LDAP](https://support.google.com/a/answer/9048516?hl=en) is for enterprise GSuite accounts only. I am happy to provide an environment to help develop/test this.",
          "events": [
            {
              "id": 530746421,
              "created_at": 1568280824000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/530746421",
              "actor": "AeroNotix",
              "body": "I've been trying to get this working for the last day using Gsuite LDAP and Vault. I have not yet succeeded.\r\n\r\nDid you manage to get this to work?\r\n\r\nWhat I tried:\r\n\r\n* Using `stunnel` I set the certificates and dropped `ldaps` at that point, run `stunnel` on `127.0.0.1`. Vault config:\r\n\r\n```\r\nvault write auth/ldap/config \\\r\n  url=\"ldap://127.0.0.1:1636\" \\\r\n  discoverdn=true \\\r\n  userdn=\"ou=Users,dc=ourcompanyname,dc=com\"\r\n  starttls=false \\\r\n  userattr=\"uid\" \\\r\n  deny_null_bind=true\r\n```\r\n\r\nStunnel conf:\r\n\r\n```\r\ndebug = 7\r\noutput = /etc/stunnel/google-ldap.log\r\n[ldap]\r\nclient = yes\r\naccept = 127.0.0.1:1636\r\nconnect = ldap.google.com:636\r\ncert = /etc/ssl/ldap-cert.crt\r\nkey = /etc/ssl/ldap-key.key\r\n```\r\n\r\nOutcome: \r\n\r\n* Vault makes an initial `simple bindingRequest` through LDAP (verified with Wireshark) but receives no results. Testing with `ldapsearch` yields the same results, an anonymous bind returns nothing.\r\n\r\nThere's a small bit of information on the [Google docs]( https://support.google.com/a/answer/9190869?hl=en) for this:\r\n\r\n```\r\nldapsearch returns status 0 (success) but no users are outputs\r\n\r\nSpecifying ldapsearch option -x (use SASL authentication) with client certificates will successfully authenticate but will not list users in the domain.\r\n\r\nRecommendation: Remove the option -x and try again.\r\n```\r\n\r\nBut in order to test with `ldapsearch` with the version I have on my system, I _must_ pass the `-x` parameter in order for `ldapsearch` to test due to the fact the certs Google provide you are self-signed. I will build `ldapsearch` locally with different compile flags enabled which could change how self-signed certs are handled.\r\n\r\nI built vault v1.2.0 locally to insert some additional debugging and I can confirm it is attempting to use anonymous binds (go-ldap library in the vendor libs).\r\n\r\nAt a loss as to what to try next.\r\n\r\n\r\n",
              "user": "AeroNotix",
              "html_url": "https://github.com/hashicorp/vault/issues/6670#issuecomment-530746421"
            },
            {
              "id": 534435025,
              "created_at": 1569311058000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/534435025",
              "actor": "stephenrjohnson",
              "body": "@AeroNotix did you get this to work?",
              "user": "stephenrjohnson",
              "html_url": "https://github.com/hashicorp/vault/issues/6670#issuecomment-534435025"
            },
            {
              "id": 2657008810,
              "created_at": 1569311059000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/2657008810",
              "actor": "AeroNotix"
            },
            {
              "id": 2657008812,
              "created_at": 1569311059000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/2657008812",
              "actor": "AeroNotix"
            },
            {
              "id": 534443472,
              "created_at": 1569312411000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/534443472",
              "actor": "AeroNotix",
              "body": "Hi,\r\n\r\nKinda sorta.\r\n\r\nI can get authentication working with vault and google groups:\r\n\r\n* Use stunnel\r\n* Use user principle binds\r\n* Disable verify TLS\r\n\r\nThis will authenticate users. (If the above doesn't work for you then I can get you my config to make it work). However, it will not allow groups to work. I've tried various configuration to get groups working but when accessing Google LDAP through Stunnel, it seems some operations don't work as expected? At least that what it seems like.",
              "user": "AeroNotix",
              "html_url": "https://github.com/hashicorp/vault/issues/6670#issuecomment-534443472"
            },
            {
              "id": 535007310,
              "created_at": 1569415960000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/535007310",
              "actor": "stephenrjohnson",
              "body": "That's a shame the whole reason we paid for google cloud identity was to get vault ldap working with groups in there. ",
              "user": "stephenrjohnson",
              "html_url": "https://github.com/hashicorp/vault/issues/6670#issuecomment-535007310"
            },
            {
              "id": 535009872,
              "created_at": 1569416347000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/535009872",
              "actor": "AeroNotix",
              "body": "@stephenrjohnson I am not saying it is impossible - I am saying I couldn't figure out how to do it.",
              "user": "AeroNotix",
              "html_url": "https://github.com/hashicorp/vault/issues/6670#issuecomment-535009872"
            },
            {
              "id": 2661584575,
              "created_at": 1569416347000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/2661584575",
              "actor": "stephenrjohnson"
            },
            {
              "id": 2661584576,
              "created_at": 1569416347000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/2661584576",
              "actor": "stephenrjohnson"
            },
            {
              "id": 2779694112,
              "created_at": 1573139415000,
              "event": "labeled",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/2779694112",
              "actor": "michelvocks",
              "label": "auth/ldap"
            },
            {
              "id": 2779694114,
              "created_at": 1573139415000,
              "event": "labeled",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/2779694114",
              "actor": "michelvocks",
              "label": "enhancement"
            },
            {
              "id": 606597049,
              "created_at": 1585657859000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/606597049",
              "actor": "omar-nahhas",
              "body": "I managed to get this working including group belonging/mapping. These are the steps I have followed:\r\n\r\n#### Setting up an  LDAP application on Gsuite and giving it the following access\r\n![ldap-app](https://user-images.githubusercontent.com/551844/78023246-3f029a80-734e-11ea-806a-9b53b7a5ec65.png)\r\n\r\n#### I created a set of LDAP access credentials (not sure if this is needed, but I had some issues that were fixed when doing this)\r\n![access-creds](https://user-images.githubusercontent.com/551844/78023399-7a9d6480-734e-11ea-9af0-86c89e3c73ac.png)\r\n\r\n#### Configured [stunnel](https://www.stunnel.org/) as per [google documentation](https://support.google.com/a/answer/9089736#stunnel)\r\n\r\n#### Verify connectivity with ldapsearch command\r\nThis command should list you all the users on your organization:\r\n\r\n`\r\nldapsearch -x -H ldap://127.0.0.1:1636 -D \"cn=LDAPUSER-HERE\" -b ou=Users,dc=example,dc=com -w LDAPPASSWORD-HERE\r\n`\r\n\r\n**Note**:  dc=example,dc=com is for the domain example.com, replace accordingly.\r\n\r\n#### Launch a local vault in dev mode:\r\n\r\n`\r\nexport VAULT_DEV_ROOT_TOKEN_ID=myroot\r\n`\r\n\r\n`\r\nexport VAULT_LOG_LEVEL=debug\r\n`\r\n\r\n`docker run --rm --name vault --net=host -d \r\n    --cap-add=IPC_LOCK \r\n    -e \"VAULT_DEV_ROOT_TOKEN_ID=$VAULT_DEV_ROOT_TOKEN_ID\" \r\n    -e \"VAULT_LOG_LEVEL=$VAULT_LOG_LEVEL\" \r\n    -e 'VAULT_DEV_LISTEN_ADDRESS=0.0.0.0:8200' \"vault:1.2.2\"\r\n`\r\n\r\n**Note**: LDAP logging error messages will be visible if you use `docker logs` command \r\n\r\n#### Login and config  local vault:\r\n\r\n`\r\nexport VAULT_ADDR=http://0.0.0.0:8200\r\n`\r\n`\r\nvault login --method token (user myroot here)\r\n`\r\n#### Configure ldap auth-backend \r\n\r\n`\r\nvault auth enable ldap\r\n`\r\n\r\n`\r\nvault write auth/ldap/config \r\n    url=\"ldap://127.0.0.1:1636\" \r\n    binddn=\"cn=LDAPUSER-HERE\" \r\n    bindpass=\"LDAPPASSWORD-HERE\" \r\n    userdn=\"ou=Users,dc=example,dc=com\" \r\n    userattr=\"uid\" \r\n    groupdn=\"ou=Groups,dc=example,dc=com\" \r\n    groupattr=\"cn\" \r\n    starttls=false\r\n`\r\n\r\n**Note**:  dc=example,dc=com is for the domain example.com, replace accordingly.\r\n\r\n#### Configure an LDAP group mapping\r\n\r\n`\r\nvault write auth/ldap/groups/group2 policies=default,group2\r\n`\r\n\r\n**Note**: This command assumes you have a group named \"group2\" in Gsuite\r\n\r\n#### Authenticate with a user that belongs to \"group2\" in Gsuite\r\n\r\n`\r\nvault login -method=ldap username=<GSUITE_USER_WITHOUT @example.com> password=<GSUITE_PASSWORD>\r\n`\r\n\r\n![token](https://user-images.githubusercontent.com/551844/78024923-10d28a00-7351-11ea-8667-522127b25735.png)\r\n**Note**: This output assumes you have a policy named \"group2\" in vault\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
              "user": "omar-nahhas",
              "html_url": "https://github.com/hashicorp/vault/issues/6670#issuecomment-606597049"
            },
            {
              "id": 606598802,
              "created_at": 1585658076000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/606598802",
              "actor": "AeroNotix",
              "body": "@omar-nahhas does that work with users which aren't used for the `binddn` though? We recently finished a large portion of work to get this to _actually_ work properly, which is now in master.\r\n\r\nI suggest to you look deeper into your setup to ensure it works as expected. It looks like it will only work for the single user you set up in the ldap configuration.",
              "user": "AeroNotix",
              "html_url": "https://github.com/hashicorp/vault/issues/6670#issuecomment-606598802"
            },
            {
              "id": 3183080469,
              "created_at": 1585658077000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3183080469",
              "actor": "omar-nahhas"
            },
            {
              "id": 3183080472,
              "created_at": 1585658077000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3183080472",
              "actor": "omar-nahhas"
            },
            {
              "id": 606603258,
              "created_at": 1585658636000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/606603258",
              "actor": "omar-nahhas",
              "body": "The user used on binddn is the access credentials you set up in GSuite when you set up the LDAP application, is not a user on your Gsuite account. Is worth to mention that the creds used for ldap auth were not used on any configuration step. Also, the \"token_meta_username\" field (after authenticating) shows the Gsuite user name not the binddn user.\r\n\r\nI have carried out the following tests:\r\n- Tried vault login with a wrong user/password for the Gsuite user. This time it could not log-in.\r\n- Removed (In Gsuite) the user from the group for which I have created the mapping in vault, and try to authenticate again, this time the users did only have the default policy.\r\n\r\n\r\nI hope this makes things a bit clearer",
              "user": "omar-nahhas",
              "html_url": "https://github.com/hashicorp/vault/issues/6670#issuecomment-606603258"
            },
            {
              "id": 606605704,
              "created_at": 1585658942000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/606605704",
              "actor": "AeroNotix",
              "body": "Interesting, thanks for information. Now it looks like there are multiple ways that GSuite LDAP can be used with vault. The additional pieces myself and @Gisson added, in order for it to work with unauthenticated binds and the client certificates - and apparently, your method here.",
              "user": "AeroNotix",
              "html_url": "https://github.com/hashicorp/vault/issues/6670#issuecomment-606605704"
            },
            {
              "id": 3183137459,
              "created_at": 1585658942000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3183137459",
              "actor": "Gisson"
            },
            {
              "id": 3183137462,
              "created_at": 1585658942000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3183137462",
              "actor": "Gisson"
            },
            {
              "id": 606608261,
              "created_at": 1585659251000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/606608261",
              "actor": "omar-nahhas",
              "body": "This is an extract from the debug logs (redacted) if that helps\r\n```\r\n2020-03-31T11:40:36.746Z [DEBUG] auth.ldap.auth_ldap_e72aXXXb: discovering user: userdn=ou=Users,dc=example,dc=net filter=(uid=gsuite_user)\r\n2020-03-31T11:40:37.366Z [DEBUG] auth.ldap.auth_ldap_e72aXXXb: user binddn fetched: username=gsuite_user binddn=uid=gsuite_user,ou=Users,dc=example,dc=net\r\n2020-03-31T11:40:38.544Z [DEBUG] auth.ldap.auth_ldap_e72aXXXb: re-bound to original binddn\r\n2020-03-31T11:40:38.544Z [DEBUG] auth.ldap.auth_ldap_e72aXXXb: compiling group filter: group_filter=(|(memberUid={{.Username}})(member={{.UserDN}})(uniqueMember={{.UserDN}}))\r\n2020-03-31T11:40:38.544Z [DEBUG] auth.ldap.auth_ldap_e72aXXXb: searching: groupdn=ou=Groups,dc=example,dc=net rendered_query=(|(memberUid=gsuite_user)(member=uid=gsuite_user,ou=Users,dc=example,dc=net)(uniqueMember=uid=gsuite_user,ou=Users,dc=example,dc=net))\r\n2020-03-31T11:40:39.515Z [DEBUG] auth.ldap.auth_ldap_e72aXXXb: groups fetched from server: num_server_groups=3 server_groups=[ou=Groups,dc=example,dc=net, group2, group1]\r\n2020-03-31T11:40:39.515Z [DEBUG] identity: refreshing external group memberships: entity_id=XXXXXXX-a92f-2247-9ee3-XXXXXXXXX group_aliases=[\"mount_accessor:\"auth_ldap_e72aXXXb\" name:\"ou=Groups,dc=example,dc=net\" \", \"mount_accessor:\"auth_ldap_e72aXXXb\" name:\"group2\" \", \"mount_accessor:\"auth_ldap_e72aXXXb\" name:\"group1\" \"]\r\n```",
              "user": "omar-nahhas",
              "html_url": "https://github.com/hashicorp/vault/issues/6670#issuecomment-606608261"
            },
            {
              "id": 606610353,
              "created_at": 1585659498000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/606610353",
              "actor": "AeroNotix",
              "body": "Yes, I believe you that it works :)\r\n\r\nThe piece I was originally missing is that I wasn't aware you needed to use some extra credentials in order to access GSuite LDAP. It's not documented at all (unless you can point me to it?)\r\n\r\nTherefore I added flags/features to vault in order for it to work as the GSuite documentation suggests, by using client certificates, unauthenticated binds. That work is in master, now.",
              "user": "AeroNotix",
              "html_url": "https://github.com/hashicorp/vault/issues/6670#issuecomment-606610353"
            },
            {
              "id": 606611803,
              "created_at": 1585659672000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/606611803",
              "actor": "omar-nahhas",
              "body": "You are right, that is not documented, I just happened to try both ways, thank you guys for the work on master, does it allow us to avoid using stunnel? ",
              "user": "omar-nahhas",
              "html_url": "https://github.com/hashicorp/vault/issues/6670#issuecomment-606611803"
            },
            {
              "id": 606614367,
              "created_at": 1585659987000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/606614367",
              "actor": "omar-nahhas",
              "body": "I have found [this](https://support.google.com/a/answer/9089736?hl=en#basic-instructions ) on Google docs, I think this is where I got the hint.\r\n",
              "user": "omar-nahhas",
              "html_url": "https://github.com/hashicorp/vault/issues/6670#issuecomment-606614367"
            },
            {
              "id": 606615986,
              "created_at": 1585660157000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/606615986",
              "actor": "AeroNotix",
              "body": "Yes, you don't need to use stunnel.",
              "user": "AeroNotix",
              "html_url": "https://github.com/hashicorp/vault/issues/6670#issuecomment-606615986"
            },
            {
              "id": 619840567,
              "created_at": 1587978286000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/619840567",
              "actor": "prajwalkirankumar",
              "body": "Is there a way to replicate the same on an OpenLDAP server and use client certificates to authenticate?\r\n",
              "user": "prajwalkirankumar",
              "html_url": "https://github.com/hashicorp/vault/issues/6670#issuecomment-619840567"
            },
            {
              "id": 622948964,
              "created_at": 1588423893000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/622948964",
              "actor": "stephenrjohnson",
              "body": "Any eta when this will be released? ",
              "user": "stephenrjohnson",
              "html_url": "https://github.com/hashicorp/vault/issues/6670#issuecomment-622948964"
            },
            {
              "id": 656929000,
              "created_at": 1594421665000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/656929000",
              "actor": "mister2d",
              "body": "> Is there a way to replicate the same on an OpenLDAP server and use client certificates to authenticate?\r\n\r\nI'm able to have vault work successfully with OpenLDAP by setting the `LDAP_TLS_VERIFY_CLIENT=try` environment variable using the `osixia/docker-openldap` docker image.",
              "user": "mister2d",
              "html_url": "https://github.com/hashicorp/vault/issues/6670#issuecomment-656929000"
            },
            {
              "id": 657093614,
              "created_at": 1594486226000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/657093614",
              "actor": "prajwalkirankumar",
              "body": "> > Is there a way to replicate the same on an OpenLDAP server and use client certificates to authenticate?\r\n> \r\n> I'm able to have vault work successfully with OpenLDAP by setting the `LDAP_TLS_VERIFY_CLIENT=try` environment variable using the `osixia/docker-openldap` docker image.\r\n@mister2d \r\nI enabled the environment variable LDAP_TLS_VERIFY_CLIENT=try with the following output on the osixia/docker-openldap : \r\n\r\n```\r\nroot@ldap:/# ldapsearch  -ZZ -Y EXTERNAL -b dc=example,dc=org\r\nSASL/EXTERNAL authentication started\r\nSASL username: cn=admin\r\nSASL SSF: 0\r\n# extended LDIF\r\n#\r\n# LDAPv3\r\n# base <dc=example,dc=org> with scope subtree\r\n# filter: (objectclass=*)\r\n# requesting: ALL\r\n#\r\n\r\n# search result\r\nsearch: 3\r\nresult: 32 No such object\r\n\r\n```\r\n\r\nI have set my hostname to ldap.example.org while running the image.\r\n\r\nThis is what I get when i do the authentication with username and password (which I should get when using the certificate as well) : \r\n\r\n```\r\nroot@ldap:/# ldapsearch -x -H ldaps://localhost -b dc=example,dc=org -D \"cn=admin,dc=example,dc=org\" -w admin\r\n# extended LDIF\r\n#\r\n# LDAPv3\r\n# base <dc=example,dc=org> with scope subtree\r\n# filter: (objectclass=*)\r\n# requesting: ALL\r\n#\r\n\r\n# example.org\r\ndn: dc=example,dc=org\r\nobjectClass: top\r\nobjectClass: dcObject\r\nobjectClass: organization\r\no: Example Inc.\r\ndc: example\r\n\r\n# admin, example.org\r\ndn: cn=admin,dc=example,dc=org\r\nobjectClass: simpleSecurityObject\r\nobjectClass: organizationalRole\r\ncn: admin\r\ndescription: LDAP administrator\r\nuserPassword:: e1NTSEF9K0tqZ1hZV2NKZ2ptZnZSQ1kyMnI1SXRRREt6bWtyeTg=\r\n\r\n# search result\r\nsearch: 2\r\nresult: 0 Success\r\n\r\n# numResponses: 3\r\n# numEntries: 2\r\n```\r\n_____________________________________________________________________________\r\nIs the certificate I have generated wrong? It looks like this : \r\n\r\n> Certificate:\r\n>     Data:\r\n>         Version: 3 (0x2)\r\n>         Serial Number:\r\n>             c5:86:23:9d:17:87:08:d7:4d:6c:0d:c1:ca:57:2d:b4\r\n>     Signature Algorithm: sha256WithRSAEncryption\r\n>         Issuer: CN=Root CA\r\n>         Validity\r\n>             Not Before: Jul 11 16:39:01 2020 GMT\r\n>             Not After : Oct 14 16:39:01 2022 GMT\r\n>         Subject: CN=admin\r\n>         Subject Public Key Info:\r\n>             Public Key Algorithm: rsaEncryption\r\n>                 Public-Key: (2048 bit)\r\n>                 Modulus:\r\n>                    //Modulus\r\n>                 Exponent: 65537 (0x10001)\r\n>         X509v3 extensions:\r\n>             X509v3 Basic Constraints:\r\n>                 CA:FALSE\r\n>             X509v3 Subject Key Identifier:\r\n>                 D2:08:40:2F:0C:E9:D2:A9:30:AA:8E:D8:FA:D1:12:DF:F1:4A:D5:E2\r\n>             X509v3 Authority Key Identifier:\r\n>                 keyid:01:CF:48:3D:BD:15:AA:81:D1:AF:5E:72:DF:34:2D:4C:7A:A8:1C:82\r\n>                 DirName:/CN=Root CA\r\n>                 serial:91:42:E6:57:2A:93:47:A7\r\n> \r\n>             X509v3 Extended Key Usage:\r\n>                 TLS Web Client Authentication\r\n>             X509v3 Key Usage:\r\n>                 Digital Signature\r\n>     Signature Algorithm: sha256WithRSAEncryption\r\n>         //Key\r\n\r\n_________________________________________________________________\r\n\r\nAm i missing something here?",
              "user": "prajwalkirankumar",
              "html_url": "https://github.com/hashicorp/vault/issues/6670#issuecomment-657093614"
            },
            {
              "id": 3536430277,
              "created_at": 1594486226000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3536430277",
              "actor": "mister2d"
            },
            {
              "id": 3536430278,
              "created_at": 1594486226000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3536430278",
              "actor": "mister2d"
            }
          ]
        },
        {
          "id": "655331297",
          "node_id": "MDU6SXNzdWU2NTUzMzEyOTc=",
          "number": 9461,
          "html_url": "https://github.com/hashicorp/vault/issues/9461",
          "title": "Add option to secure v1/sys/health and other endpoints",
          "user": {
            "type": "user",
            "login": "SledgeHammer01"
          },
          "labels": [],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594529771000,
          "updated_at": 1594529880000,
          "author_association": "NONE",
          "body": "v1/sys/health endpoint is currently unsecured. Would like to see a way to secure it with the client token, etc as the other endpoints. It is a security concern to expose internal information. Also see some of the other rest endpoints are not secured.",
          "events": [
            {
              "id": 3536813360,
              "created_at": 1594529865000,
              "event": "renamed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3536813360",
              "actor": "SledgeHammer01",
              "rename": {
                "from": "Add option to secure v1/sys/health endpoint",
                "to": "Add option to secure v1/sys/health and other endpoints"
              }
            }
          ]
        },
        {
          "id": "380085157",
          "node_id": "MDU6SXNzdWUzODAwODUxNTc=",
          "number": 5767,
          "html_url": "https://github.com/hashicorp/vault/issues/5767",
          "title": "Unable to login using local AWS profile with role_arn / source_profile and MFA",
          "user": {
            "type": "user",
            "login": "gwilym"
          },
          "labels": [
            {
              "id": "1659715356",
              "node_id": "MDU6TGFiZWwxNjU5NzE1MzU2",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/auth/aws",
              "name": "auth/aws",
              "color": "f968e8",
              "description": "",
              "default": false
            },
            {
              "id": "1492658523",
              "node_id": "MDU6TGFiZWwxNDkyNjU4NTIz",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/bug",
              "name": "bug",
              "color": "ef97a7",
              "description": "",
              "default": true
            },
            {
              "id": "1683802498",
              "node_id": "MDU6TGFiZWwxNjgzODAyNDk4",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/version/1.0.x",
              "name": "version/1.0.x",
              "color": "bbcef9",
              "description": "",
              "default": false
            }
          ],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 11,
          "created_at": 1542092329000,
          "updated_at": 1594618625000,
          "author_association": "NONE",
          "body": "<!-- Please reserve GitHub issues for bug reports and feature requests.\r\n\r\nFor questions, the best place to get answers is on our [mailing list](https://groups.google.com/forum/#!forum/vault-tool), as they will get more visibility from experienced users than the issue tracker.\r\n\r\nPlease note: We take Vault's security and our users' trust very seriously. If you believe you have found a security issue in Vault, please responsibly disclose by contacting us at security@hashicorp.com. Our PGP key is available at [our security page](https://www.hashicorp.com/security/).\r\n\r\n-->\r\n\r\n**Describe the bug**\r\n\r\nAttempting to `vault login` using this particular IAM profile setup in `~/.aws/credentials` fails with the following error:\r\n\r\n```\r\nError authenticating: failed to retrieve credentials from credential chain: NoCredentialProviders: no valid providers in chain. Deprecated.\r\n\tFor verbose messaging see aws.Config.CredentialsChainVerboseErrors\r\n```\r\n\r\nThe same setup works OK with the official `aws` CLI (`AWS_PROFILE=admin aws sts get-caller-identity` works), as well as with basic usage of the Go SDK.\r\n\r\nExample of `~/.aws/credentials`:\r\n\r\n```\r\n[main]\r\naws_access_key_id = ?\r\naws_secret_access_key = ?\r\n[admin]\r\nmfa_serial = arn:aws:iam::MAINACCOUNTID:mfa/USERNAME\r\nrole_arn = arn:aws:iam::SUBACCOUNTID:role/admin\r\nsource_profile = main\r\n```\r\n\r\nNote: account IDs above may be the same account, though for this case it likely doesn't matter because Vault fails during the credential-load stage. There's likely two potential issues here, one with credential loading and one with enabling an MFA token provider for the AWS SDK.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Establish an AWS account setup that uses MFA and role-switching\r\n2. Run `vault server -dev` with credentials to utilise `aws` auth\r\n2. Run `vault auth enable aws`\r\n3. Run `vault write auth/aws/config/client iam_server_id_header_value=vault.example.com`\r\n4. Run `vault write auth/aws/role/admin auth_type=iam 'bound_iam_principal_arn=arn:aws:sts::SUBACCOUNTID:assumed-role/admin/*' max_ttl=8h`\r\n5. Run `AWS_SDK_LOAD_CONFIG=1 AWS_PROFILE=admin vault login -method=aws header_value=vault.example.com role=admin` \r\n6. See error\r\n\r\n**Expected behavior**\r\n1. Vault should prompt for an MFA code.\r\n2. Vault should use credentials of the assumed role to generate signed payloads for the login action.\r\n3. In theory, the login should succeed and you should be able to access Vault, but I haven't reached this point yet.\r\n\r\n**Environment:**\r\n* Vault Server Version (retrieve with `vault status`): 1.0.0-beta2\r\n* Vault CLI Version (retrieve with `vault version`): Vault v1.0.0-beta2 ('8f61c4953620801477ad40f9d75063659acb5d84')\r\n* Server Operating System/Architecture: darwin/amd64\r\n\r\nVault server configuration file(s):\r\n\r\nNone, I've been using `-dev`.\r\n\r\n**Additional context**\r\n\r\nApologies up front if I'm missing anything fundamental: I am brand new to Vault. If anything looks off here let me know and I will try to clarify.\r\n\r\nWhen I modify Vault's `awsutil` package to enable verbose errors like so ...\r\n\r\n```diff\r\n-\tcreds := credentials.NewChainCredentials(providers)\r\n+\tcreds := credentials.NewCredentials(&credentials.ChainProvider{\r\n+\t\tProviders:     providers,\r\n+\t\tVerboseErrors: true,\r\n+\t})\r\n```\r\n\r\n... I get the following extra info:\r\n\r\n```\r\nError authenticating: failed to retrieve credentials from credential chain: NoCredentialProviders: no valid providers in chain\r\ncaused by: EnvAccessKeyNotFound: AWS_ACCESS_KEY_ID or AWS_ACCESS_KEY not found in environment\r\nSharedCredsAccessKey: shared credentials admin in CREDSFILENAME did not contain aws_access_key_id\r\ncaused by: error when getting key of section 'admin': key 'aws_access_key_id' not exists\r\nEC2RoleRequestError: no EC2 instance role found\r\ncaused by: RequestError: send request failed\r\ncaused by: Get http://169.254.169.254/latest/meta-data/iam/security-credentials/: dial tcp 169.254.169.254:80: connect: host is down\r\n```\r\n\r\nThe EC2 errors are expected since I'm running this locally, however, the `admin` profile shouldn't need access keys within it due to `source_profile`. When I take the access keys and put them in the profile, then that prevents the role-switch from happening and it attempts to login using the original credentials instead (which is not expected).\r\n\r\nNot sure if this helps, but here's an example of a simple, working-as-expected Go AWS SDK usage:\r\n\r\n```\r\npackage main\r\n\r\nimport (\r\n\t\"log\"\r\n\r\n\t\"github.com/aws/aws-sdk-go/aws\"\r\n\t\"github.com/aws/aws-sdk-go/aws/credentials/stscreds\"\r\n\t\"github.com/aws/aws-sdk-go/aws/session\"\r\n\t\"github.com/aws/aws-sdk-go/service/sts\"\r\n)\r\n\r\nfunc main() {\r\n\tsess, err := session.NewSessionWithOptions(session.Options{\r\n\t\tConfig:                  *aws.NewConfig(),\r\n\t\tAssumeRoleTokenProvider: stscreds.StdinTokenProvider,\r\n\t})\r\n\r\n\tif err != nil {\r\n\t\tlog.Fatalf(\"session error: %v\", err)\r\n\t}\r\n\r\n\tsvc := sts.New(sess)\r\n\tresult, err := svc.GetCallerIdentity(&sts.GetCallerIdentityInput{})\r\n\tif err != nil {\r\n\t\tlog.Fatalf(\"GetCallerIdentity error: %v\", err)\r\n\t}\r\n\r\n\tlog.Printf(\"GetCallerIdentity result: %#v\", result)\r\n}\r\n```\r\n",
          "events": [
            {
              "id": 439220557,
              "created_at": 1542322579000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/439220557",
              "actor": "gwilym",
              "body": "I haven't had time to learn the Vault codebase yet, but I was able to whip up a workaround for this that others might find usable. It's based on the signing code present in the Vault CLI.\r\n\r\nhttps://gist.github.com/gwilym/1db446f67a4d62db50d1139082e5b719\r\n\r\nThe output of this app should usable as part of a `vault write`, like below (assuming you build it as `vault-aws-login`):\r\n\r\n```\r\n$ AWS_SDK_LOAD_CONFIG=1 AWS_PROFILE=aws-profile-name vault-aws-login -server vault.example.com\r\n# capture above using your preferred method, remembering that it may prompt / read for an MFA on stdin, and use it below, like ...\r\n$ vault write auth/aws/login role=vault-profile-name $output\r\n```",
              "user": "gwilym",
              "html_url": "https://github.com/hashicorp/vault/issues/5767#issuecomment-439220557"
            },
            {
              "id": 528774251,
              "created_at": 1567760438000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/528774251",
              "actor": "Vince-Chenal",
              "body": "Do you have any update ?\r\nI still have the exact same problem",
              "user": "Vince-Chenal",
              "html_url": "https://github.com/hashicorp/vault/issues/5767#issuecomment-528774251"
            },
            {
              "id": 2791442664,
              "created_at": 1573565082000,
              "event": "labeled",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/2791442664",
              "actor": "michelvocks",
              "label": "auth/aws"
            },
            {
              "id": 2791442665,
              "created_at": 1573565082000,
              "event": "labeled",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/2791442665",
              "actor": "michelvocks",
              "label": "bug"
            },
            {
              "id": 2808331534,
              "created_at": 1574096575000,
              "event": "labeled",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/2808331534",
              "actor": "catsby",
              "label": "version/1.0.x"
            },
            {
              "id": 570598823,
              "created_at": 1578064175000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/570598823",
              "actor": "kevinpgrant",
              "body": "I've been reading this post a few times, whilst trying to solve a different issue, but then I read something that finally clicked - you have used source_profile in ~/.aws/credentials but according to the docs, it can only be used in the CLI config file ~/.aws/config\r\n\r\n> \"Note that configuration variables for using IAM roles can only be in the AWS CLI config file.\"\r\n\r\nExample configuration using source_profile:\r\n\r\n```\r\n# In ~/.aws/credentials:\r\n[development]\r\naws_access_key_id=foo\r\naws_secret_access_key=bar\r\n\r\n# In ~/.aws/config\r\n[profile crossaccount]\r\nrole_arn=arn:aws:iam:...\r\nsource_profile=development\r\n```\r\nsee [https://docs.aws.amazon.com/cli/latest/topic/config-vars.html](https://docs.aws.amazon.com/cli/latest/topic/config-vars.html)",
              "user": "kevinpgrant",
              "html_url": "https://github.com/hashicorp/vault/issues/5767#issuecomment-570598823"
            },
            {
              "id": 2970731754,
              "created_at": 1579710579000,
              "event": "assigned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/2970731754",
              "actor": "spangenberg",
              "assignee": "spangenberg"
            },
            {
              "id": 577784361,
              "created_at": 1579800374000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/577784361",
              "actor": "spangenberg",
              "body": "As @kevinpgrant pointed out correctly, that `~/.aws/credentials` should not contain the `source_profile` and/or `role_arn`; instead, it belongs inside the `~/.aws/config`.\r\nNevertheless, I verified that the bug still exists and needs to be addressed.\r\n@gwilym thanks a lot for the effort you already put in to investigate and come up with a workaround.",
              "user": "spangenberg",
              "html_url": "https://github.com/hashicorp/vault/issues/5767#issuecomment-577784361"
            },
            {
              "id": 2974601865,
              "created_at": 1579800374000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/2974601865",
              "actor": "gwilym"
            },
            {
              "id": 2974601867,
              "created_at": 1579800374000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/2974601867",
              "actor": "gwilym"
            },
            {
              "id": 2974601870,
              "created_at": 1579800374000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/2974601870",
              "actor": "kevinpgrant"
            },
            {
              "id": 2974601871,
              "created_at": 1579800374000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/2974601871",
              "actor": "kevinpgrant"
            },
            {
              "created_at": 1579894804000,
              "event": "cross-referenced",
              "actor": "spangenberg",
              "source": {
                "type": "issue",
                "issue": {
                  "url": "https://api.github.com/repos/hashicorp/vault/issues/8237",
                  "repository_url": "https://api.github.com/repos/hashicorp/vault",
                  "labels_url": "https://api.github.com/repos/hashicorp/vault/issues/8237/labels{/name}",
                  "comments_url": "https://api.github.com/repos/hashicorp/vault/issues/8237/comments",
                  "events_url": "https://api.github.com/repos/hashicorp/vault/issues/8237/events",
                  "html_url": "https://github.com/hashicorp/vault/pull/8237",
                  "id": 554917644,
                  "node_id": "MDExOlB1bGxSZXF1ZXN0MzY2OTg1NjMy",
                  "number": 8237,
                  "title": "Add AssumeRole session token provider",
                  "user": {
                    "login": "spangenberg",
                    "id": 236406,
                    "node_id": "MDQ6VXNlcjIzNjQwNg==",
                    "avatar_url": "https://avatars3.githubusercontent.com/u/236406?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/spangenberg",
                    "html_url": "https://github.com/spangenberg",
                    "followers_url": "https://api.github.com/users/spangenberg/followers",
                    "following_url": "https://api.github.com/users/spangenberg/following{/other_user}",
                    "gists_url": "https://api.github.com/users/spangenberg/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/spangenberg/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/spangenberg/subscriptions",
                    "organizations_url": "https://api.github.com/users/spangenberg/orgs",
                    "repos_url": "https://api.github.com/users/spangenberg/repos",
                    "events_url": "https://api.github.com/users/spangenberg/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/spangenberg/received_events",
                    "type": "User",
                    "site_admin": false
                  },
                  "labels": [
                    {
                      "id": 1659715356,
                      "node_id": "MDU6TGFiZWwxNjU5NzE1MzU2",
                      "url": "https://api.github.com/repos/hashicorp/vault/labels/auth/aws",
                      "name": "auth/aws",
                      "color": "f968e8",
                      "default": false,
                      "description": ""
                    }
                  ],
                  "state": "closed",
                  "locked": false,
                  "assignee": {
                    "login": "spangenberg",
                    "id": 236406,
                    "node_id": "MDQ6VXNlcjIzNjQwNg==",
                    "avatar_url": "https://avatars3.githubusercontent.com/u/236406?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/spangenberg",
                    "html_url": "https://github.com/spangenberg",
                    "followers_url": "https://api.github.com/users/spangenberg/followers",
                    "following_url": "https://api.github.com/users/spangenberg/following{/other_user}",
                    "gists_url": "https://api.github.com/users/spangenberg/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/spangenberg/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/spangenberg/subscriptions",
                    "organizations_url": "https://api.github.com/users/spangenberg/orgs",
                    "repos_url": "https://api.github.com/users/spangenberg/repos",
                    "events_url": "https://api.github.com/users/spangenberg/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/spangenberg/received_events",
                    "type": "User",
                    "site_admin": false
                  },
                  "assignees": [
                    {
                      "login": "spangenberg",
                      "id": 236406,
                      "node_id": "MDQ6VXNlcjIzNjQwNg==",
                      "avatar_url": "https://avatars3.githubusercontent.com/u/236406?v=4",
                      "gravatar_id": "",
                      "url": "https://api.github.com/users/spangenberg",
                      "html_url": "https://github.com/spangenberg",
                      "followers_url": "https://api.github.com/users/spangenberg/followers",
                      "following_url": "https://api.github.com/users/spangenberg/following{/other_user}",
                      "gists_url": "https://api.github.com/users/spangenberg/gists{/gist_id}",
                      "starred_url": "https://api.github.com/users/spangenberg/starred{/owner}{/repo}",
                      "subscriptions_url": "https://api.github.com/users/spangenberg/subscriptions",
                      "organizations_url": "https://api.github.com/users/spangenberg/orgs",
                      "repos_url": "https://api.github.com/users/spangenberg/repos",
                      "events_url": "https://api.github.com/users/spangenberg/events{/privacy}",
                      "received_events_url": "https://api.github.com/users/spangenberg/received_events",
                      "type": "User",
                      "site_admin": false
                    }
                  ],
                  "comments": 1,
                  "created_at": "2020-01-24T19:40:03Z",
                  "updated_at": "2020-06-12T17:24:58Z",
                  "closed_at": "2020-06-12T17:24:58Z",
                  "author_association": "MEMBER",
                  "repository": {
                    "id": 31288958,
                    "node_id": "MDEwOlJlcG9zaXRvcnkzMTI4ODk1OA==",
                    "name": "vault",
                    "full_name": "hashicorp/vault",
                    "private": false,
                    "owner": {
                      "login": "hashicorp",
                      "id": 761456,
                      "node_id": "MDEyOk9yZ2FuaXphdGlvbjc2MTQ1Ng==",
                      "avatar_url": "https://avatars2.githubusercontent.com/u/761456?v=4",
                      "gravatar_id": "",
                      "url": "https://api.github.com/users/hashicorp",
                      "html_url": "https://github.com/hashicorp",
                      "followers_url": "https://api.github.com/users/hashicorp/followers",
                      "following_url": "https://api.github.com/users/hashicorp/following{/other_user}",
                      "gists_url": "https://api.github.com/users/hashicorp/gists{/gist_id}",
                      "starred_url": "https://api.github.com/users/hashicorp/starred{/owner}{/repo}",
                      "subscriptions_url": "https://api.github.com/users/hashicorp/subscriptions",
                      "organizations_url": "https://api.github.com/users/hashicorp/orgs",
                      "repos_url": "https://api.github.com/users/hashicorp/repos",
                      "events_url": "https://api.github.com/users/hashicorp/events{/privacy}",
                      "received_events_url": "https://api.github.com/users/hashicorp/received_events",
                      "type": "Organization",
                      "site_admin": false
                    },
                    "html_url": "https://github.com/hashicorp/vault",
                    "description": "A tool for secrets management, encryption as a service, and privileged access management",
                    "fork": false,
                    "url": "https://api.github.com/repos/hashicorp/vault",
                    "forks_url": "https://api.github.com/repos/hashicorp/vault/forks",
                    "keys_url": "https://api.github.com/repos/hashicorp/vault/keys{/key_id}",
                    "collaborators_url": "https://api.github.com/repos/hashicorp/vault/collaborators{/collaborator}",
                    "teams_url": "https://api.github.com/repos/hashicorp/vault/teams",
                    "hooks_url": "https://api.github.com/repos/hashicorp/vault/hooks",
                    "issue_events_url": "https://api.github.com/repos/hashicorp/vault/issues/events{/number}",
                    "events_url": "https://api.github.com/repos/hashicorp/vault/events",
                    "assignees_url": "https://api.github.com/repos/hashicorp/vault/assignees{/user}",
                    "branches_url": "https://api.github.com/repos/hashicorp/vault/branches{/branch}",
                    "tags_url": "https://api.github.com/repos/hashicorp/vault/tags",
                    "blobs_url": "https://api.github.com/repos/hashicorp/vault/git/blobs{/sha}",
                    "git_tags_url": "https://api.github.com/repos/hashicorp/vault/git/tags{/sha}",
                    "git_refs_url": "https://api.github.com/repos/hashicorp/vault/git/refs{/sha}",
                    "trees_url": "https://api.github.com/repos/hashicorp/vault/git/trees{/sha}",
                    "statuses_url": "https://api.github.com/repos/hashicorp/vault/statuses/{sha}",
                    "languages_url": "https://api.github.com/repos/hashicorp/vault/languages",
                    "stargazers_url": "https://api.github.com/repos/hashicorp/vault/stargazers",
                    "contributors_url": "https://api.github.com/repos/hashicorp/vault/contributors",
                    "subscribers_url": "https://api.github.com/repos/hashicorp/vault/subscribers",
                    "subscription_url": "https://api.github.com/repos/hashicorp/vault/subscription",
                    "commits_url": "https://api.github.com/repos/hashicorp/vault/commits{/sha}",
                    "git_commits_url": "https://api.github.com/repos/hashicorp/vault/git/commits{/sha}",
                    "comments_url": "https://api.github.com/repos/hashicorp/vault/comments{/number}",
                    "issue_comment_url": "https://api.github.com/repos/hashicorp/vault/issues/comments{/number}",
                    "contents_url": "https://api.github.com/repos/hashicorp/vault/contents/{+path}",
                    "compare_url": "https://api.github.com/repos/hashicorp/vault/compare/{base}...{head}",
                    "merges_url": "https://api.github.com/repos/hashicorp/vault/merges",
                    "archive_url": "https://api.github.com/repos/hashicorp/vault/{archive_format}{/ref}",
                    "downloads_url": "https://api.github.com/repos/hashicorp/vault/downloads",
                    "issues_url": "https://api.github.com/repos/hashicorp/vault/issues{/number}",
                    "pulls_url": "https://api.github.com/repos/hashicorp/vault/pulls{/number}",
                    "milestones_url": "https://api.github.com/repos/hashicorp/vault/milestones{/number}",
                    "notifications_url": "https://api.github.com/repos/hashicorp/vault/notifications{?since,all,participating}",
                    "labels_url": "https://api.github.com/repos/hashicorp/vault/labels{/name}",
                    "releases_url": "https://api.github.com/repos/hashicorp/vault/releases{/id}",
                    "deployments_url": "https://api.github.com/repos/hashicorp/vault/deployments",
                    "created_at": "2015-02-25T00:15:59Z",
                    "updated_at": "2020-07-17T20:30:27Z",
                    "pushed_at": "2020-07-17T20:57:34Z",
                    "git_url": "git://github.com/hashicorp/vault.git",
                    "ssh_url": "git@github.com:hashicorp/vault.git",
                    "clone_url": "https://github.com/hashicorp/vault.git",
                    "svn_url": "https://github.com/hashicorp/vault",
                    "homepage": "https://www.vaultproject.io/",
                    "size": 123698,
                    "stargazers_count": 16436,
                    "watchers_count": 16436,
                    "language": "Go",
                    "has_issues": true,
                    "has_projects": false,
                    "has_downloads": true,
                    "has_wiki": false,
                    "has_pages": false,
                    "forks_count": 2534,
                    "archived": false,
                    "disabled": false,
                    "open_issues_count": 708,
                    "license": {
                      "key": "mpl-2.0",
                      "name": "Mozilla Public License 2.0",
                      "spdx_id": "MPL-2.0",
                      "url": "https://api.github.com/licenses/mpl-2.0",
                      "node_id": "MDc6TGljZW5zZTE0"
                    },
                    "forks": 2534,
                    "open_issues": 708,
                    "watchers": 16436,
                    "default_branch": "master"
                  },
                  "pull_request": {
                    "url": "https://api.github.com/repos/hashicorp/vault/pulls/8237",
                    "html_url": "https://github.com/hashicorp/vault/pull/8237",
                    "diff_url": "https://github.com/hashicorp/vault/pull/8237.diff",
                    "patch_url": "https://github.com/hashicorp/vault/pull/8237.patch"
                  },
                  "body": "Fixes #5767"
                }
              }
            },
            {
              "id": 589788327,
              "created_at": 1582311497000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/589788327",
              "actor": "spangenberg",
              "body": "We haven't heard back regarding this issue in over 29 days. To try and keep our GitHub issues current, we'll be closing this issue in approximately seven days if we do not hear back regarding this issue. Please let us know if you can still reproduce this issue, and if there is any more information you could share, otherwise we'll be closing this issue.",
              "user": "spangenberg",
              "html_url": "https://github.com/hashicorp/vault/issues/5767#issuecomment-589788327"
            },
            {
              "id": 589978002,
              "created_at": 1582391970000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/589978002",
              "actor": "dalvizu",
              "body": "Yes this is still an issue, the last comment was from yourself confirming this is still an issue?",
              "user": "dalvizu",
              "html_url": "https://github.com/hashicorp/vault/issues/5767#issuecomment-589978002"
            },
            {
              "id": 590001047,
              "created_at": 1582407716000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/590001047",
              "actor": "spangenberg",
              "body": "Sorry, didn't mean to put the comment there. Too many open tabs, please ignore it. ",
              "user": "spangenberg",
              "html_url": "https://github.com/hashicorp/vault/issues/5767#issuecomment-590001047"
            },
            {
              "id": 590003000,
              "created_at": 1582409308000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/590003000",
              "actor": "cablespaghetti",
              "body": "I know this ticket is about MFA, but I am correct in thinking that it also currently isn't possible to use AWS CLI profiles which assume roles? Currently I'm working around this with the aws sts assume-role command and exporting various environment variables from the output of that.\r\n\r\nCurrently doing this:\r\n```\r\nAWS_ROLE=<role-arn-here>\r\nCREDENTIALS=`aws sts assume-role --role-arn \"$AWS_ROLE\" --role-session-name vaultSession --duration-seconds 3600 --output=json`\r\nexport AWS_ACCESS_KEY_ID=`echo ${CREDENTIALS} | jq -r '.Credentials.AccessKeyId'`\r\nexport AWS_SECRET_ACCESS_KEY=`echo ${CREDENTIALS} | jq -r '.Credentials.SecretAccessKey'`\r\nexport AWS_SESSION_TOKEN=`echo ${CREDENTIALS} | jq -r '.Credentials.SessionToken'`\r\nexport AWS_EXPIRATION=`echo ${CREDENTIALS} | jq -r '.Credentials.Expiration'`\r\nvault login -method=aws\r\n```",
              "user": "cablespaghetti",
              "html_url": "https://github.com/hashicorp/vault/issues/5767#issuecomment-590003000"
            },
            {
              "id": 617677507,
              "created_at": 1587549310000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/617677507",
              "actor": "gw0",
              "body": "@cablespaghetti I came to the exactly the same conclusion and same workaround.",
              "user": "gw0",
              "html_url": "https://github.com/hashicorp/vault/issues/5767#issuecomment-617677507"
            },
            {
              "id": 3259797274,
              "created_at": 1587549310000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3259797274",
              "actor": "cablespaghetti"
            },
            {
              "id": 3259797278,
              "created_at": 1587549310000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3259797278",
              "actor": "cablespaghetti"
            },
            {
              "id": 3260058669,
              "created_at": 1587553582000,
              "event": "unassigned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3260058669",
              "actor": "spangenberg",
              "assignee": "spangenberg"
            },
            {
              "id": 617710382,
              "created_at": 1587553634000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/617710382",
              "actor": "cablespaghetti",
              "body": "@gw0 I actually stopped doing this as it was a horrible user experience. I now have a dockerised bash script running as a Kubernetes cron job which syncs up the members of an IAM Group with Vault, so they can log in as their normal user.",
              "user": "cablespaghetti",
              "html_url": "https://github.com/hashicorp/vault/issues/5767#issuecomment-617710382"
            },
            {
              "id": 3260061683,
              "created_at": 1587553635000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3260061683",
              "actor": "gw0"
            },
            {
              "id": 3260061690,
              "created_at": 1587553635000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3260061690",
              "actor": "gw0"
            },
            {
              "id": 657369046,
              "created_at": 1594618625000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/657369046",
              "actor": "cyrus-mc",
              "body": "Still and issue for me. Would be nice to have this fixed. ",
              "user": "cyrus-mc",
              "html_url": "https://github.com/hashicorp/vault/issues/5767#issuecomment-657369046"
            }
          ]
        },
        {
          "id": "567654108",
          "node_id": "MDU6SXNzdWU1Njc2NTQxMDg=",
          "number": 8382,
          "html_url": "https://github.com/hashicorp/vault/issues/8382",
          "title": "Prometheus metrics docs and guidelines",
          "user": {
            "type": "user",
            "login": "riuvshyn"
          },
          "labels": [
            {
              "id": "1661028911",
              "node_id": "MDU6TGFiZWwxNjYxMDI4OTEx",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/core/metric",
              "name": "core/metric",
              "color": "0000ff",
              "description": "",
              "default": false
            },
            {
              "id": "1024442799",
              "node_id": "MDU6TGFiZWwxMDI0NDQyNzk5",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/docs",
              "name": "docs",
              "color": "b2ffb7",
              "description": "",
              "default": false
            }
          ],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 2,
          "created_at": 1582127832000,
          "updated_at": 1594622905000,
          "author_association": "CONTRIBUTOR",
          "body": "Hello! I have a couple of questions:\r\n1) where I can read actual prometheus metrics documentation?\r\nI've tried to go through https://www.vaultproject.io/docs/internals/telemetry/ but this looks outdated and does not cover lots of exposed in prom format metrics so it is absolutely not clear how to use the metric...\r\nex: I have k8s auth plugin enabled so I have metrics:\r\n```\r\nvault_route_rollback_auth_kubernetes__sum 0.5904119880869985\r\nvault_route_rollback_auth_kubernetes__count 28\r\n``` \r\nbut there is no anything related to this in docs nor plugin repo https://github.com/hashicorp/vault-plugin-auth-kubernetes\r\n\r\nand there are many such examples so it feels quite inconsistent.\r\n\r\nanother ex: https://www.vaultproject.io/docs/internals/telemetry/#secrets-engines-metrics covers only Databases but how do I monitor transit backend? what metrics it exposes?\r\n\r\ncan this doc also cover what is the `rollback` and `route rollback` operations?\r\n\r\n2) is there any guidelines on monitoring/alerting?  WOuld be nice to see what should be in focus.",
          "events": [
            {
              "id": 3056587188,
              "created_at": 1582211520000,
              "event": "labeled",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3056587188",
              "actor": "catsby",
              "label": "core/metric"
            },
            {
              "id": 3056587192,
              "created_at": 1582211520000,
              "event": "labeled",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3056587192",
              "actor": "catsby",
              "label": "docs"
            },
            {
              "id": 589100505,
              "created_at": 1582211527000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/589100505",
              "actor": "catsby",
              "body": "Hello! There is some additional documentation about using Prometheus here, albeit not much:\r\n\r\n- https://www.vaultproject.io/docs/configuration/telemetry/\r\n\r\nIt does seem like our documentation on metrics needs some updating :/ ",
              "user": "catsby",
              "html_url": "https://github.com/hashicorp/vault/issues/8382#issuecomment-589100505"
            },
            {
              "id": 657390317,
              "created_at": 1594622904000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/657390317",
              "actor": "omerlh",
              "body": "I'm struggling with this also. Spent around half an hour digging around the code and trying to find where the metrics are defined - so far couldn't find anything. My main concern is to find out what I should monitor. I can see a lot of metrics like `vault_gcs_put`, but I can't figure which one are important - and how I can monitor errors. Can someone help clearing it out?",
              "user": "omerlh",
              "html_url": "https://github.com/hashicorp/vault/issues/8382#issuecomment-657390317"
            }
          ]
        },
        {
          "id": "651603950",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ0ODI3NDc2",
          "number": 9402,
          "html_url": "https://github.com/hashicorp/vault/pull/9402",
          "title": "Docs: Add Mittwald Vault Libraries",
          "user": {
            "type": "user",
            "login": "ins0"
          },
          "labels": [],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 2,
          "created_at": 1594047221000,
          "updated_at": 1594645502000,
          "author_association": "NONE",
          "body": "This will add Vault Client Libraries for\r\n\r\n- [x] golang - https://github.com/mittwald/vaultgo\r\n- [x] php - https://github.com/mittwald/vaultPHP\r\n- [x] typescript - https://github.com/mittwald/vaulTS",
          "events": [
            {
              "id": 654287401,
              "created_at": 1594047224000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/654287401",
              "actor": "hashicorp-cla",
              "body": "[![CLA assistant check](https://cla.hashicorp.com/pull/badge/signed)](https://cla.hashicorp.com/hashicorp/vault?pullRequest=9402) <br/>All committers have signed the CLA.",
              "user": "hashicorp-cla",
              "html_url": "https://github.com/hashicorp/vault/pull/9402#issuecomment-654287401"
            },
            {
              "id": 3516345038,
              "created_at": 1594047354000,
              "event": "renamed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3516345038",
              "actor": "ins0",
              "rename": {
                "from": "Add Mittwald Vault Libraries",
                "to": "Docs: Add Mittwald Vault Libraries"
              }
            },
            {
              "id": 3533447753,
              "created_at": 1594379387000,
              "event": "base_ref_changed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3533447753",
              "actor": "ins0"
            },
            {
              "id": 3533449469,
              "created_at": 1594379423000,
              "event": "base_ref_changed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3533449469",
              "actor": "ins0"
            },
            {
              "id": 656620872,
              "created_at": 1594379460000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/656620872",
              "actor": "ins0",
              "body": "@austingebauer @kalafut is there anything i need to check or idk - not sure how to progress on this. Thanks! :)",
              "user": "ins0",
              "html_url": "https://github.com/hashicorp/vault/pull/9402#issuecomment-656620872"
            },
            {
              "id": 3533451276,
              "created_at": 1594379460000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3533451276",
              "actor": "here"
            },
            {
              "id": 3533451277,
              "created_at": 1594379460000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3533451277",
              "actor": "here"
            }
          ]
        },
        {
          "id": "655966548",
          "node_id": "MDU6SXNzdWU2NTU5NjY1NDg=",
          "number": 9462,
          "html_url": "https://github.com/hashicorp/vault/issues/9462",
          "title": "Vault Proxy Protocol support is broken on Google Cloud",
          "user": {
            "type": "user",
            "login": "upodroid"
          },
          "labels": [],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594656206000,
          "updated_at": 1594656206000,
          "author_association": "NONE",
          "body": "<!-- Please reserve GitHub issues for bug reports and feature requests.\r\n\r\nFor questions, the best place to get answers is on our [discussion forum](https://discuss.hashicorp.com/c/vault), as they will get more visibility from experienced users than the issue tracker.\r\n\r\nPlease note: We take Vault's security and our users' trust very seriously. If you believe you have found a security issue in Vault, please responsibly disclose by contacting us at security@hashicorp.com. Our PGP key is available at [our security page](https://www.hashicorp.com/security/).\r\n\r\n-->\r\n\r\n**Describe the bug**\r\n\r\nVault fails to pass Google Health Checks that have proxy protocol enabled. Google Support investigated this and concluded with the following:\r\n\r\nThe product team found out that vault is not prepared to handle PROXY1V_UNKNOWN string. That is why the healthchecks were failing.\r\n\r\nI will share the findings below:\r\n\r\nhttps://github.com/hashicorp/vault/blob/3831cbfac99222866c0f4eb3b9f563f37e2852aa/command/server/listener.go#L43 - vault proxy protocol setup\r\n\r\nhttps://github.com/hashicorp/vault/blob/3831cbfac99222866c0f4eb3b9f563f37e2852aa/helper/proxyutil/proxyutil.go#L9 - proxy protocol implemented in first link - which can handle the `unknown` string - https://github.com/armon/go-proxyproto/blob/f0b8253b1507a570415b16910691d11751a0685c/protocol.go#L52 , but doesn't, as can be seen in proxyutil.go\r\n\r\nGiven that the healthcheck failed due to vault not being prepared to receive the \"UNKNOWN\" string, we will not pursue this as a fixable issue.\r\n\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Deploy Google Cloud LB with a Google HC that has the following config.\r\n```\r\ncheckIntervalSec: 1\r\ncreationTimestamp: '2020-06-28T13:37:23.358-07:00'\r\ndescription: ''\r\nhealthyThreshold: 2\r\nhttp2HealthCheck:\r\n  host: vault.upo.one\r\n  port: 8200\r\n  proxyHeader: PROXY_V1\r\n  requestPath: /v1/sys/health\r\nid: '471244148877640044'\r\nkind: compute#healthCheck\r\nlogConfig:\r\n  enable: true\r\nname: vault-hc\r\nselfLink: https://www.googleapis.com/compute/v1/projects/REDACTED/global/healthChecks/vault-hc\r\ntimeoutSec: 1\r\ntype: HTTP2\r\nunhealthyThreshold: 2\r\n```\r\n\r\n**Expected behavior**\r\nIt should work but SSL failures happen.\r\n\r\nApp Log:\r\n\r\n```\r\n{\"@level\":\"info\",\"@message\":\"http: TLS handshake error from 130.211.0.205:45346: read tcp 10.100.0.20:8200-\\u003e130.211.0.205:45346: use of closed network connection\",\"@timestamp\":\"2020-06-29T09:34:20.480293Z\"}\r\n2020-06-29 09:34:20.742588 I | [ERR] Failed to read proxy prefix: Invalid header line: PROXY UNKNOWN\r\n{\"@level\":\"info\",\"@message\":\"http: TLS handshake error from 130.211.0.201:44978: read tcp 10.100.0.20:8200-\\u003e130.211.0.201:44978: use of closed network connection\",\"@timestamp\":\"2020-06-29T09:34:20.742655Z\"}\r\n2020-06-29 09:34:20.751224 I | [ERR] Failed to read proxy prefix: Invalid header line: PROXY UNKNOWN\r\n{\"@level\":\"info\",\"@message\":\"http: TLS handshake error from 130.211.3.46:51922: read tcp 10.100.0.20:8200-\\u003e130.211.3.46:51922: use of closed network connection\",\"@timestamp\":\"2020-06-29T09:34:20.751287Z\"}\r\nLocal HTTP request:\r\n```\r\nVault server configuration file(s):\r\n\r\n```hcl\r\n# Run Vault in HA mode. Even if there's only one Vault node, it doesn't hurt to\r\n# have this set.\r\napi_addr = \"{{ api_addr }}\"\r\ncluster_addr = \"https://{{ ansible_all_ipv4_addresses[0]  }}:8201\"\r\n\r\n# Set debugging level\r\nlog_level = \"{{vault_log_level}}\"\r\nlog_format = \"json\"\r\n\r\n# Enable the UI\r\nui = {{ vault_ui_enabled | to_json }}\r\n\r\n# Enable plugin directory\r\nplugin_directory = \"/etc/vault.d/plugins\"\r\n\r\n# Enable auto-unsealing with Google Cloud KMS\r\nseal \"gcpckms\" {\r\n  project    = \"{{ kms_project }}\"\r\n  region     = \"{{ kms_location }}\"\r\n  key_ring   = \"{{ kms_keyring }}\"\r\n  crypto_key = \"{{ kms_crypto_key }}\"\r\n}\r\n\r\n# Enable HA backend storage with GCS\r\nstorage \"gcs\" {\r\n  bucket     = \"{{ storage_bucket }}\"\r\n  ha_enabled = \"true\"\r\n}\r\n\r\n# Create local non-TLS listener\r\nlistener \"tcp\" {\r\n  address     = \"127.0.0.1:{{ vault_port }}\"\r\n  tls_disable = \"true\"\r\n}\r\n\r\n\r\n# Create an mTLS listener locally. Client's shouldn't talk to Vault directly,\r\n# but not all clients are well-behaved. This is also needed so the nodes can\r\n# communicate with eachother.\r\nlistener \"tcp\" {\r\n  address            = \"{{ ansible_all_ipv4_addresses[0] }}:{{vault_port}}\"\r\n  tls_cert_file      = \"/etc/vault/vault.crt\"\r\n  tls_key_file       = \"/etc/vault/vault.key\"\r\n  #tls_client_ca_file = \"/etc/vault/ca.crt\"\r\n  proxy_protocol_behavior = \"use_always\"\r\n\r\n  tls_disable_client_certs           = {{ vault_tls_disable_client_certs | to_json }}\r\n  tls_require_and_verify_client_cert = {{ vault_tls_require_and_verify_client_cert | to_json }}\r\n}\r\n\r\n# Send data to Stackdriver monitoring\r\ntelemetry {\r\n  stackdriver_project_id = \"{{ kms_project }}\"\r\n  stackdriver_location = \"{{ ansible_domain.split(\".\")[0] | zone_to_region }}\"\r\n  stackdriver_namespace = \"vault\"\r\n  disable_hostname = true\r\n  enable_hostname_label = true\r\n}\r\n\r\n```\r\n\r\n**Additional context**\r\nAdd any other context about the problem here.\r\n",
          "events": []
        },
        {
          "id": "655087530",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ3Njg0MTEy",
          "number": 9459,
          "html_url": "https://github.com/hashicorp/vault/pull/9459",
          "title": "raft/test: fix snapshot peers race test by using committed and applie",
          "user": {
            "type": "user",
            "login": "calvn"
          },
          "labels": [],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594424483000,
          "updated_at": 1594659776000,
          "closed_at": 1594659772000,
          "author_association": "MEMBER",
          "body": "d indexes\r\n\r\nFixes a data race that can occur in `TestRaft_Snapshot_Peers` which happens when we try to compare the follower's FSM database as the snapshot is being restored.\r\n\r\n```\r\n==================\r\nWARNING: DATA RACE\r\nRead at 0x00c000126760 by goroutine 77:\r\n  github.com/hashicorp/vault/physical/raft.TestRaft_Snapshot_Peers()\r\n      /go/src/github.com/hashicorp/vault/physical/raft/snapshot_test.go:261 +0x647\r\n  testing.tRunner()\r\n      /usr/local/go/src/testing/testing.go:991 +0x1eb\r\n\r\nPrevious write at 0x00c000126760 by goroutine 164:\r\n  github.com/hashicorp/vault/physical/raft.(*FSM).openDBFile()\r\n      /go/src/github.com/hashicorp/vault/physical/raft/fsm.go:176 +0x1ba\r\n  github.com/hashicorp/vault/physical/raft.(*FSM).Restore()\r\n      /go/src/github.com/hashicorp/vault/physical/raft/fsm.go:642 +0x71d\r\n  github.com/hashicorp/vault/vendor/github.com/hashicorp/go-raftchunking.(*ChunkingFSM).Restore()\r\n      /go/src/github.com/hashicorp/vault/vendor/github.com/hashicorp/go-raftchunking/fsm.go:164 +0x68\r\n  github.com/hashicorp/vault/vendor/github.com/hashicorp/go-raftchunking.(*ChunkingBatchingFSM).Restore()\r\n      <autogenerated>:1 +0x75\r\n  github.com/hashicorp/vault/vendor/github.com/hashicorp/raft.(*Raft).runFSM.func3()\r\n      /go/src/github.com/hashicorp/vault/vendor/github.com/hashicorp/raft/fsm.go:181 +0x3c3\r\n  github.com/hashicorp/vault/vendor/github.com/hashicorp/raft.(*Raft).runFSM()\r\n      /go/src/github.com/hashicorp/vault/vendor/github.com/hashicorp/raft/fsm.go:222 +0x473\r\n  github.com/hashicorp/vault/vendor/github.com/hashicorp/raft.(*Raft).runFSM-fm()\r\n      /go/src/github.com/hashicorp/vault/vendor/github.com/hashicorp/raft/fsm.go:69 +0x41\r\n  github.com/hashicorp/vault/vendor/github.com/hashicorp/raft.(*raftState).goFunc.func1()\r\n      /go/src/github.com/hashicorp/vault/vendor/github.com/hashicorp/raft/state.go:146 +0x6e\r\n\r\nGoroutine 77 (running) created at:\r\n  testing.(*T).Run()\r\n      /usr/local/go/src/testing/testing.go:1042 +0x660\r\n  testing.runTests.func1()\r\n      /usr/local/go/src/testing/testing.go:1284 +0xa6\r\n  testing.tRunner()\r\n      /usr/local/go/src/testing/testing.go:991 +0x1eb\r\n  testing.runTests()\r\n      /usr/local/go/src/testing/testing.go:1282 +0x527\r\n  testing.(*M).Run()\r\n      /usr/local/go/src/testing/testing.go:1199 +0x2ff\r\n  main.main()\r\n      _testmain.go:98 +0x223\r\n\r\nGoroutine 164 (running) created at:\r\n  github.com/hashicorp/vault/vendor/github.com/hashicorp/raft.(*raftState).goFunc()\r\n      /go/src/github.com/hashicorp/vault/vendor/github.com/hashicorp/raft/state.go:144 +0x73\r\n  github.com/hashicorp/vault/vendor/github.com/hashicorp/raft.NewRaft()\r\n      /go/src/github.com/hashicorp/vault/vendor/github.com/hashicorp/raft/api.go:563 +0x167b\r\n  github.com/hashicorp/vault/physical/raft.(*RaftBackend).SetupCluster()\r\n      /go/src/github.com/hashicorp/vault/physical/raft/raft.go:677 +0xa4c\r\n  github.com/hashicorp/vault/physical/raft.addPeer()\r\n      /go/src/github.com/hashicorp/vault/physical/raft/snapshot_test.go:48 +0x364\r\n  github.com/hashicorp/vault/physical/raft.TestRaft_Snapshot_Peers()\r\n      /go/src/github.com/hashicorp/vault/physical/raft/snapshot_test.go:255 +0x59e\r\n  testing.tRunner()\r\n      /usr/local/go/src/testing/testing.go:991 +0x1eb\r\n==================\r\n==================\r\nWARNING: DATA RACE\r\nWrite at 0x00c000306bb8 by goroutine 77:\r\n  sync/atomic.CompareAndSwapInt32()\r\n      /usr/local/go/src/runtime/race_amd64.s:293 +0xb\r\n  sync.(*Mutex).Lock()\r\n      /usr/local/go/src/sync/mutex.go:74 +0x49\r\n  github.com/hashicorp/vault/vendor/go.etcd.io/bbolt.(*DB).beginTx()\r\n      /go/src/github.com/hashicorp/vault/vendor/go.etcd.io/bbolt/db.go:551 +0x61\r\n  github.com/hashicorp/vault/vendor/go.etcd.io/bbolt.(*DB).Begin()\r\n      /go/src/github.com/hashicorp/vault/vendor/go.etcd.io/bbolt/db.go:544 +0x9e\r\n  github.com/hashicorp/vault/vendor/go.etcd.io/bbolt.(*DB).View()\r\n      /go/src/github.com/hashicorp/vault/vendor/go.etcd.io/bbolt/db.go:709 +0x60\r\n  github.com/hashicorp/vault/physical/raft.compareDBs()\r\n      /go/src/github.com/hashicorp/vault/physical/raft/raft_test.go:190 +0x18b\r\n  github.com/hashicorp/vault/physical/raft.TestRaft_Snapshot_Peers()\r\n      /go/src/github.com/hashicorp/vault/physical/raft/snapshot_test.go:261 +0x67b\r\n  testing.tRunner()\r\n      /usr/local/go/src/testing/testing.go:991 +0x1eb\r\n\r\nPrevious write at 0x00c000306bb8 by goroutine 164:\r\n  github.com/hashicorp/vault/vendor/go.etcd.io/bbolt.Open()\r\n      /go/src/github.com/hashicorp/vault/vendor/go.etcd.io/bbolt/db.go:179 +0x71\r\n  github.com/hashicorp/vault/physical/raft.(*FSM).openDBFile()\r\n      /go/src/github.com/hashicorp/vault/physical/raft/fsm.go:130 +0x13e\r\n  github.com/hashicorp/vault/physical/raft.(*FSM).Restore()\r\n      /go/src/github.com/hashicorp/vault/physical/raft/fsm.go:642 +0x71d\r\n  github.com/hashicorp/vault/vendor/github.com/hashicorp/go-raftchunking.(*ChunkingFSM).Restore()\r\n      /go/src/github.com/hashicorp/vault/vendor/github.com/hashicorp/go-raftchunking/fsm.go:164 +0x68\r\n  github.com/hashicorp/vault/vendor/github.com/hashicorp/go-raftchunking.(*ChunkingBatchingFSM).Restore()\r\n      <autogenerated>:1 +0x75\r\n  github.com/hashicorp/vault/vendor/github.com/hashicorp/raft.(*Raft).runFSM.func3()\r\n      /go/src/github.com/hashicorp/vault/vendor/github.com/hashicorp/raft/fsm.go:181 +0x3c3\r\n  github.com/hashicorp/vault/vendor/github.com/hashicorp/raft.(*Raft).runFSM()\r\n      /go/src/github.com/hashicorp/vault/vendor/github.com/hashicorp/raft/fsm.go:222 +0x473\r\n  github.com/hashicorp/vault/vendor/github.com/hashicorp/raft.(*Raft).runFSM-fm()\r\n      /go/src/github.com/hashicorp/vault/vendor/github.com/hashicorp/raft/fsm.go:69 +0x41\r\n  github.com/hashicorp/vault/vendor/github.com/hashicorp/raft.(*raftState).goFunc.func1()\r\n      /go/src/github.com/hashicorp/vault/vendor/github.com/hashicorp/raft/state.go:146 +0x6e\r\n\r\nGoroutine 77 (running) created at:\r\n  testing.(*T).Run()\r\n      /usr/local/go/src/testing/testing.go:1042 +0x660\r\n  testing.runTests.func1()\r\n      /usr/local/go/src/testing/testing.go:1284 +0xa6\r\n  testing.tRunner()\r\n      /usr/local/go/src/testing/testing.go:991 +0x1eb\r\n  testing.runTests()\r\n      /usr/local/go/src/testing/testing.go:1282 +0x527\r\n  testing.(*M).Run()\r\n      /usr/local/go/src/testing/testing.go:1199 +0x2ff\r\n  main.main()\r\n      _testmain.go:98 +0x223\r\n\r\nGoroutine 164 (running) created at:\r\n  github.com/hashicorp/vault/vendor/github.com/hashicorp/raft.(*raftState).goFunc()\r\n      /go/src/github.com/hashicorp/vault/vendor/github.com/hashicorp/raft/state.go:144 +0x73\r\n  github.com/hashicorp/vault/vendor/github.com/hashicorp/raft.NewRaft()\r\n      /go/src/github.com/hashicorp/vault/vendor/github.com/hashicorp/raft/api.go:563 +0x167b\r\n  github.com/hashicorp/vault/physical/raft.(*RaftBackend).SetupCluster()\r\n      /go/src/github.com/hashicorp/vault/physical/raft/raft.go:677 +0xa4c\r\n  github.com/hashicorp/vault/physical/raft.addPeer()\r\n      /go/src/github.com/hashicorp/vault/physical/raft/snapshot_test.go:48 +0x364\r\n  github.com/hashicorp/vault/physical/raft.TestRaft_Snapshot_Peers()\r\n      /go/src/github.com/hashicorp/vault/physical/raft/snapshot_test.go:255 +0x59e\r\n  testing.tRunner()\r\n      /usr/local/go/src/testing/testing.go:991 +0x1eb\r\n==================\r\n```",
          "milestone": {
            "id": "5107883",
            "number": 65,
            "title": "1.5"
          },
          "events": []
        },
        {
          "id": "655032845",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ3NjQxNDk0",
          "number": 9454,
          "html_url": "https://github.com/hashicorp/vault/pull/9454",
          "title": "Adds documentation for OIDC provider specific extension for G Suite",
          "user": {
            "type": "user",
            "login": "austingebauer"
          },
          "labels": [
            {
              "id": "1874015060",
              "node_id": "MDU6TGFiZWwxODc0MDE1MDYw",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/docs-cherrypick",
              "name": "docs-cherrypick",
              "color": "0e8a16",
              "description": "",
              "default": false
            }
          ],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 1,
          "created_at": 1594414723000,
          "updated_at": 1594662119000,
          "author_association": "MEMBER",
          "body": "This PR adds documentation for using an OIDC provider specific extension for G Suite that allows for fetching of groups and user information during authentication. Please see the rendered [documentation preview](https://5f08d685c1a9d20007bb58da--vault-www.netlify.app/docs/auth/jwt_oidc_providers#google-specific-handling-configuration).\r\n\r\nAssociated PR for the feature: https://github.com/hashicorp/vault-plugin-auth-jwt/pull/123",
          "events": []
        },
        {
          "id": "656059339",
          "node_id": "MDU6SXNzdWU2NTYwNTkzMzk=",
          "number": 9468,
          "html_url": "https://github.com/hashicorp/vault/issues/9468",
          "title": "DOCS: API documentation for endpoint sys/internal/ui/resultant-acl",
          "user": {
            "type": "user",
            "login": "stuartpurgavie"
          },
          "labels": [],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594665690000,
          "updated_at": 1594665715000,
          "author_association": "CONTRIBUTOR",
          "body": "**Is your feature request related to a problem? Please describe.**\r\nThere doesn't seem to be documentation for the endpoint `sys/internal/ui/resultant-acl` however it is present in the `default` policy and obviously returns data.\r\n\r\n**Describe the solution you'd like**\r\nWould like to see documentation on the endpoint, including what parameters it takes, if any.\r\n\r\n**Explain any additional use-cases**\r\nPossible additional use case for being able to provide a token, entity, or role to the endpoint as a parameter to see what the resultant ACL would be for that object, if it does not exist. Without documentation it's hard to know, but seems likely it's an introspection endpoint only, which is only useful to a given token.\r\n\r\n**Additional context**\r\nWas attempting to [troubleshoot an ACL issue](https://groups.google.com/forum/#!msg/vault-tool/PbwI7iDg5WY/nUmRXZDcBgAJ) where when `+` is used as a path segment wildcard, there are some unexpected resultant ACLs. This seemed like it could be a useful endpoint for figuring out what was going on in the user's scenario. Yes, the `sys/capabilities*` family of endpoints does exist, but you have to know the paths in advance to query, whereas the `resultant-acl` endpoint simply lists all endpoints for you without passing paths as parameters.\r\n",
          "events": []
        },
        {
          "id": "655072086",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ3NjcxOTQ2",
          "number": 9458,
          "html_url": "https://github.com/hashicorp/vault/pull/9458",
          "title": "quotas: fix data race that could occur if ApplyQuota was called durin",
          "user": {
            "type": "user",
            "login": "calvn"
          },
          "labels": [],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 2,
          "created_at": 1594420893000,
          "updated_at": 1594665763000,
          "closed_at": 1594665760000,
          "author_association": "MEMBER",
          "body": "g a db reset\r\n\r\n```\r\n==================\r\nWARNING: DATA RACE\r\nWrite at 0x00c000b76b48 by goroutine 144:\r\n  github.com/hashicorp/vault/vault/quotas.(*Manager).Reset()\r\n      /go/src/github.com/hashicorp/vault/vault/quotas/quotas.go:541 +0x112\r\n  github.com/hashicorp/vault/vault.(*Core).sealInternalWithOptions()\r\n      /go/src/github.com/hashicorp/vault/vault/core.go:1842 +0x790\r\n  github.com/hashicorp/vault/vault.(*Core).sealInternal()\r\n      /go/src/github.com/hashicorp/vault/vault/core.go:1729 +0xc8\r\n  github.com/hashicorp/vault/vault.(*Core).Shutdown()\r\n      /go/src/github.com/hashicorp/vault/vault/core.go:972 +0xab\r\n  github.com/hashicorp/vault/vault.(*TestClusterCore).stop()\r\n      /go/src/github.com/hashicorp/vault/vault/testing.go:856 +0x270\r\n  github.com/hashicorp/vault/vault.(*TestCluster).Cleanup.func1()\r\n      /go/src/github.com/hashicorp/vault/vault/testing.go:903 +0x8a\r\n\r\nPrevious read at 0x00c000b76b48 by goroutine 179:\r\n  github.com/hashicorp/vault/vault/quotas.(*Manager).queryQuota()\r\n      /go/src/github.com/hashicorp/vault/vault/quotas/quotas.go:384 +0x84e\r\n  github.com/hashicorp/vault/vault/quotas.(*Manager).ApplyQuota()\r\n      /go/src/github.com/hashicorp/vault/vault/quotas/quotas.go:497 +0x66\r\n  github.com/hashicorp/vault/vault.(*Core).ApplyRateLimitQuota()\r\n      /go/src/github.com/hashicorp/vault/vault/core.go:2536 +0xc7\r\n  github.com/hashicorp/vault/http.rateLimitQuotaWrapping.func1()\r\n      /go/src/github.com/hashicorp/vault/http/util.go:50 +0x4dd\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /usr/local/go/src/net/http/server.go:2012 +0x51\r\n  github.com/hashicorp/vault/http.wrapGenericHandler.func1()\r\n      /go/src/github.com/hashicorp/vault/http/handler.go:308 +0x7bf\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /usr/local/go/src/net/http/server.go:2012 +0x51\r\n  github.com/hashicorp/vault/vendor/github.com/hashicorp/go-cleanhttp.PrintablePathCheckHandler.func1()\r\n      /go/src/github.com/hashicorp/vault/vendor/github.com/hashicorp/go-cleanhttp/handlers.go:42 +0x105\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /usr/local/go/src/net/http/server.go:2012 +0x51\r\n  net/http.serverHandler.ServeHTTP()\r\n      /usr/local/go/src/net/http/server.go:2807 +0xce\r\n  net/http.initALPNRequest.ServeHTTP()\r\n      /usr/local/go/src/net/http/server.go:3381 +0xfc\r\n  net/http.(*initALPNRequest).ServeHTTP()\r\n      <autogenerated>:1 +0xa6\r\n  net/http.Handler.ServeHTTP-fm()\r\n      /usr/local/go/src/net/http/server.go:87 +0x64\r\n  net/http.(*http2serverConn).runHandler()\r\n      /usr/local/go/src/net/http/h2_bundle.go:5720 +0xc0\r\n\r\nGoroutine 144 (running) created at:\r\n  github.com/hashicorp/vault/vault.(*TestCluster).Cleanup()\r\n      /go/src/github.com/hashicorp/vault/vault/testing.go:901 +0x2cc\r\n  github.com/hashicorp/vault/command.testAgentExitAfterAuth()\r\n      /go/src/github.com/hashicorp/vault/command/agent_test.go:411 +0x1864\r\n  github.com/hashicorp/vault/command.TestAgent_ExitAfterAuth.func1()\r\n      /go/src/github.com/hashicorp/vault/command/agent_test.go:230 +0x3d\r\n  testing.tRunner()\r\n      /usr/local/go/src/testing/testing.go:991 +0x1eb\r\n\r\nGoroutine 179 (running) created at:\r\n  net/http.(*http2serverConn).processHeaders()\r\n      /usr/local/go/src/net/http/h2_bundle.go:5454 +0x907\r\n  net/http.(*http2serverConn).processFrame()\r\n      /usr/local/go/src/net/http/h2_bundle.go:4983 +0x480\r\n  net/http.(*http2serverConn).processFrameFromReader()\r\n      /usr/local/go/src/net/http/h2_bundle.go:4941 +0x7b5\r\n  net/http.(*http2serverConn).serve()\r\n      /usr/local/go/src/net/http/h2_bundle.go:4440 +0x148f\r\n  net/http.(*http2Server).ServeConn()\r\n      /usr/local/go/src/net/http/h2_bundle.go:4038 +0xd9b\r\n  net/http.http2ConfigureServer.func1()\r\n      /usr/local/go/src/net/http/h2_bundle.go:3864 +0x117\r\n  net/http.(*conn).serve()\r\n      /usr/local/go/src/net/http/server.go:1805 +0x1ce5\r\n==================\r\n```",
          "milestone": {
            "id": "5107883",
            "number": 65,
            "title": "1.5"
          },
          "events": []
        },
        {
          "id": "655282015",
          "node_id": "MDU6SXNzdWU2NTUyODIwMTU=",
          "number": 9460,
          "html_url": "https://github.com/hashicorp/vault/issues/9460",
          "title": "Startup error: cannot mount under existing mount",
          "user": {
            "type": "user",
            "login": "Rukenshia"
          },
          "labels": [],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594502664000,
          "updated_at": 1594667828000,
          "closed_at": 1594667828000,
          "author_association": "NONE",
          "body": "Hi,\r\n\r\nwe restarted our Vault server and have the following issue:\r\n\r\nVault Version: 0.8.3\r\nSealing mechanism: Shamir\r\nStorage: S3\r\nFailure: failed to mount entry: path=foo/test/bar/ error=cannot mount under existing mount 'foo/test/'\r\n\r\nWe found out that Vault need to mount foo/test/bar/ before foo/test/ but does it in the wrong oder in the mounts table. \r\nI our idea is to change the mount table manually, is there any way to decrypt the mount table and change the values?\r\n\r\ncheers,",
          "events": [
            {
              "id": 3540944012,
              "created_at": 1594667828000,
              "event": "closed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3540944012",
              "actor": "Rukenshia"
            }
          ]
        },
        {
          "id": "656052451",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ4NDE4ODcx",
          "number": 9467,
          "html_url": "https://github.com/hashicorp/vault/pull/9467",
          "title": "Add truthy check for data.policies before calling 'includes' on it",
          "user": {
            "type": "user",
            "login": "chelshaw"
          },
          "labels": [
            {
              "id": "965254381",
              "node_id": "MDU6TGFiZWw5NjUyNTQzODE=",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/backport",
              "name": "backport",
              "color": "ed8496",
              "description": "",
              "default": false
            },
            {
              "id": "872623767",
              "node_id": "MDU6TGFiZWw4NzI2MjM3Njc=",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/ui",
              "name": "ui",
              "color": "88e56e",
              "description": "",
              "default": false
            }
          ],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594664918000,
          "updated_at": 1594671295000,
          "closed_at": 1594670846000,
          "author_association": "CONTRIBUTOR",
          "body": "This _should_ fix issue #9179 but unfortunately I haven't been able to replicate the same behavior, before or after the fix. \r\n\r\nShould be backported to the next 1.4.x release. Still looking into what could be causing the root issue (`policies` is saved as null) and open to other ways this could be addressed",
          "events": []
        },
        {
          "id": "656117710",
          "node_id": "MDU6SXNzdWU2NTYxMTc3MTA=",
          "number": 9471,
          "html_url": "https://github.com/hashicorp/vault/issues/9471",
          "title": "Recovery Seal Type incorrectly reported by vault status with Azure Key Vault",
          "user": {
            "type": "user",
            "login": "manderson-it"
          },
          "labels": [],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594672090000,
          "updated_at": 1594672090000,
          "author_association": "NONE",
          "body": "**Describe the bug**\r\nInconsistent reporting of Recovery Seal Type with `vault status` command when using Azure Key Vault for Auto-Unseal.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Follow official guide [here](https://learn.hashicorp.com/vault/operations/autounseal-azure-keyvault#step-2-test-the-auto-unseal-feature)\r\n2. Run `vault status` in UNinitialized state (reports Recovery Seal Type       azurekeyvault)\r\n3. Run `vault operator init`\r\n4. Run `vault status` in initialized and unsealed state via auto-unseal (reports Recovery Seal Type       shamir)\r\n5. Run `sudo systemctl stop vault`\r\n6. Run `sudo systemctl start vault`\r\n7. Run `vault status` (same result as before) in initialized and unsealed state via auto-unseal (reports Recovery Seal Type       shamir)\r\n\r\n**Expected behavior**\r\nThe output of `vault status` should consistently report **Recovery Seal Type azurekeyvault** when the seal \"azurekeyvault\" stanza is used, and not **Recovery Seal Type       shamir**\r\n\r\n**Environment:**\r\n* Vault Server Version (retrieve with `vault status`): 1.4.2\r\n* Vault CLI Version (retrieve with `vault version`): Vault v1.4.2\r\n* Server Operating System/Architecture: Ubuntu 16.04.6 LTS (Xenial Xerus) from Azure default image\r\n\r\nVault server configuration file(s):\r\n\r\n```hcl\r\n# Config from above mentioned Auto-Unseal guide\r\nstorage \"file\" {\r\n  path = \"/opt/vault\"\r\n}\r\nlistener \"tcp\" {\r\n  address     = \"0.0.0.0:8200\"\r\n  tls_disable = 1\r\n}\r\nseal \"azurekeyvault\" {\r\n  client_id      = \"omitted\"\r\n  client_secret  = \"omitted\"\r\n  tenant_id      = \"omitted\"\r\n  vault_name     = \"ault-ffb26b1d\"\r\n  key_name       = \"gen-key\"\r\n}\r\nui=true\r\ndisable_mlock = true\r\n```\r\n\r\n**Additional context**\r\nThe output with `journalctl -xe -u vault` after service start is correct, btw.\r\n\r\n```bash\r\nJul 13 19:01:14 azure-auth-demo-vm vault[2358]: ==> Vault server configuration:\r\nJul 13 19:01:14 azure-auth-demo-vm vault[2358]:        Azure Environment: AzurePublicCloud\r\nJul 13 19:01:14 azure-auth-demo-vm vault[2358]:           Azure Key Name: gen-key\r\nJul 13 19:01:14 azure-auth-demo-vm vault[2358]:         Azure Vault Name: marek2-vault-ffb26b1d\r\nJul 13 19:01:14 azure-auth-demo-vm vault[2358]:                Seal Type: azurekeyvault\r\nJul 13 19:01:14 azure-auth-demo-vm vault[2358]:                      Cgo: disabled\r\nJul 13 19:01:14 azure-auth-demo-vm vault[2358]:               Listener 1: tcp (addr: \"0.0.0.0:8200\", cluster address: \"0.0.0.0:8201\", max_request_durat\r\nJul 13 19:01:14 azure-auth-demo-vm vault[2358]:                Log Level: info\r\nJul 13 19:01:14 azure-auth-demo-vm vault[2358]:                    Mlock: supported: true, enabled: false\r\nJul 13 19:01:14 azure-auth-demo-vm vault[2358]:            Recovery Mode: false\r\nJul 13 19:01:14 azure-auth-demo-vm vault[2358]:                  Storage: file\r\nJul 13 19:01:14 azure-auth-demo-vm vault[2358]:                  Version: Vault v1.4.2\r\nJul 13 19:01:14 azure-auth-demo-vm vault[2358]: ==> Vault server started! Log data will stream in below:\r\n```\r\n\r\nSee chronology of entered commands below.\r\n```bash\r\nazureuser@-azure-auth-demo-vm:~$ vault status\r\nKey                      Value\r\n---                      -----\r\nRecovery Seal Type       azurekeyvault\r\nInitialized              false\r\nSealed                   true\r\nTotal Recovery Shares    0\r\nThreshold                0\r\nUnseal Progress          0/0\r\nUnseal Nonce             n/a\r\nVersion                  n/a\r\nHA Enabled               false\r\nazureuser@-azure-auth-demo-vm:~$ vault operator init\r\nRecovery Key 1: omitted\r\nRecovery Key 2: omitted\r\nRecovery Key 3: omitted\r\nRecovery Key 4: omitted\r\nRecovery Key 5: omitted\r\n\r\nInitial Root Token: s.omitted\r\n\r\nSuccess! Vault is initialized\r\n\r\nRecovery key initialized with 5 key shares and a key threshold of 3. Please\r\nsecurely distribute the key shares printed above.\r\nazureuser@-azure-auth-demo-vm:~$ vault status\r\nKey                      Value\r\n---                      -----\r\nRecovery Seal Type       shamir\r\nInitialized              true\r\nSealed                   false\r\nTotal Recovery Shares    5\r\nThreshold                3\r\nVersion                  1.4.2\r\nCluster Name             vault-cluster-72d4b966\r\nCluster ID               bbe80a92-bb2b-b0f9-a285-fcadf8e44381\r\nHA Enabled               false\r\nazureuser@-azure-auth-demo-vm:~$ vault status\r\nKey                      Value\r\n---                      -----\r\nRecovery Seal Type       shamir\r\nInitialized              true\r\nSealed                   false\r\nTotal Recovery Shares    5\r\nThreshold                3\r\nVersion                  1.4.2\r\nCluster Name             vault-cluster-72d4b966\r\nCluster ID               bbe80a92-bb2b-b0f9-a285-fcadf8e44381\r\nHA Enabled               false\r\n```",
          "events": []
        },
        {
          "id": "656004663",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ4MzgwMTY3",
          "number": 9464,
          "html_url": "https://github.com/hashicorp/vault/pull/9464",
          "title": "Backport 1.5.0: raft/test: fix snapshot peers race test by using committed and applie",
          "user": {
            "type": "user",
            "login": "calvn"
          },
          "labels": [],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594659894000,
          "updated_at": 1594674746000,
          "closed_at": 1594674742000,
          "author_association": "MEMBER",
          "body": "d indexes (#9459)",
          "milestone": {
            "id": "5107883",
            "number": 65,
            "title": "1.5"
          },
          "events": []
        },
        {
          "id": "656061137",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ4NDI2MDI5",
          "number": 9469,
          "html_url": "https://github.com/hashicorp/vault/pull/9469",
          "title": "Backport 1.5.0: quotas: fix data race that could occur if ApplyQuota was called durin",
          "user": {
            "type": "user",
            "login": "calvn"
          },
          "labels": [],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594665891000,
          "updated_at": 1594674766000,
          "closed_at": 1594674762000,
          "author_association": "MEMBER",
          "body": " (#9458)\r\n\r\n* quotas: fix data race that could occur if ApplyQuota was called during a db reset\r\n\r\n* Abstract out the locking caller\r\n\r\n* Remove unneeded lock\r\n\r\n* Update\r\n\r\nCo-authored-by: Vishal Nayak <vishalnayakv@gmail.com>\r\nCo-authored-by: Vishal Nayak <vishalnayak@users.noreply.github.com>",
          "milestone": {
            "id": "5107883",
            "number": 65,
            "title": "1.5"
          },
          "events": []
        },
        {
          "id": "656172592",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ4NTE4ODAw",
          "number": 9473,
          "html_url": "https://github.com/hashicorp/vault/pull/9473",
          "title": "Add RC note on downloads page",
          "user": {
            "type": "user",
            "login": "mladlow"
          },
          "labels": [],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594677541000,
          "updated_at": 1594680214000,
          "closed_at": 1594680211000,
          "author_association": "CONTRIBUTOR",
          "body": "Looks like this locally:\r\n<img width=\"1304\" alt=\"Screen Shot 2020-07-13 at 17 57 07\" src=\"https://user-images.githubusercontent.com/9422872/87357709-7d554b80-c532-11ea-9239-11a5bdb4fda1.png\">\r\n",
          "events": []
        },
        {
          "id": "635813259",
          "node_id": "MDU6SXNzdWU2MzU4MTMyNTk=",
          "number": 9180,
          "html_url": "https://github.com/hashicorp/vault/issues/9180",
          "title": "Vault agent documentation about tls auth unclear",
          "user": {
            "type": "user",
            "login": "drawks"
          },
          "labels": [
            {
              "id": "1658703085",
              "node_id": "MDU6TGFiZWwxNjU4NzAzMDg1",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/core/agent",
              "name": "core/agent",
              "color": "0000ff",
              "description": "",
              "default": false
            },
            {
              "id": "1024442799",
              "node_id": "MDU6TGFiZWwxMDI0NDQyNzk5",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/docs",
              "name": "docs",
              "color": "b2ffb7",
              "description": "",
              "default": false
            },
            {
              "id": "1488905226",
              "node_id": "MDU6TGFiZWwxNDg4OTA1MjI2",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/enhancement",
              "name": "enhancement",
              "color": "0d8232",
              "description": "",
              "default": true
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": {
            "type": "user",
            "login": "calvn"
          },
          "assignees": [
            {
              "type": "user",
              "login": "calvn"
            }
          ],
          "comments": 2,
          "created_at": 1591744101000,
          "updated_at": 1594682779000,
          "author_association": "NONE",
          "body": "<!-- Please reserve GitHub issues for bug reports and feature requests.\r\n\r\nFor questions, the best place to get answers is on our [mailing list](https://groups.google.com/forum/#!forum/vault-tool), as they will get more visibility from experienced users than the issue tracker.\r\n\r\nPlease note: We take Vault's security and our users' trust very seriously. If you believe you have found a security issue in Vault, please responsibly disclose by contacting us at security@hashicorp.com. Our PGP key is available at [our security page](https://www.hashicorp.com/security/).\r\n\r\n-->\r\n\r\n**Describe the bug**\r\nWhen using the vault-agent in cache mode clients connecting to the agent/cache cannot use tls/cert authentication provided by the client. It is obvious why this doesn't work when you really think about how tls/ssl works, however it would be nice if the documentation made this clearer.\r\n\r\nAdditionally I think it is surprising behavior that if you configure the agent's `vault` stanza with `client_key` and `client_cert` that any client connecting to the agent and issuing `vault login -method=cert` will have the agent's key material used to authenticate against the server's cert authentication endpoint regardless of what cert/key is actually provided by the client.\r\n\r\n**To Reproduce**\r\n1.  run vault agent configured in cache mode with no configured auto-auth and no `client_key` or `client_cert` provided in the `vault` stanza.\r\n2. attempt to use a known good configured cert pair to login to the cert auth endpoint at the agent's configured tcp listener.\r\n3. observe the server respond via the agent with a `400  * client certificate must be supplied`\r\n\r\n**Expected behavior**\r\nI expect this to fail as described, however the documentation could use a bit more explicit language around the expectations of cert authentication and agent. In the course of doing experiments with vault agent I found both the above behaviors quite surprising until I really considered the data flows.\r\n\r\n**Environment:**\r\n* Vault Server Version (retrieve with `vault status`): 1.3.4\r\n* Vault CLI Version (retrieve with `vault version`): 1.3.4\r\n* Server Operating System/Architecture: linux",
          "events": [
            {
              "id": 3430770560,
              "created_at": 1591810924000,
              "event": "labeled",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3430770560",
              "actor": "austingebauer",
              "label": "docs"
            },
            {
              "id": 3430770561,
              "created_at": 1591810925000,
              "event": "labeled",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3430770561",
              "actor": "austingebauer",
              "label": "enhancement"
            },
            {
              "id": 647786189,
              "created_at": 1592862484000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/647786189",
              "actor": "drawks",
              "body": "As I play with this a little bit more it occurs to me that this is not just surprising but potentially a security issue. Imagine someone is using vault-agent along with `cert` authentication configured along with `auto_auth` and a properly configured sink. This same person might also enable `cache` with `use_auto_auth_token = false` and a `listener` on loopback in order to provide a local cacheing proxy for various arbitrary vault client access. This is a totally valid and at first glance would appear secure. However an unprivileged user can now get an authentication token via `VAULT_ADDR=http://localhost:8100 vault login -method=cert` as the agent will automatically provide the tls credentials on EVERY upstream vault request.\r\n\r\nIMHO the appropriate fix would be to shift the `client_key` and `client_cert` parameters from the `vault` stanza and into the parameters of the `auto_auth` stanza's `cert` method configuration hash. Otherwise it is dangerously misleading to users that the configuration as such:\r\n\r\n```\r\nvault {\r\n        address = \"https://vault.internal.domain.com:8200\"\r\n\tclient_key = \"/etc/vault-agent/vault-auth.key\"\r\n\tclient_cert = \"/etc/vault-agent/vault-auth.cert\"\r\n}\r\n\r\ncache {\r\n        use_auto_auth_token = false\r\n}\r\n\r\nauto_auth {\r\n\tmethod \"cert\" {}\r\n        sink \"file\" {\r\n                config = {\r\n                        path = \"/var/run/application/private/vault.token\"\r\n                }\r\n        }\r\n}\r\n\r\nlistener \"tcp\" {\r\n         address = \"127.0.0.1:8100\"\r\n\t tls_disable = true\r\n}\r\n```\r\n\r\ngives all appearances as to providing an un-authenticated cacheing proxy, however it can be trivially used to authenticate without providing credentials. I would speculate that there is a non-zero number of vault-agent instances running in the world in this configuration currently to which the responsible parties have no idea that it behaves this way and vault doesn't currently raise a warning at runtime nor in the documentation that properly highlights this risk.",
              "user": "drawks",
              "html_url": "https://github.com/hashicorp/vault/issues/9180#issuecomment-647786189"
            },
            {
              "id": 651293860,
              "created_at": 1593456272000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/651293860",
              "actor": "drawks",
              "body": "Will someone please add core/agent and auth/cert and maybe other appropriate labels on this issue? Aside from making this issue surfaced a little better it may help get this documentation and/or behavioral fix prioritized to match the danger it presents as a falling knife in configuring vault agent.",
              "user": "drawks",
              "html_url": "https://github.com/hashicorp/vault/issues/9180#issuecomment-651293860"
            },
            {
              "id": 3516617965,
              "created_at": 1594051106000,
              "event": "labeled",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3516617965",
              "actor": "ncabatoff",
              "label": "core/agent"
            },
            {
              "id": 3541665772,
              "created_at": 1594682779000,
              "event": "assigned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3541665772",
              "actor": "calvn",
              "assignee": "calvn"
            }
          ]
        },
        {
          "id": "656131772",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ4NDgzODkz",
          "number": 9472,
          "html_url": "https://github.com/hashicorp/vault/pull/9472",
          "title": "Backport: Add truthy check for data.policies before calling 'includes' (#9467)",
          "user": {
            "type": "user",
            "login": "chelshaw"
          },
          "labels": [
            {
              "id": "872623767",
              "node_id": "MDU6TGFiZWw4NzI2MjM3Njc=",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/ui",
              "name": "ui",
              "color": "88e56e",
              "description": "",
              "default": false
            }
          ],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594673603000,
          "updated_at": 1594683783000,
          "closed_at": 1594683777000,
          "author_association": "CONTRIBUTOR",
          "body": "Backport of PR #9467 \r\n ",
          "milestone": {
            "id": "5107883",
            "number": 65,
            "title": "1.5"
          },
          "events": []
        },
        {
          "id": "109191864",
          "node_id": "MDU6SXNzdWUxMDkxOTE4NjQ=",
          "number": 657,
          "html_url": "https://github.com/hashicorp/vault/issues/657",
          "title": "Missing Client Token",
          "user": {
            "type": "user",
            "login": "ascot21"
          },
          "labels": [],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 10,
          "created_at": 1443651472000,
          "updated_at": 1594706452000,
          "closed_at": 1443665314000,
          "author_association": "NONE",
          "body": "I have setup Vault with Consul on an AWS EC2 instance and am trying to connect to it remotely by running the vault binary I've installed on my local machine.  I'm getting a `missing client token` error when  running read or write commands.  \n\nI've set local environment variables VAULT_TOKEN and VAULT_ADDR to the appropriate values and can even run commands directly with curl.\n\nRunning the following:\n\n``` bash\ncurl -X GET -H \"X-Vault-Token:$VAULT_TOKEN\" http://mydomain.com/v1/secret/test\n```\n\nsucceeds with the response\n\n```\n{\"lease_id\":\"\",\"renewable\":false,\"lease_duration\":2592000,\"data\":{\"value\":\"blah\"},\"auth\":null}\n```\n\nHowever when I run\n\n```\nvault read secret/token\n```\n\nit fails with\n\n```\nError reading secret/test: Error making API request.\n\nURL: GET http://mydomain.com/v1/secret/test\nCode: 400. Errors:\n\n* missing client token\n```\n\nI've even tried passing in the VAULT_TOKEN to the vault command itself as `VAULT_TOKEN=my-token vault read secret/token` and I get the same error.\n\nThe Vault binary clearly pulls in the VAULT_ADDR as it hits the right domain but for some reason the VAULT_TOKEN isn't being pulled in.\n\nI am using the generic backend and just testing out reading and writing some basic secrets.  I'm using the basic token authentication and authorization that's built in.\n\nWhat could be causing this?\n",
          "events": [
            {
              "id": 144593719,
              "created_at": 1443664775000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/144593719",
              "actor": "jefferai",
              "body": "The most likely culprit would be a 0.3 server and a 0.2 client.\n",
              "user": "jefferai",
              "html_url": "https://github.com/hashicorp/vault/issues/657#issuecomment-144593719"
            },
            {
              "id": 144594538,
              "created_at": 1443665313000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/144594538",
              "actor": "ascot21",
              "body": "@jefferai that was it.  Closing this.\n",
              "user": "ascot21",
              "html_url": "https://github.com/hashicorp/vault/issues/657#issuecomment-144594538"
            },
            {
              "id": 423778692,
              "created_at": 1443665313000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/423778692",
              "actor": "jefferai"
            },
            {
              "id": 423778693,
              "created_at": 1443665313000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/423778693",
              "actor": "jefferai"
            },
            {
              "id": 423778694,
              "created_at": 1443665314000,
              "event": "closed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/423778694",
              "actor": "ascot21"
            },
            {
              "id": 237322449,
              "created_at": 1470248181000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/237322449",
              "actor": "gvenka008c",
              "body": "@ascot21 @jefferai I am getting the error as below. Thoughts?\n\n```\n# vault write secret/elements/2.0/QA/marathon value=123456 \nError writing data to secret/elements/2.0/QA/marathon: Error making API request.\n\nURL: PUT http://127.0.0.1:8200/v1/secret/elements/2.0/QA/marathon\nCode: 400. Errors:\n\n* permission denied\n```\n",
              "user": "gvenka008c",
              "html_url": "https://github.com/hashicorp/vault/issues/657#issuecomment-237322449"
            },
            {
              "id": 744232241,
              "created_at": 1470248181000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/744232241",
              "actor": "ascot21"
            },
            {
              "id": 744232242,
              "created_at": 1470248181000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/744232242",
              "actor": "ascot21"
            },
            {
              "id": 744232244,
              "created_at": 1470248181000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/744232244",
              "actor": "jefferai"
            },
            {
              "id": 744232246,
              "created_at": 1470248181000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/744232246",
              "actor": "jefferai"
            },
            {
              "id": 237364100,
              "created_at": 1470256453000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/237364100",
              "actor": "vishalnayak",
              "body": "@gvenka008c It looks like the Vault token (likely in ~/.vault-token) is not updated properly.\nTry doing a `vault auth <valid_token>` and see if it solves your problem.\n\nAlso, please post questions on the mailing list (https://groups.google.com/forum/m/#!forum/vault-tool) rather than creating new GitHub issues or posting on closed issues. This gets a lot more eyes on any particular question or idea.\n\nIt also prevents problematic issue workflows for questions where either the issue is closed immediately but then discussion continues on a closed issue; or, the issue is not closed, discussion dies down, and the issue remains open indefinitely waiting for further potential replies.\n\nThanks!\n",
              "user": "vishalnayak",
              "html_url": "https://github.com/hashicorp/vault/issues/657#issuecomment-237364100"
            },
            {
              "id": 744410928,
              "created_at": 1470256453000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/744410928",
              "actor": "gvenka008c"
            },
            {
              "id": 744410930,
              "created_at": 1470256453000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/744410930",
              "actor": "gvenka008c"
            },
            {
              "id": 355011890,
              "created_at": 1514986228000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/355011890",
              "actor": "kishorevbhosale",
              "body": "After `vault init` we get a token like `export VAULT_TOKEN=xxxxxx`\r\nThen enter command `vault auth <token>`\r\nThat will solve the problem",
              "user": "kishorevbhosale",
              "html_url": "https://github.com/hashicorp/vault/issues/657#issuecomment-355011890"
            },
            {
              "id": 462102855,
              "created_at": 1549772994000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/462102855",
              "actor": "jinraj",
              "body": "> The most likely culprit would be a 0.3 server and a 0.2 client.\r\n\r\nI am also getting the same error. \r\n\"Error: missing client token\r\n    at handleVaultResponse (/Users/jrao9/Documents/TestProject/node_modules/node-vault/src/index.js:49:21)\r\n    at process._tickCallback (internal/process/next_tick.js:68:7) response: { statusCode: 400, body: { errors: [Array] } } }\"\r\n\r\nI didnt understand, what is the solution you said here.\r\nCould you please give me some steps to resolve this issue.\r\n\r\nThanks in advance.",
              "user": "jinraj",
              "html_url": "https://github.com/hashicorp/vault/issues/657#issuecomment-462102855"
            },
            {
              "id": 476479483,
              "created_at": 1553577629000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/476479483",
              "actor": "AnujNautiyal1956",
              "body": "> The most likely culprit would be a 0.3 server and a 0.2 client.\r\n\r\nHi,Could you please elaborate the probable resolution here ?\r\nFacing the same issue .\r\n\r\nRegards",
              "user": "AnujNautiyal1956",
              "html_url": "https://github.com/hashicorp/vault/issues/657#issuecomment-476479483"
            },
            {
              "id": 487401182,
              "created_at": 1556473898000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/487401182",
              "actor": "markdfisher",
              "body": "> > The most likely culprit would be a 0.3 server and a 0.2 client.\r\n> \r\n> Hi,Could you please elaborate the probable resolution here ?\r\n\r\n\r\nUpdate the copy of vault on the host from which you are trying to access vault - or use the API instead of the CLI to just avoid these issues.",
              "user": "markdfisher",
              "html_url": "https://github.com/hashicorp/vault/issues/657#issuecomment-487401182"
            },
            {
              "id": 494448340,
              "created_at": 1558453669000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/494448340",
              "actor": "madven",
              "body": "for recent versions use `vault login`",
              "user": "madven",
              "html_url": "https://github.com/hashicorp/vault/issues/657#issuecomment-494448340"
            },
            {
              "id": 657985453,
              "created_at": 1594706452000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/657985453",
              "actor": "TheAshwanik",
              "body": "> After `vault init` we get a token like `export VAULT_TOKEN=xxxxxx`\r\n> Then enter command `vault auth <token>`\r\n> That will solve the problem\r\n\r\nThis solved my issue",
              "user": "TheAshwanik",
              "html_url": "https://github.com/hashicorp/vault/issues/657#issuecomment-657985453"
            }
          ]
        },
        {
          "id": "652643175",
          "node_id": "MDU6SXNzdWU2NTI2NDMxNzU=",
          "number": 9415,
          "html_url": "https://github.com/hashicorp/vault/issues/9415",
          "title": "Assuming an IAM Role with sts:AssumeRoleWithWebIdentity requires optional parameter AWS_ROLE_SESSION_NAME to be specified",
          "user": {
            "type": "user",
            "login": "orirawlings"
          },
          "labels": [],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594155845000,
          "updated_at": 1594708310000,
          "closed_at": 1594708310000,
          "author_association": "CONTRIBUTOR",
          "body": "<!-- Please reserve GitHub issues for bug reports and feature requests.\r\n\r\nFor questions, the best place to get answers is on our [discussion forum](https://discuss.hashicorp.com/c/vault), as they will get more visibility from experienced users than the issue tracker.\r\n\r\nPlease note: We take Vault's security and our users' trust very seriously. If you believe you have found a security issue in Vault, please responsibly disclose by contacting us at security@hashicorp.com. Our PGP key is available at [our security page](https://www.hashicorp.com/security/).\r\n\r\n-->\r\n\r\n**Describe the bug**\r\nI recently upgraded to 1.4.3 so that I could use [IAM Roles for Service Accounts (IRSA)](https://docs.aws.amazon.com/eks/latest/userguide/iam-roles-for-service-accounts.html) for assigning an IAM Role to my vault instances using its identity in Kubernetes.\r\n\r\nThe role session name is technically a [required parameter on the STS API](https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRoleWithWebIdentity.html#API_AssumeRoleWithWebIdentity_RequestParameters). Though for other applications running in my cluster, I'd normally omit the role session name and allow it to be [chosen by the AWS SDK](https://github.com/aws/aws-sdk-go/blob/98a279965b6174326bd3fe3283cc534f2027b79d/aws/credentials/stscreds/web_identity_provider.go#L105-L109).\r\n\r\nIt looks like vault forces the AWS_ROLE_SESSION_NAME to be specified to even attempt to assume a role with a web identity though, unable to let the AWS SDK fill in a value.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Follow steps to setup an IAM Role that can be assumed from a Kubernetes service account.\r\n2. Deploy vault to kubernetes without AWS_ROLE_SESSION_NAME specified in the environment variables.\r\n3. vault will fail to unseal if it requires AWS API access to unseal (for example via using KMS)\r\n\r\n**Expected behavior**\r\nI expect vault to assume an IAM Role via IRSA, generating a role session name if one is not provided.\r\n\r\n**Environment:**\r\n* Vault Server Version (retrieve with `vault status`): 1.4.3\r\n* Vault CLI Version (retrieve with `vault version`): 1.4.3\r\n* Server Operating System/Architecture: linux/amd64\r\n\r\nVault server configuration file(s):\r\n\r\n```json\r\n{\r\n  \"api_addr\": \"https://example.com\",\r\n  \"listener\": {\r\n    \"tcp\": {\r\n      \"address\": \"0.0.0.0:8200\",\r\n      \"cluster_address\": \"[::]:8201\",\r\n      \"tls_cert_file\": \"/vault/tls/vault.pem\",\r\n      \"tls_disable\": false,\r\n      \"tls_key_file\": \"/vault/tls/vault.pem\"\r\n    }\r\n  },\r\n  \"seal\": {\r\n    \"awskms\": {\r\n      \"kms_key_id\": \"alias/vault\",\r\n      \"region\": \"us-west-2\"\r\n    }\r\n  },\r\n  \"storage\": {\r\n    \"dynamodb\": {\r\n      \"ha_enabled\": \"true\",\r\n      \"region\": \"us-west-2\",\r\n      \"table\": \"vault_us-west-2_lab\"\r\n    }\r\n  },\r\n  \"ui\": true\r\n}\r\n```\r\n\r\n**Additional context**\r\nAdd any other context about the problem here.\r\n",
          "events": [
            {
              "id": 3522314840,
              "created_at": 1594156077000,
              "commit_id": "1e2c33a1f3d6eb1dd0155d7fe51778abf836c83c",
              "event": "referenced",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3522314840",
              "actor": "orirawlings"
            },
            {
              "created_at": 1594156113000,
              "event": "cross-referenced",
              "actor": "orirawlings",
              "source": {
                "type": "issue",
                "issue": {
                  "url": "https://api.github.com/repos/hashicorp/vault/issues/9416",
                  "repository_url": "https://api.github.com/repos/hashicorp/vault",
                  "labels_url": "https://api.github.com/repos/hashicorp/vault/issues/9416/labels{/name}",
                  "comments_url": "https://api.github.com/repos/hashicorp/vault/issues/9416/comments",
                  "events_url": "https://api.github.com/repos/hashicorp/vault/issues/9416/events",
                  "html_url": "https://github.com/hashicorp/vault/pull/9416",
                  "id": 652646510,
                  "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ1NjgyMTAw",
                  "number": 9416,
                  "title": "Don't require AWS_ROLE_SESSION_NAME to sts:AssumeRoleWithWebIdentity",
                  "user": {
                    "login": "orirawlings",
                    "id": 57213,
                    "node_id": "MDQ6VXNlcjU3MjEz",
                    "avatar_url": "https://avatars0.githubusercontent.com/u/57213?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/orirawlings",
                    "html_url": "https://github.com/orirawlings",
                    "followers_url": "https://api.github.com/users/orirawlings/followers",
                    "following_url": "https://api.github.com/users/orirawlings/following{/other_user}",
                    "gists_url": "https://api.github.com/users/orirawlings/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/orirawlings/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/orirawlings/subscriptions",
                    "organizations_url": "https://api.github.com/users/orirawlings/orgs",
                    "repos_url": "https://api.github.com/users/orirawlings/repos",
                    "events_url": "https://api.github.com/users/orirawlings/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/orirawlings/received_events",
                    "type": "User",
                    "site_admin": false
                  },
                  "labels": [
                    {
                      "id": 965254381,
                      "node_id": "MDU6TGFiZWw5NjUyNTQzODE=",
                      "url": "https://api.github.com/repos/hashicorp/vault/labels/backport",
                      "name": "backport",
                      "color": "ed8496",
                      "default": false,
                      "description": ""
                    }
                  ],
                  "state": "closed",
                  "locked": false,
                  "assignee": {
                    "login": "tvoran",
                    "id": 444265,
                    "node_id": "MDQ6VXNlcjQ0NDI2NQ==",
                    "avatar_url": "https://avatars3.githubusercontent.com/u/444265?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/tvoran",
                    "html_url": "https://github.com/tvoran",
                    "followers_url": "https://api.github.com/users/tvoran/followers",
                    "following_url": "https://api.github.com/users/tvoran/following{/other_user}",
                    "gists_url": "https://api.github.com/users/tvoran/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/tvoran/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/tvoran/subscriptions",
                    "organizations_url": "https://api.github.com/users/tvoran/orgs",
                    "repos_url": "https://api.github.com/users/tvoran/repos",
                    "events_url": "https://api.github.com/users/tvoran/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/tvoran/received_events",
                    "type": "User",
                    "site_admin": false
                  },
                  "assignees": [
                    {
                      "login": "tvoran",
                      "id": 444265,
                      "node_id": "MDQ6VXNlcjQ0NDI2NQ==",
                      "avatar_url": "https://avatars3.githubusercontent.com/u/444265?v=4",
                      "gravatar_id": "",
                      "url": "https://api.github.com/users/tvoran",
                      "html_url": "https://github.com/tvoran",
                      "followers_url": "https://api.github.com/users/tvoran/followers",
                      "following_url": "https://api.github.com/users/tvoran/following{/other_user}",
                      "gists_url": "https://api.github.com/users/tvoran/gists{/gist_id}",
                      "starred_url": "https://api.github.com/users/tvoran/starred{/owner}{/repo}",
                      "subscriptions_url": "https://api.github.com/users/tvoran/subscriptions",
                      "organizations_url": "https://api.github.com/users/tvoran/orgs",
                      "repos_url": "https://api.github.com/users/tvoran/repos",
                      "events_url": "https://api.github.com/users/tvoran/events{/privacy}",
                      "received_events_url": "https://api.github.com/users/tvoran/received_events",
                      "type": "User",
                      "site_admin": false
                    }
                  ],
                  "milestone": {
                    "url": "https://api.github.com/repos/hashicorp/vault/milestones/65",
                    "html_url": "https://github.com/hashicorp/vault/milestone/65",
                    "labels_url": "https://api.github.com/repos/hashicorp/vault/milestones/65/labels",
                    "id": 5107883,
                    "node_id": "MDk6TWlsZXN0b25lNTEwNzg4Mw==",
                    "number": 65,
                    "title": "1.5",
                    "creator": {
                      "login": "briankassouf",
                      "id": 1916073,
                      "node_id": "MDQ6VXNlcjE5MTYwNzM=",
                      "avatar_url": "https://avatars1.githubusercontent.com/u/1916073?v=4",
                      "gravatar_id": "",
                      "url": "https://api.github.com/users/briankassouf",
                      "html_url": "https://github.com/briankassouf",
                      "followers_url": "https://api.github.com/users/briankassouf/followers",
                      "following_url": "https://api.github.com/users/briankassouf/following{/other_user}",
                      "gists_url": "https://api.github.com/users/briankassouf/gists{/gist_id}",
                      "starred_url": "https://api.github.com/users/briankassouf/starred{/owner}{/repo}",
                      "subscriptions_url": "https://api.github.com/users/briankassouf/subscriptions",
                      "organizations_url": "https://api.github.com/users/briankassouf/orgs",
                      "repos_url": "https://api.github.com/users/briankassouf/repos",
                      "events_url": "https://api.github.com/users/briankassouf/events{/privacy}",
                      "received_events_url": "https://api.github.com/users/briankassouf/received_events",
                      "type": "User",
                      "site_admin": false
                    },
                    "open_issues": 3,
                    "closed_issues": 231,
                    "state": "open",
                    "created_at": "2020-02-15T01:20:32Z",
                    "updated_at": "2020-07-17T15:00:07Z"
                  },
                  "comments": 2,
                  "created_at": "2020-07-07T21:08:33Z",
                  "updated_at": "2020-07-14T06:31:51Z",
                  "closed_at": "2020-07-14T06:31:50Z",
                  "author_association": "CONTRIBUTOR",
                  "repository": {
                    "id": 31288958,
                    "node_id": "MDEwOlJlcG9zaXRvcnkzMTI4ODk1OA==",
                    "name": "vault",
                    "full_name": "hashicorp/vault",
                    "private": false,
                    "owner": {
                      "login": "hashicorp",
                      "id": 761456,
                      "node_id": "MDEyOk9yZ2FuaXphdGlvbjc2MTQ1Ng==",
                      "avatar_url": "https://avatars2.githubusercontent.com/u/761456?v=4",
                      "gravatar_id": "",
                      "url": "https://api.github.com/users/hashicorp",
                      "html_url": "https://github.com/hashicorp",
                      "followers_url": "https://api.github.com/users/hashicorp/followers",
                      "following_url": "https://api.github.com/users/hashicorp/following{/other_user}",
                      "gists_url": "https://api.github.com/users/hashicorp/gists{/gist_id}",
                      "starred_url": "https://api.github.com/users/hashicorp/starred{/owner}{/repo}",
                      "subscriptions_url": "https://api.github.com/users/hashicorp/subscriptions",
                      "organizations_url": "https://api.github.com/users/hashicorp/orgs",
                      "repos_url": "https://api.github.com/users/hashicorp/repos",
                      "events_url": "https://api.github.com/users/hashicorp/events{/privacy}",
                      "received_events_url": "https://api.github.com/users/hashicorp/received_events",
                      "type": "Organization",
                      "site_admin": false
                    },
                    "html_url": "https://github.com/hashicorp/vault",
                    "description": "A tool for secrets management, encryption as a service, and privileged access management",
                    "fork": false,
                    "url": "https://api.github.com/repos/hashicorp/vault",
                    "forks_url": "https://api.github.com/repos/hashicorp/vault/forks",
                    "keys_url": "https://api.github.com/repos/hashicorp/vault/keys{/key_id}",
                    "collaborators_url": "https://api.github.com/repos/hashicorp/vault/collaborators{/collaborator}",
                    "teams_url": "https://api.github.com/repos/hashicorp/vault/teams",
                    "hooks_url": "https://api.github.com/repos/hashicorp/vault/hooks",
                    "issue_events_url": "https://api.github.com/repos/hashicorp/vault/issues/events{/number}",
                    "events_url": "https://api.github.com/repos/hashicorp/vault/events",
                    "assignees_url": "https://api.github.com/repos/hashicorp/vault/assignees{/user}",
                    "branches_url": "https://api.github.com/repos/hashicorp/vault/branches{/branch}",
                    "tags_url": "https://api.github.com/repos/hashicorp/vault/tags",
                    "blobs_url": "https://api.github.com/repos/hashicorp/vault/git/blobs{/sha}",
                    "git_tags_url": "https://api.github.com/repos/hashicorp/vault/git/tags{/sha}",
                    "git_refs_url": "https://api.github.com/repos/hashicorp/vault/git/refs{/sha}",
                    "trees_url": "https://api.github.com/repos/hashicorp/vault/git/trees{/sha}",
                    "statuses_url": "https://api.github.com/repos/hashicorp/vault/statuses/{sha}",
                    "languages_url": "https://api.github.com/repos/hashicorp/vault/languages",
                    "stargazers_url": "https://api.github.com/repos/hashicorp/vault/stargazers",
                    "contributors_url": "https://api.github.com/repos/hashicorp/vault/contributors",
                    "subscribers_url": "https://api.github.com/repos/hashicorp/vault/subscribers",
                    "subscription_url": "https://api.github.com/repos/hashicorp/vault/subscription",
                    "commits_url": "https://api.github.com/repos/hashicorp/vault/commits{/sha}",
                    "git_commits_url": "https://api.github.com/repos/hashicorp/vault/git/commits{/sha}",
                    "comments_url": "https://api.github.com/repos/hashicorp/vault/comments{/number}",
                    "issue_comment_url": "https://api.github.com/repos/hashicorp/vault/issues/comments{/number}",
                    "contents_url": "https://api.github.com/repos/hashicorp/vault/contents/{+path}",
                    "compare_url": "https://api.github.com/repos/hashicorp/vault/compare/{base}...{head}",
                    "merges_url": "https://api.github.com/repos/hashicorp/vault/merges",
                    "archive_url": "https://api.github.com/repos/hashicorp/vault/{archive_format}{/ref}",
                    "downloads_url": "https://api.github.com/repos/hashicorp/vault/downloads",
                    "issues_url": "https://api.github.com/repos/hashicorp/vault/issues{/number}",
                    "pulls_url": "https://api.github.com/repos/hashicorp/vault/pulls{/number}",
                    "milestones_url": "https://api.github.com/repos/hashicorp/vault/milestones{/number}",
                    "notifications_url": "https://api.github.com/repos/hashicorp/vault/notifications{?since,all,participating}",
                    "labels_url": "https://api.github.com/repos/hashicorp/vault/labels{/name}",
                    "releases_url": "https://api.github.com/repos/hashicorp/vault/releases{/id}",
                    "deployments_url": "https://api.github.com/repos/hashicorp/vault/deployments",
                    "created_at": "2015-02-25T00:15:59Z",
                    "updated_at": "2020-07-17T20:30:27Z",
                    "pushed_at": "2020-07-17T20:57:34Z",
                    "git_url": "git://github.com/hashicorp/vault.git",
                    "ssh_url": "git@github.com:hashicorp/vault.git",
                    "clone_url": "https://github.com/hashicorp/vault.git",
                    "svn_url": "https://github.com/hashicorp/vault",
                    "homepage": "https://www.vaultproject.io/",
                    "size": 123698,
                    "stargazers_count": 16436,
                    "watchers_count": 16436,
                    "language": "Go",
                    "has_issues": true,
                    "has_projects": false,
                    "has_downloads": true,
                    "has_wiki": false,
                    "has_pages": false,
                    "forks_count": 2534,
                    "archived": false,
                    "disabled": false,
                    "open_issues_count": 708,
                    "license": {
                      "key": "mpl-2.0",
                      "name": "Mozilla Public License 2.0",
                      "spdx_id": "MPL-2.0",
                      "url": "https://api.github.com/licenses/mpl-2.0",
                      "node_id": "MDc6TGljZW5zZTE0"
                    },
                    "forks": 2534,
                    "open_issues": 708,
                    "watchers": 16436,
                    "default_branch": "master"
                  },
                  "pull_request": {
                    "url": "https://api.github.com/repos/hashicorp/vault/pulls/9416",
                    "html_url": "https://github.com/hashicorp/vault/pull/9416",
                    "diff_url": "https://github.com/hashicorp/vault/pull/9416.diff",
                    "patch_url": "https://github.com/hashicorp/vault/pull/9416.patch"
                  },
                  "body": "Fixes #9415"
                }
              }
            },
            {
              "created_at": 1594427098000,
              "event": "cross-referenced",
              "actor": "kalafut",
              "source": {
                "type": "issue",
                "issue": {
                  "url": "https://api.github.com/repos/hashicorp/vault/issues/8844",
                  "repository_url": "https://api.github.com/repos/hashicorp/vault",
                  "labels_url": "https://api.github.com/repos/hashicorp/vault/issues/8844/labels{/name}",
                  "comments_url": "https://api.github.com/repos/hashicorp/vault/issues/8844/comments",
                  "events_url": "https://api.github.com/repos/hashicorp/vault/issues/8844/events",
                  "html_url": "https://github.com/hashicorp/vault/issues/8844",
                  "id": 606592031,
                  "node_id": "MDU6SXNzdWU2MDY1OTIwMzE=",
                  "number": 8844,
                  "title": "Vault 1.4.0 won't start when a seal stanza is added in aws eks",
                  "user": {
                    "login": "corbesero",
                    "id": 3543081,
                    "node_id": "MDQ6VXNlcjM1NDMwODE=",
                    "avatar_url": "https://avatars0.githubusercontent.com/u/3543081?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/corbesero",
                    "html_url": "https://github.com/corbesero",
                    "followers_url": "https://api.github.com/users/corbesero/followers",
                    "following_url": "https://api.github.com/users/corbesero/following{/other_user}",
                    "gists_url": "https://api.github.com/users/corbesero/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/corbesero/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/corbesero/subscriptions",
                    "organizations_url": "https://api.github.com/users/corbesero/orgs",
                    "repos_url": "https://api.github.com/users/corbesero/repos",
                    "events_url": "https://api.github.com/users/corbesero/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/corbesero/received_events",
                    "type": "User",
                    "site_admin": false
                  },
                  "labels": [
                    {
                      "id": 1492658523,
                      "node_id": "MDU6TGFiZWwxNDkyNjU4NTIz",
                      "url": "https://api.github.com/repos/hashicorp/vault/labels/bug",
                      "name": "bug",
                      "color": "ef97a7",
                      "default": true,
                      "description": ""
                    },
                    {
                      "id": 1658778046,
                      "node_id": "MDU6TGFiZWwxNjU4Nzc4MDQ2",
                      "url": "https://api.github.com/repos/hashicorp/vault/labels/core/seal",
                      "name": "core/seal",
                      "color": "0000ff",
                      "default": false,
                      "description": ""
                    }
                  ],
                  "state": "open",
                  "locked": false,
                  "assignees": [],
                  "comments": 14,
                  "created_at": "2020-04-24T21:23:07Z",
                  "updated_at": "2020-07-16T22:18:21Z",
                  "author_association": "NONE",
                  "repository": {
                    "id": 31288958,
                    "node_id": "MDEwOlJlcG9zaXRvcnkzMTI4ODk1OA==",
                    "name": "vault",
                    "full_name": "hashicorp/vault",
                    "private": false,
                    "owner": {
                      "login": "hashicorp",
                      "id": 761456,
                      "node_id": "MDEyOk9yZ2FuaXphdGlvbjc2MTQ1Ng==",
                      "avatar_url": "https://avatars2.githubusercontent.com/u/761456?v=4",
                      "gravatar_id": "",
                      "url": "https://api.github.com/users/hashicorp",
                      "html_url": "https://github.com/hashicorp",
                      "followers_url": "https://api.github.com/users/hashicorp/followers",
                      "following_url": "https://api.github.com/users/hashicorp/following{/other_user}",
                      "gists_url": "https://api.github.com/users/hashicorp/gists{/gist_id}",
                      "starred_url": "https://api.github.com/users/hashicorp/starred{/owner}{/repo}",
                      "subscriptions_url": "https://api.github.com/users/hashicorp/subscriptions",
                      "organizations_url": "https://api.github.com/users/hashicorp/orgs",
                      "repos_url": "https://api.github.com/users/hashicorp/repos",
                      "events_url": "https://api.github.com/users/hashicorp/events{/privacy}",
                      "received_events_url": "https://api.github.com/users/hashicorp/received_events",
                      "type": "Organization",
                      "site_admin": false
                    },
                    "html_url": "https://github.com/hashicorp/vault",
                    "description": "A tool for secrets management, encryption as a service, and privileged access management",
                    "fork": false,
                    "url": "https://api.github.com/repos/hashicorp/vault",
                    "forks_url": "https://api.github.com/repos/hashicorp/vault/forks",
                    "keys_url": "https://api.github.com/repos/hashicorp/vault/keys{/key_id}",
                    "collaborators_url": "https://api.github.com/repos/hashicorp/vault/collaborators{/collaborator}",
                    "teams_url": "https://api.github.com/repos/hashicorp/vault/teams",
                    "hooks_url": "https://api.github.com/repos/hashicorp/vault/hooks",
                    "issue_events_url": "https://api.github.com/repos/hashicorp/vault/issues/events{/number}",
                    "events_url": "https://api.github.com/repos/hashicorp/vault/events",
                    "assignees_url": "https://api.github.com/repos/hashicorp/vault/assignees{/user}",
                    "branches_url": "https://api.github.com/repos/hashicorp/vault/branches{/branch}",
                    "tags_url": "https://api.github.com/repos/hashicorp/vault/tags",
                    "blobs_url": "https://api.github.com/repos/hashicorp/vault/git/blobs{/sha}",
                    "git_tags_url": "https://api.github.com/repos/hashicorp/vault/git/tags{/sha}",
                    "git_refs_url": "https://api.github.com/repos/hashicorp/vault/git/refs{/sha}",
                    "trees_url": "https://api.github.com/repos/hashicorp/vault/git/trees{/sha}",
                    "statuses_url": "https://api.github.com/repos/hashicorp/vault/statuses/{sha}",
                    "languages_url": "https://api.github.com/repos/hashicorp/vault/languages",
                    "stargazers_url": "https://api.github.com/repos/hashicorp/vault/stargazers",
                    "contributors_url": "https://api.github.com/repos/hashicorp/vault/contributors",
                    "subscribers_url": "https://api.github.com/repos/hashicorp/vault/subscribers",
                    "subscription_url": "https://api.github.com/repos/hashicorp/vault/subscription",
                    "commits_url": "https://api.github.com/repos/hashicorp/vault/commits{/sha}",
                    "git_commits_url": "https://api.github.com/repos/hashicorp/vault/git/commits{/sha}",
                    "comments_url": "https://api.github.com/repos/hashicorp/vault/comments{/number}",
                    "issue_comment_url": "https://api.github.com/repos/hashicorp/vault/issues/comments{/number}",
                    "contents_url": "https://api.github.com/repos/hashicorp/vault/contents/{+path}",
                    "compare_url": "https://api.github.com/repos/hashicorp/vault/compare/{base}...{head}",
                    "merges_url": "https://api.github.com/repos/hashicorp/vault/merges",
                    "archive_url": "https://api.github.com/repos/hashicorp/vault/{archive_format}{/ref}",
                    "downloads_url": "https://api.github.com/repos/hashicorp/vault/downloads",
                    "issues_url": "https://api.github.com/repos/hashicorp/vault/issues{/number}",
                    "pulls_url": "https://api.github.com/repos/hashicorp/vault/pulls{/number}",
                    "milestones_url": "https://api.github.com/repos/hashicorp/vault/milestones{/number}",
                    "notifications_url": "https://api.github.com/repos/hashicorp/vault/notifications{?since,all,participating}",
                    "labels_url": "https://api.github.com/repos/hashicorp/vault/labels{/name}",
                    "releases_url": "https://api.github.com/repos/hashicorp/vault/releases{/id}",
                    "deployments_url": "https://api.github.com/repos/hashicorp/vault/deployments",
                    "created_at": "2015-02-25T00:15:59Z",
                    "updated_at": "2020-07-17T20:30:27Z",
                    "pushed_at": "2020-07-17T20:57:34Z",
                    "git_url": "git://github.com/hashicorp/vault.git",
                    "ssh_url": "git@github.com:hashicorp/vault.git",
                    "clone_url": "https://github.com/hashicorp/vault.git",
                    "svn_url": "https://github.com/hashicorp/vault",
                    "homepage": "https://www.vaultproject.io/",
                    "size": 123698,
                    "stargazers_count": 16436,
                    "watchers_count": 16436,
                    "language": "Go",
                    "has_issues": true,
                    "has_projects": false,
                    "has_downloads": true,
                    "has_wiki": false,
                    "has_pages": false,
                    "forks_count": 2534,
                    "archived": false,
                    "disabled": false,
                    "open_issues_count": 708,
                    "license": {
                      "key": "mpl-2.0",
                      "name": "Mozilla Public License 2.0",
                      "spdx_id": "MPL-2.0",
                      "url": "https://api.github.com/licenses/mpl-2.0",
                      "node_id": "MDc6TGljZW5zZTE0"
                    },
                    "forks": 2534,
                    "open_issues": 708,
                    "watchers": 16436,
                    "default_branch": "master"
                  },
                  "body": "**Describe the bug**\r\n\r\nWhen I add a seal stanza (awskms) to a vault configuration via the vault-helm chart (0.5.0), the vault does not become available in the containers.  \r\n\r\n**To Reproduce**\r\n1. I do a helm install without the seal stanza.  Vaults (one active and one standby) will come up and I can unseal manually.  \r\n2. Add the seal stanza to access an existing kms key\r\n3. Do a helm update\r\n4. Delete the pods so they get recreated with the new configuration.\r\n\r\n**Expected behavior**\r\n\r\nThe vaults should come up so that I can do the unseal migrate.\r\n\r\n**Environment:**\r\nVault 1.4.0\r\nAWS EKS 1.15\r\nvault-helm chart at tag 0.5.0\r\n\r\nVault server configuration file(s):\r\n\r\n```hcl\r\ndisable_mlock = true\r\nui = true\r\nlog_level = \"trace\"\r\nlistener \"tcp\" {\r\n  tls_disable = 1\r\n  address = \"[::]:8200\"\r\n  cluster_address = \"[::]:8201\"\r\n}\r\nstorage \"raft\" {\r\n  path = \"/vault/data\"\r\n  retry_join {\r\n    leader_api_addr = \"http://vault-0.vault-internal:8200\"\r\n  }\r\n  retry_join {\r\n    leader_api_addr = \"http://vault-1.vault-internal:8200\"\r\n  }\r\n}\r\nseal \"awskms\" {\r\n region     = \"us-east-1\"\r\n kms_key_id = \"7899be0b-3be8-4dd7-a5b5-32b85c02c406\"\r\n}\r\n\r\n```\r\nAlso, see attached values file for helm\r\n\r\n**Additional context**\r\n\r\nNo log output is produced.\r\n\r\nThis is the output of a ps on the container\r\n```\r\n/ $ ps awx | grep vault\r\n    1 vault     0:00 /bin/sh -ec sed -E \"s/HOST_IP/${HOST_IP?}/g\" /vault/config/extraconfig-from-values.hcl > /tmp/storageconfig.hcl; sed -Ei \"s/POD_IP/${POD_IP?}/g\" /tmp/storageconfig.hcl; /usr/local/bin/docker-entrypoint.sh vault server -config=/tmp/storageconfig.hcl  \r\n    8 vault     0:00 {docker-entrypoi} /usr/bin/dumb-init /bin/sh /usr/local/bin/docker-entrypoint.sh vault server -config=/tmp/storageconfig.hcl\r\n    9 vault     0:00 vault server -config=/tmp/storageconfig.hcl\r\n  208 vault     0:00 /bin/sh\r\n  254 vault     0:00 ps awx\r\n  255 vault     0:00 grep vault\r\n```\r\nI have attached the output of `kubectl describe pods -n vault` for the vault-0 and vault-1 pods.  The vault-0 is when the pod is still there, but the vault-1 sows the output after a while when the container completely fails.\r\n\r\nIf I comment out the seal stanza, I can do a helm upgrade, delete the pods, and the new ones come up and can be unsealed.\r\n\r\n\r\n[kubectl-describe-pod-vault-0.txt](https://github.com/hashicorp/vault/files/4531583/kubectl-describe-pod-vault-0.txt)\r\n[kubectl-describe-pod-vault-1.txt](https://github.com/hashicorp/vault/files/4531584/kubectl-describe-pod-vault-1.txt)\r\n[values.yaml.txt](https://github.com/hashicorp/vault/files/4531585/values.yaml.txt)\r\n\r\n\r\n"
                }
              }
            },
            {
              "id": 3542676022,
              "created_at": 1594708310000,
              "event": "closed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3542676022",
              "actor": "tvoran"
            },
            {
              "id": 3542676128,
              "created_at": 1594708312000,
              "commit_id": "95e05e5642593f75e67d8025ba48c9e7dde15244",
              "event": "referenced",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3542676128",
              "actor": "tvoran"
            },
            {
              "id": 3542694633,
              "created_at": 1594708726000,
              "commit_id": "52fa14ba352b5af40916bf5a80072cde2bfbb9b3",
              "event": "referenced",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3542694633",
              "actor": "tvoran"
            },
            {
              "id": 3542703615,
              "created_at": 1594708925000,
              "commit_id": "1d56fe3da4a29afbd26cca025182b3484617f37a",
              "event": "referenced",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3542703615",
              "actor": "tvoran"
            },
            {
              "created_at": 1594709009000,
              "event": "cross-referenced",
              "actor": "tvoran",
              "source": {
                "type": "issue",
                "issue": {
                  "url": "https://api.github.com/repos/hashicorp/vault/issues/9476",
                  "repository_url": "https://api.github.com/repos/hashicorp/vault",
                  "labels_url": "https://api.github.com/repos/hashicorp/vault/issues/9476/labels{/name}",
                  "comments_url": "https://api.github.com/repos/hashicorp/vault/issues/9476/comments",
                  "events_url": "https://api.github.com/repos/hashicorp/vault/issues/9476/events",
                  "html_url": "https://github.com/hashicorp/vault/pull/9476",
                  "id": 656370393,
                  "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ4NjgxNTI5",
                  "number": 9476,
                  "title": "Backporting #9416 to 1.4.4",
                  "user": {
                    "login": "tvoran",
                    "id": 444265,
                    "node_id": "MDQ6VXNlcjQ0NDI2NQ==",
                    "avatar_url": "https://avatars3.githubusercontent.com/u/444265?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/tvoran",
                    "html_url": "https://github.com/tvoran",
                    "followers_url": "https://api.github.com/users/tvoran/followers",
                    "following_url": "https://api.github.com/users/tvoran/following{/other_user}",
                    "gists_url": "https://api.github.com/users/tvoran/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/tvoran/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/tvoran/subscriptions",
                    "organizations_url": "https://api.github.com/users/tvoran/orgs",
                    "repos_url": "https://api.github.com/users/tvoran/repos",
                    "events_url": "https://api.github.com/users/tvoran/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/tvoran/received_events",
                    "type": "User",
                    "site_admin": false
                  },
                  "labels": [],
                  "state": "closed",
                  "locked": false,
                  "assignees": [],
                  "milestone": {
                    "url": "https://api.github.com/repos/hashicorp/vault/milestones/74",
                    "html_url": "https://github.com/hashicorp/vault/milestone/74",
                    "labels_url": "https://api.github.com/repos/hashicorp/vault/milestones/74/labels",
                    "id": 5579414,
                    "node_id": "MDk6TWlsZXN0b25lNTU3OTQxNA==",
                    "number": 74,
                    "title": "1.4.4",
                    "creator": {
                      "login": "mladlow",
                      "id": 9422872,
                      "node_id": "MDQ6VXNlcjk0MjI4NzI=",
                      "avatar_url": "https://avatars0.githubusercontent.com/u/9422872?v=4",
                      "gravatar_id": "",
                      "url": "https://api.github.com/users/mladlow",
                      "html_url": "https://github.com/mladlow",
                      "followers_url": "https://api.github.com/users/mladlow/followers",
                      "following_url": "https://api.github.com/users/mladlow/following{/other_user}",
                      "gists_url": "https://api.github.com/users/mladlow/gists{/gist_id}",
                      "starred_url": "https://api.github.com/users/mladlow/starred{/owner}{/repo}",
                      "subscriptions_url": "https://api.github.com/users/mladlow/subscriptions",
                      "organizations_url": "https://api.github.com/users/mladlow/orgs",
                      "repos_url": "https://api.github.com/users/mladlow/repos",
                      "events_url": "https://api.github.com/users/mladlow/events{/privacy}",
                      "received_events_url": "https://api.github.com/users/mladlow/received_events",
                      "type": "User",
                      "site_admin": false
                    },
                    "open_issues": 1,
                    "closed_issues": 5,
                    "state": "open",
                    "created_at": "2020-06-24T18:40:17Z",
                    "updated_at": "2020-07-17T20:26:09Z"
                  },
                  "comments": 0,
                  "created_at": "2020-07-14T06:43:29Z",
                  "updated_at": "2020-07-14T16:01:29Z",
                  "closed_at": "2020-07-14T16:01:25Z",
                  "author_association": "MEMBER",
                  "repository": {
                    "id": 31288958,
                    "node_id": "MDEwOlJlcG9zaXRvcnkzMTI4ODk1OA==",
                    "name": "vault",
                    "full_name": "hashicorp/vault",
                    "private": false,
                    "owner": {
                      "login": "hashicorp",
                      "id": 761456,
                      "node_id": "MDEyOk9yZ2FuaXphdGlvbjc2MTQ1Ng==",
                      "avatar_url": "https://avatars2.githubusercontent.com/u/761456?v=4",
                      "gravatar_id": "",
                      "url": "https://api.github.com/users/hashicorp",
                      "html_url": "https://github.com/hashicorp",
                      "followers_url": "https://api.github.com/users/hashicorp/followers",
                      "following_url": "https://api.github.com/users/hashicorp/following{/other_user}",
                      "gists_url": "https://api.github.com/users/hashicorp/gists{/gist_id}",
                      "starred_url": "https://api.github.com/users/hashicorp/starred{/owner}{/repo}",
                      "subscriptions_url": "https://api.github.com/users/hashicorp/subscriptions",
                      "organizations_url": "https://api.github.com/users/hashicorp/orgs",
                      "repos_url": "https://api.github.com/users/hashicorp/repos",
                      "events_url": "https://api.github.com/users/hashicorp/events{/privacy}",
                      "received_events_url": "https://api.github.com/users/hashicorp/received_events",
                      "type": "Organization",
                      "site_admin": false
                    },
                    "html_url": "https://github.com/hashicorp/vault",
                    "description": "A tool for secrets management, encryption as a service, and privileged access management",
                    "fork": false,
                    "url": "https://api.github.com/repos/hashicorp/vault",
                    "forks_url": "https://api.github.com/repos/hashicorp/vault/forks",
                    "keys_url": "https://api.github.com/repos/hashicorp/vault/keys{/key_id}",
                    "collaborators_url": "https://api.github.com/repos/hashicorp/vault/collaborators{/collaborator}",
                    "teams_url": "https://api.github.com/repos/hashicorp/vault/teams",
                    "hooks_url": "https://api.github.com/repos/hashicorp/vault/hooks",
                    "issue_events_url": "https://api.github.com/repos/hashicorp/vault/issues/events{/number}",
                    "events_url": "https://api.github.com/repos/hashicorp/vault/events",
                    "assignees_url": "https://api.github.com/repos/hashicorp/vault/assignees{/user}",
                    "branches_url": "https://api.github.com/repos/hashicorp/vault/branches{/branch}",
                    "tags_url": "https://api.github.com/repos/hashicorp/vault/tags",
                    "blobs_url": "https://api.github.com/repos/hashicorp/vault/git/blobs{/sha}",
                    "git_tags_url": "https://api.github.com/repos/hashicorp/vault/git/tags{/sha}",
                    "git_refs_url": "https://api.github.com/repos/hashicorp/vault/git/refs{/sha}",
                    "trees_url": "https://api.github.com/repos/hashicorp/vault/git/trees{/sha}",
                    "statuses_url": "https://api.github.com/repos/hashicorp/vault/statuses/{sha}",
                    "languages_url": "https://api.github.com/repos/hashicorp/vault/languages",
                    "stargazers_url": "https://api.github.com/repos/hashicorp/vault/stargazers",
                    "contributors_url": "https://api.github.com/repos/hashicorp/vault/contributors",
                    "subscribers_url": "https://api.github.com/repos/hashicorp/vault/subscribers",
                    "subscription_url": "https://api.github.com/repos/hashicorp/vault/subscription",
                    "commits_url": "https://api.github.com/repos/hashicorp/vault/commits{/sha}",
                    "git_commits_url": "https://api.github.com/repos/hashicorp/vault/git/commits{/sha}",
                    "comments_url": "https://api.github.com/repos/hashicorp/vault/comments{/number}",
                    "issue_comment_url": "https://api.github.com/repos/hashicorp/vault/issues/comments{/number}",
                    "contents_url": "https://api.github.com/repos/hashicorp/vault/contents/{+path}",
                    "compare_url": "https://api.github.com/repos/hashicorp/vault/compare/{base}...{head}",
                    "merges_url": "https://api.github.com/repos/hashicorp/vault/merges",
                    "archive_url": "https://api.github.com/repos/hashicorp/vault/{archive_format}{/ref}",
                    "downloads_url": "https://api.github.com/repos/hashicorp/vault/downloads",
                    "issues_url": "https://api.github.com/repos/hashicorp/vault/issues{/number}",
                    "pulls_url": "https://api.github.com/repos/hashicorp/vault/pulls{/number}",
                    "milestones_url": "https://api.github.com/repos/hashicorp/vault/milestones{/number}",
                    "notifications_url": "https://api.github.com/repos/hashicorp/vault/notifications{?since,all,participating}",
                    "labels_url": "https://api.github.com/repos/hashicorp/vault/labels{/name}",
                    "releases_url": "https://api.github.com/repos/hashicorp/vault/releases{/id}",
                    "deployments_url": "https://api.github.com/repos/hashicorp/vault/deployments",
                    "created_at": "2015-02-25T00:15:59Z",
                    "updated_at": "2020-07-17T20:30:27Z",
                    "pushed_at": "2020-07-17T20:57:34Z",
                    "git_url": "git://github.com/hashicorp/vault.git",
                    "ssh_url": "git@github.com:hashicorp/vault.git",
                    "clone_url": "https://github.com/hashicorp/vault.git",
                    "svn_url": "https://github.com/hashicorp/vault",
                    "homepage": "https://www.vaultproject.io/",
                    "size": 123698,
                    "stargazers_count": 16436,
                    "watchers_count": 16436,
                    "language": "Go",
                    "has_issues": true,
                    "has_projects": false,
                    "has_downloads": true,
                    "has_wiki": false,
                    "has_pages": false,
                    "forks_count": 2534,
                    "archived": false,
                    "disabled": false,
                    "open_issues_count": 708,
                    "license": {
                      "key": "mpl-2.0",
                      "name": "Mozilla Public License 2.0",
                      "spdx_id": "MPL-2.0",
                      "url": "https://api.github.com/licenses/mpl-2.0",
                      "node_id": "MDc6TGljZW5zZTE0"
                    },
                    "forks": 2534,
                    "open_issues": 708,
                    "watchers": 16436,
                    "default_branch": "master"
                  },
                  "pull_request": {
                    "url": "https://api.github.com/repos/hashicorp/vault/pulls/9476",
                    "html_url": "https://github.com/hashicorp/vault/pull/9476",
                    "diff_url": "https://github.com/hashicorp/vault/pull/9476.diff",
                    "patch_url": "https://github.com/hashicorp/vault/pull/9476.patch"
                  },
                  "body": "Don't require AWS_ROLE_SESSION_NAME to sts:AssumeRoleWithWebIdentity (#9416)\r\n\r\nFixes #9415\r\n\r\nCo-authored-by: Theron Voran <tvoran@users.noreply.github.com>"
                }
              }
            },
            {
              "id": 3544840637,
              "created_at": 1594742430000,
              "commit_id": "352d9fb89faafdf86cf3168be57b54a5b508657d",
              "event": "referenced",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3544840637",
              "actor": "tvoran"
            },
            {
              "id": 3544844535,
              "created_at": 1594742486000,
              "commit_id": "39f1a3e70407863e6ed37738cf8f89a41440c5f2",
              "event": "referenced",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3544844535",
              "actor": "tvoran"
            },
            {
              "created_at": 1594744230000,
              "event": "cross-referenced",
              "actor": "orirawlings",
              "source": {
                "type": "issue",
                "issue": {
                  "url": "https://api.github.com/repos/hashicorp/vault/issues/8926",
                  "repository_url": "https://api.github.com/repos/hashicorp/vault",
                  "labels_url": "https://api.github.com/repos/hashicorp/vault/issues/8926/labels{/name}",
                  "comments_url": "https://api.github.com/repos/hashicorp/vault/issues/8926/comments",
                  "events_url": "https://api.github.com/repos/hashicorp/vault/issues/8926/events",
                  "html_url": "https://github.com/hashicorp/vault/issues/8926",
                  "id": 612450407,
                  "node_id": "MDU6SXNzdWU2MTI0NTA0MDc=",
                  "number": 8926,
                  "title": "IAM roles for AWS EKS service accounts not working",
                  "user": {
                    "login": "serhatcetinkaya",
                    "id": 10282948,
                    "node_id": "MDQ6VXNlcjEwMjgyOTQ4",
                    "avatar_url": "https://avatars3.githubusercontent.com/u/10282948?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/serhatcetinkaya",
                    "html_url": "https://github.com/serhatcetinkaya",
                    "followers_url": "https://api.github.com/users/serhatcetinkaya/followers",
                    "following_url": "https://api.github.com/users/serhatcetinkaya/following{/other_user}",
                    "gists_url": "https://api.github.com/users/serhatcetinkaya/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/serhatcetinkaya/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/serhatcetinkaya/subscriptions",
                    "organizations_url": "https://api.github.com/users/serhatcetinkaya/orgs",
                    "repos_url": "https://api.github.com/users/serhatcetinkaya/repos",
                    "events_url": "https://api.github.com/users/serhatcetinkaya/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/serhatcetinkaya/received_events",
                    "type": "User",
                    "site_admin": false
                  },
                  "labels": [
                    {
                      "id": 1492658523,
                      "node_id": "MDU6TGFiZWwxNDkyNjU4NTIz",
                      "url": "https://api.github.com/repos/hashicorp/vault/labels/bug",
                      "name": "bug",
                      "color": "ef97a7",
                      "default": true,
                      "description": ""
                    },
                    {
                      "id": 1658638636,
                      "node_id": "MDU6TGFiZWwxNjU4NjM4NjM2",
                      "url": "https://api.github.com/repos/hashicorp/vault/labels/core/storage",
                      "name": "core/storage",
                      "color": "0000ff",
                      "default": false,
                      "description": ""
                    }
                  ],
                  "state": "open",
                  "locked": false,
                  "assignees": [],
                  "milestone": {
                    "url": "https://api.github.com/repos/hashicorp/vault/milestones/66",
                    "html_url": "https://github.com/hashicorp/vault/milestone/66",
                    "labels_url": "https://api.github.com/repos/hashicorp/vault/milestones/66/labels",
                    "id": 5107962,
                    "node_id": "MDk6TWlsZXN0b25lNTEwNzk2Mg==",
                    "number": 66,
                    "title": "triaged",
                    "description": "This milestone is used to help the Vault team in its release planning. When something is triaged, it is in a queue for review.",
                    "creator": {
                      "login": "pbernal",
                      "id": 842686,
                      "node_id": "MDQ6VXNlcjg0MjY4Ng==",
                      "avatar_url": "https://avatars1.githubusercontent.com/u/842686?v=4",
                      "gravatar_id": "",
                      "url": "https://api.github.com/users/pbernal",
                      "html_url": "https://github.com/pbernal",
                      "followers_url": "https://api.github.com/users/pbernal/followers",
                      "following_url": "https://api.github.com/users/pbernal/following{/other_user}",
                      "gists_url": "https://api.github.com/users/pbernal/gists{/gist_id}",
                      "starred_url": "https://api.github.com/users/pbernal/starred{/owner}{/repo}",
                      "subscriptions_url": "https://api.github.com/users/pbernal/subscriptions",
                      "organizations_url": "https://api.github.com/users/pbernal/orgs",
                      "repos_url": "https://api.github.com/users/pbernal/repos",
                      "events_url": "https://api.github.com/users/pbernal/events{/privacy}",
                      "received_events_url": "https://api.github.com/users/pbernal/received_events",
                      "type": "User",
                      "site_admin": false
                    },
                    "open_issues": 78,
                    "closed_issues": 0,
                    "state": "open",
                    "created_at": "2020-02-15T02:32:13Z",
                    "updated_at": "2020-07-16T18:15:06Z"
                  },
                  "comments": 8,
                  "created_at": "2020-05-05T09:03:15Z",
                  "updated_at": "2020-07-16T22:13:09Z",
                  "author_association": "NONE",
                  "repository": {
                    "id": 31288958,
                    "node_id": "MDEwOlJlcG9zaXRvcnkzMTI4ODk1OA==",
                    "name": "vault",
                    "full_name": "hashicorp/vault",
                    "private": false,
                    "owner": {
                      "login": "hashicorp",
                      "id": 761456,
                      "node_id": "MDEyOk9yZ2FuaXphdGlvbjc2MTQ1Ng==",
                      "avatar_url": "https://avatars2.githubusercontent.com/u/761456?v=4",
                      "gravatar_id": "",
                      "url": "https://api.github.com/users/hashicorp",
                      "html_url": "https://github.com/hashicorp",
                      "followers_url": "https://api.github.com/users/hashicorp/followers",
                      "following_url": "https://api.github.com/users/hashicorp/following{/other_user}",
                      "gists_url": "https://api.github.com/users/hashicorp/gists{/gist_id}",
                      "starred_url": "https://api.github.com/users/hashicorp/starred{/owner}{/repo}",
                      "subscriptions_url": "https://api.github.com/users/hashicorp/subscriptions",
                      "organizations_url": "https://api.github.com/users/hashicorp/orgs",
                      "repos_url": "https://api.github.com/users/hashicorp/repos",
                      "events_url": "https://api.github.com/users/hashicorp/events{/privacy}",
                      "received_events_url": "https://api.github.com/users/hashicorp/received_events",
                      "type": "Organization",
                      "site_admin": false
                    },
                    "html_url": "https://github.com/hashicorp/vault",
                    "description": "A tool for secrets management, encryption as a service, and privileged access management",
                    "fork": false,
                    "url": "https://api.github.com/repos/hashicorp/vault",
                    "forks_url": "https://api.github.com/repos/hashicorp/vault/forks",
                    "keys_url": "https://api.github.com/repos/hashicorp/vault/keys{/key_id}",
                    "collaborators_url": "https://api.github.com/repos/hashicorp/vault/collaborators{/collaborator}",
                    "teams_url": "https://api.github.com/repos/hashicorp/vault/teams",
                    "hooks_url": "https://api.github.com/repos/hashicorp/vault/hooks",
                    "issue_events_url": "https://api.github.com/repos/hashicorp/vault/issues/events{/number}",
                    "events_url": "https://api.github.com/repos/hashicorp/vault/events",
                    "assignees_url": "https://api.github.com/repos/hashicorp/vault/assignees{/user}",
                    "branches_url": "https://api.github.com/repos/hashicorp/vault/branches{/branch}",
                    "tags_url": "https://api.github.com/repos/hashicorp/vault/tags",
                    "blobs_url": "https://api.github.com/repos/hashicorp/vault/git/blobs{/sha}",
                    "git_tags_url": "https://api.github.com/repos/hashicorp/vault/git/tags{/sha}",
                    "git_refs_url": "https://api.github.com/repos/hashicorp/vault/git/refs{/sha}",
                    "trees_url": "https://api.github.com/repos/hashicorp/vault/git/trees{/sha}",
                    "statuses_url": "https://api.github.com/repos/hashicorp/vault/statuses/{sha}",
                    "languages_url": "https://api.github.com/repos/hashicorp/vault/languages",
                    "stargazers_url": "https://api.github.com/repos/hashicorp/vault/stargazers",
                    "contributors_url": "https://api.github.com/repos/hashicorp/vault/contributors",
                    "subscribers_url": "https://api.github.com/repos/hashicorp/vault/subscribers",
                    "subscription_url": "https://api.github.com/repos/hashicorp/vault/subscription",
                    "commits_url": "https://api.github.com/repos/hashicorp/vault/commits{/sha}",
                    "git_commits_url": "https://api.github.com/repos/hashicorp/vault/git/commits{/sha}",
                    "comments_url": "https://api.github.com/repos/hashicorp/vault/comments{/number}",
                    "issue_comment_url": "https://api.github.com/repos/hashicorp/vault/issues/comments{/number}",
                    "contents_url": "https://api.github.com/repos/hashicorp/vault/contents/{+path}",
                    "compare_url": "https://api.github.com/repos/hashicorp/vault/compare/{base}...{head}",
                    "merges_url": "https://api.github.com/repos/hashicorp/vault/merges",
                    "archive_url": "https://api.github.com/repos/hashicorp/vault/{archive_format}{/ref}",
                    "downloads_url": "https://api.github.com/repos/hashicorp/vault/downloads",
                    "issues_url": "https://api.github.com/repos/hashicorp/vault/issues{/number}",
                    "pulls_url": "https://api.github.com/repos/hashicorp/vault/pulls{/number}",
                    "milestones_url": "https://api.github.com/repos/hashicorp/vault/milestones{/number}",
                    "notifications_url": "https://api.github.com/repos/hashicorp/vault/notifications{?since,all,participating}",
                    "labels_url": "https://api.github.com/repos/hashicorp/vault/labels{/name}",
                    "releases_url": "https://api.github.com/repos/hashicorp/vault/releases{/id}",
                    "deployments_url": "https://api.github.com/repos/hashicorp/vault/deployments",
                    "created_at": "2015-02-25T00:15:59Z",
                    "updated_at": "2020-07-17T20:30:27Z",
                    "pushed_at": "2020-07-17T20:57:34Z",
                    "git_url": "git://github.com/hashicorp/vault.git",
                    "ssh_url": "git@github.com:hashicorp/vault.git",
                    "clone_url": "https://github.com/hashicorp/vault.git",
                    "svn_url": "https://github.com/hashicorp/vault",
                    "homepage": "https://www.vaultproject.io/",
                    "size": 123698,
                    "stargazers_count": 16436,
                    "watchers_count": 16436,
                    "language": "Go",
                    "has_issues": true,
                    "has_projects": false,
                    "has_downloads": true,
                    "has_wiki": false,
                    "has_pages": false,
                    "forks_count": 2534,
                    "archived": false,
                    "disabled": false,
                    "open_issues_count": 708,
                    "license": {
                      "key": "mpl-2.0",
                      "name": "Mozilla Public License 2.0",
                      "spdx_id": "MPL-2.0",
                      "url": "https://api.github.com/licenses/mpl-2.0",
                      "node_id": "MDc6TGljZW5zZTE0"
                    },
                    "forks": 2534,
                    "open_issues": 708,
                    "watchers": 16436,
                    "default_branch": "master"
                  },
                  "body": "**Describe the bug**\r\nIAM roles for AWS EKS service accounts still don't work with Vault. I was expecting the issue to be resolved after #7450 and #7738 . I suspect the problem is [custom credential chain implementation in Vault](https://github.com/hashicorp/vault/blob/master/sdk/helper/awsutil/generate_credentials.go). \r\n\r\nIn EKS we have dummy IAM roles with almost no permission attached on worker nodes, instead we give permissions directly to pod (either with native IAM to service account solution or with third party tools like kube2iam etc). Expecting latest Vault would work with IAM to service account solution after seeing changelog, we upgraded to 1.4.1 and saw that instead of using service account IAM role it tries to use worker node IAM role, authenticates successfully but fails due to lack of privileges.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Attach dummy IAM roles on worker nodes \r\n2. Create a service account for Vault and attach an IAM role for it with proper permissions (https://docs.aws.amazon.com/eks/latest/userguide/iam-roles-for-service-accounts.html)\r\n3. Make the vault container run with service account\r\n4. In the logs see it tries to use worker instance role and fails\r\n\r\nTo easily reproduce use dynamodb backend and don't give any dynamodb permissions to worker node IAM role but give required permissions to IAM  role that is attached to service account, it will fail immediately with following error:\r\n```\r\nvault Error initializing storage of type dynamodb: AccessDeniedException: User: arn:aws:sts::****:assumed-role/****005/***005 is not authorized to perform: dynamodb:DescribeTable on resource: arn:aws:dynamodb:us-east-1:***:table/****\r\n vault     status code: 400, request id: AVE****AJG\r\n vault stream closed\r\n```\r\n\r\n**Expected behavior**\r\nI expect it to work like official SDK. With the same setup and different container when I do a call to AWS API the container uses IAM role from the service account.\r\n\r\n**Environment:**\r\nI used the official `vault:1.4.1` container.\r\n* `vault status` output:\r\n```\r\nvault status\r\nKey                      Value\r\n---                      -----\r\nRecovery Seal Type       shamir\r\nInitialized              true\r\nSealed                   false\r\nTotal Recovery Shares    5\r\nThreshold                3\r\nVersion                  1.4.1\r\nCluster Name             vault-cluster-6f587bab\r\nCluster ID               3d********ee\r\nHA Enabled               true\r\nHA Cluster               https://****:8201\r\nHA Mode                  active\r\n```\r\n* Vault CLI Version (retrieve with `vault version`): `Vault v1.4.1`\r\n* Server Operating System/Architecture:\r\n```\r\nLinux vault-0 4.14.165-133.209.amzn2.x86_64 #1 SMP Sun Feb 9 00:21:30 UTC 2020 x86_64 Linux\r\n```\r\n* Necessary environment variables exist:\r\n```\r\nenv | grep -i aws\r\nAWS_ROLE_ARN=arn:aws:iam::****:role/kubernetes-dev-vault\r\nAWS_WEB_IDENTITY_TOKEN_FILE=/var/run/secrets/eks.amazonaws.com/serviceaccount/token\r\n```\r\n* Filepath from `AWS_WEB_IDENTITY_TOKEN_FILE` is readable by vault user:\r\n```\r\n/ $ whoami\r\nvault\r\n/ $ id vault\r\nuid=100(vault) gid=1000(vault) groups=1000(vault),1000(vault)\r\n/ $ cat /var/run/secrets/eks.amazonaws.com/serviceaccount/token\r\neyJhb******VkN2E\r\n```\r\n\r\nVault server configuration file(s):\r\n\r\n```hcl\r\ndisable_mlock = true\r\nui = true\r\nlistener \"tcp\" {\r\n  address = \"[::]:8200\"\r\n  cluster_address = \"[::]:8201\"\r\n  tls_cert_file = \"/vault/userconfig/vault-server-tls/tls.crt\"\r\n  tls_key_file = \"/vault/userconfig/vault-server-tls/tls.key\"\r\n}\r\nstorage \"dynamodb\" {\r\n  ha_enabled = \"true\"\r\n  region     = \"us-east-1\"\r\n  table      = \"****\"\r\n}\r\nseal \"awskms\" {\r\n  kms_key_id = \"0*****7\"\r\n}\r\ntelemetry {\r\n  prometheus_retention_time = \"30s\",\r\n  disable_hostname = true\r\n}\r\nmax_lease_ttl = \"87600h\"\r\n```\r\n\r\n**Additional context**\r\nIn one of the related isssues, someone mentioned changing security context solves the problem but for me it didn't. Below is the securityContext used:\r\n```\r\n  securityContext:\r\n    fsGroup: 1000\r\n    runAsGroup: 1000\r\n    runAsNonRoot: true\r\n    runAsUser: 100\r\n```\r\nI tried different combinations mentioned in related issues.\r\n"
                }
              }
            }
          ]
        },
        {
          "id": "652646510",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ1NjgyMTAw",
          "number": 9416,
          "html_url": "https://github.com/hashicorp/vault/pull/9416",
          "title": "Don't require AWS_ROLE_SESSION_NAME to sts:AssumeRoleWithWebIdentity",
          "user": {
            "type": "user",
            "login": "orirawlings"
          },
          "labels": [
            {
              "id": "965254381",
              "node_id": "MDU6TGFiZWw5NjUyNTQzODE=",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/backport",
              "name": "backport",
              "color": "ed8496",
              "description": "",
              "default": false
            }
          ],
          "state": "closed",
          "locked": false,
          "assignee": {
            "type": "user",
            "login": "tvoran"
          },
          "assignees": [
            {
              "type": "user",
              "login": "tvoran"
            }
          ],
          "comments": 2,
          "created_at": 1594156113000,
          "updated_at": 1594708311000,
          "closed_at": 1594708310000,
          "author_association": "CONTRIBUTOR",
          "body": "Fixes #9415",
          "milestone": {
            "id": "5107883",
            "number": 65,
            "title": "1.5"
          },
          "events": []
        },
        {
          "id": "607557172",
          "node_id": "MDU6SXNzdWU2MDc1NTcxNzI=",
          "number": 8858,
          "html_url": "https://github.com/hashicorp/vault/issues/8858",
          "title": "Secret Engine Metrics - Database telemetry is missing",
          "user": {
            "type": "user",
            "login": "iusergii"
          },
          "labels": [
            {
              "id": "2025579511",
              "node_id": "MDU6TGFiZWwyMDI1NTc5NTEx",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/core/telemetry",
              "name": "core/telemetry",
              "color": "7565ce",
              "description": "",
              "default": false
            },
            {
              "id": "1658585751",
              "node_id": "MDU6TGFiZWwxNjU4NTg1NzUx",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/secret/database",
              "name": "secret/database",
              "color": "59e560",
              "description": "",
              "default": false
            }
          ],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 1,
          "created_at": 1587994658000,
          "updated_at": 1594725203000,
          "author_association": "NONE",
          "body": "**Describe the bug**\r\nTelemetry for Database Secret Engine is absent. \r\n\r\n**To Reproduce**\r\n- Enable database secret. \r\n```bash\r\nvault secrets list | grep database\r\ndatabase/             database     database_512ee413     Databases\r\ntest-database/        database     database_44f4b2ef     n/a\r\n```\r\n- Grep database metrics\r\n```bash\r\ncurl -X Get -H \"X-Vault-Token:s.\"  https://vault.com/v1/sys/metrics | grep database\r\n```\r\n\r\n**Expected behavior**\r\nGet metrics mentioned in [secrets-engines-metrics](https://www.vaultproject.io/docs/internals/telemetry.html#secrets-engines-metrics) \r\n\r\n**Environment:**\r\n```bash\r\nvault status\r\nKey                      Value\r\n---                      -----\r\nRecovery Seal Type       shamir\r\nInitialized              true\r\nSealed                   false\r\nTotal Recovery Shares    5\r\nThreshold                3\r\nVersion                  1.2.4\r\n...\r\n```\r\n\r\nVault server configuration file(s):\r\n\r\n```hcl\r\ndisable_mlock = true\r\nui = true\r\n\r\nlistener \"tcp\" {\r\n  tls_disable = 1\r\n  address = \"[::]:8200\"\r\n  cluster_address = \"[::]:8201\"\r\n}\r\n\r\nstorage \"dynamodb\" {\r\n  ha_enabled = 1\r\n  table = \"vault-dev\"\r\n}\r\n\r\nlog_level = \"Info\"\r\nlog_format = \"standard\"\r\n\r\ntelemetry {\r\n  prometheus_retention_time = \"30s\",\r\n  disable_hostname = true\r\n}\r\n```\r\n\r\n**Additional context**\r\n```bash\r\ncurl -X Get -H \"X-Vault-Token:s.\"  https://vault.com/v1/sys/mounts | jq  '.[\"database/\"]'\r\n{\r\n  \"accessor\": \"database_512ee413\",\r\n  \"config\": {\r\n    \"audit_non_hmac_response_keys\": [\r\n      \"username\"\r\n    ],\r\n    \"default_lease_ttl\": 2678400,\r\n    \"force_no_cache\": false,\r\n    \"max_lease_ttl\": 31536000\r\n  },\r\n  \"description\": \"Databases\",\r\n  \"local\": false,\r\n  \"options\": null,\r\n  \"seal_wrap\": false,\r\n  \"type\": \"database\",\r\n  \"uuid\": \"b45ea8d9-34e7-93ce-634d-516a56a5ac66\"\r\n}\r\n```\r\n\r\n``` \r\n",
          "events": [
            {
              "id": 3286882438,
              "created_at": 1588202610000,
              "event": "labeled",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3286882438",
              "actor": "calvn",
              "label": "secret/database"
            },
            {
              "id": 3286883019,
              "created_at": 1588202625000,
              "event": "labeled",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3286883019",
              "actor": "calvn",
              "label": "core/telemetry"
            },
            {
              "id": 658121246,
              "created_at": 1594725203000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/658121246",
              "actor": "iusergii",
              "body": "Checked on v1.4.2 - don't see database metrics. \r\n@calvn Am I looking in wrong place? ",
              "user": "iusergii",
              "html_url": "https://github.com/hashicorp/vault/issues/8858#issuecomment-658121246"
            },
            {
              "id": 3543688940,
              "created_at": 1594725203000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3543688940",
              "actor": "calvn"
            },
            {
              "id": 3543688941,
              "created_at": 1594725203000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3543688941",
              "actor": "calvn"
            }
          ]
        },
        {
          "id": "656560216",
          "node_id": "MDU6SXNzdWU2NTY1NjAyMTY=",
          "number": 9477,
          "html_url": "https://github.com/hashicorp/vault/issues/9477",
          "title": "Vault ldap auth: unable to retrieve user bind DN",
          "user": {
            "type": "user",
            "login": "Jeka-Dem"
          },
          "labels": [],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594728237000,
          "updated_at": 1594728984000,
          "author_association": "NONE",
          "body": "<!-- Please reserve GitHub issues for bug reports and feature requests.\r\n\r\nFor questions, the best place to get answers is on our [discussion forum](https://discuss.hashicorp.com/c/vault), as they will get more visibility from experienced users than the issue tracker.\r\n\r\nPlease note: We take Vault's security and our users' trust very seriously. If you believe you have found a security issue in Vault, please responsibly disclose by contacting us at security@hashicorp.com. Our PGP key is available at [our security page](https://www.hashicorp.com/security/).\r\n\r\n-->\r\n\r\n**Describe the bug**\r\nLDAP auth can't find user outstand `OU=Vault,OU=Domain_Services,DC=test,DC=loc` location\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Run TLS HA Vault + Raft from helm chart vault-0.6.0\r\n```bash\r\nkubectl -n vault get pod\r\nNAME      READY   STATUS    RESTARTS   AGE\r\nvault-0   1/1     Running   0          25h\r\nvault-1   1/1     Running   0          25h\r\nvault-2   1/1     Running   0          25h\r\n```\r\n```bash\r\nkubectl -n vault get statefulsets.apps \r\nNAME    READY   AGE\r\nvault   3/3     28h\r\n```\r\n2. Enable ldap auth\r\n```bash\r\nvault auth enable ldap\r\n```\r\n3. Set up ldap connection\r\n```bash\r\nvault write auth/ldap/config \\\r\n    url=\"ldaps://ldap.test.loc:636\" \\\r\n    certificate=@ldaps.pem \\\r\n    insecure_tls=false \\\r\n    starttls=true \\\r\n    binddn=\"CN=vault.ad.access,OU=Vault,OU=Domain_Services,DC=test,DC=loc\" \\\r\n    bindpass='**************' \\\r\n    upndomain=\"test.loc\" \\\r\n    userattr=sAMAccountName \\\r\n    userdn=\"DC=test,DC=loc\" \\\r\n    groupfilter=\"(&(objectClass=group)(member:1.2.840.113556.1.4.1941:={{.UserDN}}))\" \\\r\n    groupdn=\"DC=test,DC=loc\" \\\r\n    groupattr=\"cn\"\r\n```\r\n4. Check ldap config\r\n```bash\r\nvault read auth/ldap/config --format=json\r\n{\r\n  \"request_id\": \"8332188c-d634-77ae-d5d9-e22c814e87a7\",\r\n  \"lease_id\": \"\",\r\n  \"lease_duration\": 0,\r\n  \"renewable\": false,\r\n  \"data\": {\r\n    \"anonymous_group_search\": false,\r\n    \"binddn\": \"CN=vault.ad.access,OU=Vault,OU=Domain_Services,DC=test,DC=loc\",\r\n    \"case_sensitive_names\": false,\r\n    \"certificate\": \"-----BEGIN CERTIFICATE-----\\n*****\\n-----END CERTIFICATE-----\",\r\n    \"deny_null_bind\": true,\r\n    \"discoverdn\": false,\r\n    \"groupattr\": \"cn\",\r\n    \"groupdn\": \"DC=test,DC=loc\",\r\n    \"groupfilter\": \"(\\u0026(objectClass=group)(member:1.2.840.113556.1.4.1941:={{.UserDN}}))\",\r\n    \"insecure_tls\": false,\r\n    \"starttls\": true,\r\n    \"tls_max_version\": \"tls12\",\r\n    \"tls_min_version\": \"tls10\",\r\n    \"token_bound_cidrs\": [],\r\n    \"token_explicit_max_ttl\": 0,\r\n    \"token_max_ttl\": 0,\r\n    \"token_no_default_policy\": false,\r\n    \"token_num_uses\": 0,\r\n    \"token_period\": 0,\r\n    \"token_policies\": [],\r\n    \"token_ttl\": 0,\r\n    \"token_type\": \"default\",\r\n    \"upndomain\": \"test.loc\",\r\n    \"url\": \"ldaps://ldap.test.loc:636\",\r\n    \"use_pre111_group_cn_behavior\": true,\r\n    \"use_token_groups\": false,\r\n    \"userattr\": \"samaccountname\",\r\n    \"userdn\": \"DC=test,DC=loc\"\r\n  },\r\n  \"warnings\": null\r\n}\r\n```\r\n5. Create test user\r\n```bash\r\nldapsearch -x -LLL -h ldap.test.loc \\\r\n    -D \"CN=vault.ad.access,OU=Vault,OU=Domain_Services,DC=test,DC=loc\" -w \"*******\" \\\r\n    -b \"dc=test,dc=loc\" \"(sAMAccountName=vault)\" dn memberOf sAMAccountName\r\ndn: CN=vault,OU=Vault,OU=Domain_Services,DC=test,DC=loc\r\nmemberOf: CN=Vault.Admins,OU=Vault,OU=Domain_Services,DC=test,DC=loc\r\nsAMAccountName: vault\r\n```\r\n6. Create mapping for ldap group to policy\r\n```bash\r\nvault write auth/ldap/groups/Vault.Admins policies=vault-admin\r\n```\r\n```bash\r\nvault read auth/ldap/groups/vault.admins\r\nKey         Value\r\n---         -----\r\npolicies    [vault-admin]\r\n```\r\n7. Try to connect with test user\r\n```bash\r\n$ vault login -method=ldap username=vault\r\nPassword (will be hidden): \r\nWARNING! The VAULT_TOKEN environment variable is set! This takes precedence\r\nover the value set by this command. To use the value set by this command,\r\nunset the VAULT_TOKEN environment variable or set it to the token displayed\r\nbelow.\r\n\r\nSuccess! You are now authenticated. The token information displayed below\r\nis already stored in the token helper. You do NOT need to run \"vault login\"\r\nagain. Future Vault requests will automatically use this token.\r\n\r\nKey                    Value\r\n---                    -----\r\ntoken                  s.duKYuWYyhUpb2J31WWvr7jIo\r\ntoken_accessor         lI3f9dstd9B7VFqprUAuWruV\r\ntoken_duration         768h\r\ntoken_renewable        true\r\ntoken_policies         [\"default\" \"vault-admin\"]\r\nidentity_policies      []\r\npolicies               [\"default\" \"vault-admin\"]\r\ntoken_meta_username    vault\r\n```\r\n8. Try to connect with existing client user\r\n```bash\r\nvault login -method=ldap username=client\r\nPassword (will be hidden): \r\nError authenticating: Error making API request.\r\n\r\nURL: PUT https://vault.ingress.infra.kuber.int/v1/auth/ldap/login/client\r\nCode: 400. Errors:\r\n\r\n* ldap operation failed: unable to retrieve user bind DN\r\n```\r\n```bash\r\nldapsearch -x -LLL -h ldap.test.loc \\     \r\n    -D \"CN=vault.ad.access,OU=Vault,OU=Domain_Services,DC=test,DC=loc\" -w \"******\" \\\r\n    -b \"dc=test,dc=loc\" \"(sAMAccountName=client)\" dn memberOf sAMAccountName\r\ndn:: Q049RGVtaWFuZW5rbyBZZXZoZW4sT1U9RGV2T1BTIFRlYW0sT1U9T3BlcmF0aW9uIFRlYW0sT\r\n 1U9SVQgRGVwYXJ0bWVudCxPVT3QptC10L3RgtGA0LDQu9GM0L3Ri9C5INC+0YTQuNGBLE9VPURvbW\r\n Fpbl9Vc2VycyxEQz1iZXQsREM9bG9j\r\nmemberOf: CN=Vault.Admins,OU=Vault,OU=Domain_Services,DC=test,DC=loc\r\nsAMAccountName: client\r\n```\r\n**Expected behavior**\r\nSuccess login and apply mapped group vault-admin\r\n\r\n**Environment:**\r\n* Vault Server Version (retrieve with `vault status`): 1.4.2\r\n* Vault CLI Version (retrieve with `vault version`): v1.4.3\r\n* Server Operating System/Architecture: Kubernetes \r\n\r\nVault server configuration file(s):\r\n\r\n```hcl\r\ndisable_mlock = true\r\nui = true\r\n\r\n\r\napi_addr = \"https://POD_IP:8200\"\r\ncluster_addr = \"https://POD_IP:8201\"\r\nlistener \"tcp\" {\r\n  address          = \"0.0.0.0:8200\"\r\n  cluster_address  = \"0.0.0.0:8201\"\r\n  \r\n  http_idle_timeout         = \"5m\"\r\n  http_read_header_timeout  = \"10s\"\r\n  http_read_timeout         = \"30s\"\r\n  http_write_timeout        = \"0\"\r\n  max_request_size          = 33554432\r\n  max_request_duration      = \"90s\"\r\n  tls_disable        = \"false\"\r\n  tls_cert_file      = \"/vault/certs/vault-server-tls/tls.crt\"\r\n  tls_key_file       = \"/vault/certs/vault-server-tls/tls.key\"\r\n  tls_client_ca_file = \"/vault/certs/vault-server-tls/tls-ca.crt\"\r\n  tls_min_version    = \"tls12\"\r\n}\r\nstorage \"raft\" {\r\n  path = \"/vault/data\"\r\n}\r\n\r\nservice_registration \"kubernetes\" {}\r\n```\r\n\r\n**Additional context**\r\nMember list of `Vault.Admins`\r\n```bash\r\nldapsearch -x -LLL -H ldaps://ldap.test.loc  -w \"****\" \\\r\n    -D \"CN=vault.ad.access,OU=Vault,OU=Domain_Services,DC=test,DC=loc\" \\\r\n    -b \"DC=test,DC=loc\" \\\r\n    \"(&(objectCategory=person)(memberOf=CN=Vault.Admins,OU=Vault,OU=Domain_Services,DC=test,DC=loc))\"  \\\r\n    dn memberOf sAMAccountName\r\ndn:: Q049RGVtaWFuZW5rbyBZZXZoZW4sT1U9RGV2T1BTIFRlYW0sT1U9T3BlcmF0aW9uIFRlYW0sT\r\n 1U9SVQgRGVwYXJ0bWVudCxPVT3QptC10L3RgtGA0LDQu9GM0L3Ri9C5INC+0YTQuNGBLE9VPURvbW\r\n Fpbl9Vc2VycyxEQz1iZXQsREM9bG9j\r\nmemberOf: CN=Vault.Admins,OU=Vault,OU=Domain_Services,DC=test,DC=loc\r\nsAMAccountName: y.demianenko\r\n\r\ndn: CN=vault,OU=Vault,OU=Domain_Services,DC=test,DC=loc\r\nmemberOf: CN=Vault.Admins,OU=Vault,OU=Domain_Services,DC=test,DC=loc\r\nsAMAccountName: vault\r\n```\r\n",
          "events": []
        },
        {
          "id": "655999477",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ4Mzc2MTM3",
          "number": 9463,
          "html_url": "https://github.com/hashicorp/vault/pull/9463",
          "title": "Update Alert banner message-body to match design system",
          "user": {
            "type": "user",
            "login": "Monkeychip"
          },
          "labels": [
            {
              "id": "872623767",
              "node_id": "MDU6TGFiZWw4NzI2MjM3Njc=",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/ui",
              "name": "ui",
              "color": "88e56e",
              "description": "",
              "default": false
            }
          ],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594659380000,
          "updated_at": 1594739095000,
          "closed_at": 1594739095000,
          "author_association": "CONTRIBUTOR",
          "body": "The new design system has the alert banner text black.  This PR updates that. \r\n\r\nTo have the least impact on other elements/components using the `.message-body` class I created a new .scss file for alert-banners and renamed the class it's using.  This keeps the change contained to the `alert-banner` component.\r\n\r\n**Here are the design system pictures:**\r\n<img width=500 src=\"https://user-images.githubusercontent.com/6618863/87331428-2bdb9b00-c4f7-11ea-8c27-7f01cfdafd52.png\">\r\n\r\n**Here is the before the fix:**\r\n<img width=500 src=\"https://user-images.githubusercontent.com/6618863/87331469-3ac24d80-c4f7-11ea-89ea-b776d6d1d543.png\">\r\n\r\n**Here is the fix with the PR:**\r\n<img width=500 src=\"https://user-images.githubusercontent.com/6618863/87331132-c12a5f80-c4f6-11ea-8827-f177afa4eeaf.png\">\r\n\r\n\r\n\r\n\r\n\r\n",
          "milestone": {
            "id": "5107883",
            "number": 65,
            "title": "1.5"
          },
          "events": []
        },
        {
          "id": "656369252",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ4NjgwNjE3",
          "number": 9475,
          "html_url": "https://github.com/hashicorp/vault/pull/9475",
          "title": "Backport #9416 to 1.5",
          "user": {
            "type": "user",
            "login": "tvoran"
          },
          "labels": [],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594708863000,
          "updated_at": 1594742432000,
          "closed_at": 1594742427000,
          "author_association": "MEMBER",
          "body": "Backport #9416 ",
          "milestone": {
            "id": "5107883",
            "number": 65,
            "title": "1.5"
          },
          "events": []
        },
        {
          "id": "656370393",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ4NjgxNTI5",
          "number": 9476,
          "html_url": "https://github.com/hashicorp/vault/pull/9476",
          "title": "Backporting #9416 to 1.4.4",
          "user": {
            "type": "user",
            "login": "tvoran"
          },
          "labels": [],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594709009000,
          "updated_at": 1594742489000,
          "closed_at": 1594742485000,
          "author_association": "MEMBER",
          "body": "Don't require AWS_ROLE_SESSION_NAME to sts:AssumeRoleWithWebIdentity (#9416)\r\n\r\nFixes #9415\r\n\r\nCo-authored-by: Theron Voran <tvoran@users.noreply.github.com>",
          "milestone": {
            "id": "5579414",
            "number": 74,
            "title": "1.4.4"
          },
          "events": []
        },
        {
          "id": "656730094",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ4OTc2NjMy",
          "number": 9479,
          "html_url": "https://github.com/hashicorp/vault/pull/9479",
          "title": "Backport 1.5.x: Update Alert banner message-body to match design system (#9463)",
          "user": {
            "type": "user",
            "login": "Monkeychip"
          },
          "labels": [
            {
              "id": "965254381",
              "node_id": "MDU6TGFiZWw5NjUyNTQzODE=",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/backport",
              "name": "backport",
              "color": "ed8496",
              "description": "",
              "default": false
            },
            {
              "id": "872623767",
              "node_id": "MDU6TGFiZWw4NzI2MjM3Njc=",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/ui",
              "name": "ui",
              "color": "88e56e",
              "description": "",
              "default": false
            }
          ],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594742980000,
          "updated_at": 1594745235000,
          "closed_at": 1594745229000,
          "author_association": "CONTRIBUTOR",
          "body": "This is a backport for this [PR](https://github.com/hashicorp/vault/pull/9463)",
          "milestone": {
            "id": "5107883",
            "number": 65,
            "title": "1.5"
          },
          "events": []
        },
        {
          "id": "656685222",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ4OTQwMDYw",
          "number": 9478,
          "html_url": "https://github.com/hashicorp/vault/pull/9478",
          "title": "I'd set MaxWait to a small value for local testing, but the default i",
          "user": {
            "type": "user",
            "login": "ncabatoff"
          },
          "labels": [],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 1,
          "created_at": 1594739168000,
          "updated_at": 1594750901000,
          "closed_at": 1594750897000,
          "author_association": "CONTRIBUTOR",
          "body": "s probably better for CI.",
          "events": []
        },
        {
          "id": "656731378",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ4OTc3NjM1",
          "number": 9480,
          "html_url": "https://github.com/hashicorp/vault/pull/9480",
          "title": "vault operator doc page example usage update for v1.4.2",
          "user": {
            "type": "user",
            "login": "assareh"
          },
          "labels": [],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594743101000,
          "updated_at": 1594753178000,
          "author_association": "CONTRIBUTOR",
          "body": "updating the vault operator example usage on the vault operator doc page for v1.4.2 which includes migrate and raft subcommands",
          "events": []
        },
        {
          "id": "654298877",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ3MDUzMTgw",
          "number": 9436,
          "html_url": "https://github.com/hashicorp/vault/pull/9436",
          "title": "Remove namespace from mount_point label.",
          "user": {
            "type": "user",
            "login": "mgritter"
          },
          "labels": [
            {
              "id": "1661028911",
              "node_id": "MDU6TGFiZWwxNjYxMDI4OTEx",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/core/metric",
              "name": "core/metric",
              "color": "0000ff",
              "description": "",
              "default": false
            }
          ],
          "state": "closed",
          "locked": false,
          "assignee": {
            "type": "user",
            "login": "mgritter"
          },
          "assignees": [
            {
              "type": "user",
              "login": "mgritter"
            }
          ],
          "comments": 4,
          "created_at": 1594323205000,
          "updated_at": 1594754892000,
          "closed_at": 1594754892000,
          "author_association": "CONTRIBUTOR",
          "body": "This makes mount_point consistent across metrics; previously some had the namespace label and some did not:\r\n\r\n![image](https://user-images.githubusercontent.com/7472514/87082780-21688b00-c1f1-11ea-98ee-0100dc164220.png)\r\n\r\n\r\n",
          "milestone": {
            "id": "5107883",
            "number": 65,
            "title": "1.5"
          },
          "events": []
        },
        {
          "id": "117873879",
          "node_id": "MDU6SXNzdWUxMTc4NzM4Nzk=",
          "number": 793,
          "html_url": "https://github.com/hashicorp/vault/issues/793",
          "title": "debian package?",
          "user": {
            "type": "user",
            "login": "thecaddy"
          },
          "labels": [],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 5,
          "created_at": 1447956790000,
          "updated_at": 1594763429000,
          "closed_at": 1447961255000,
          "author_association": "NONE",
          "body": "Is there a debian or ubuntu vault package?  I can't seem to be able to find one.  I'd like to avoid managing my own install scripts if possible.\n",
          "events": [
            {
              "id": 158166596,
              "created_at": 1447961255000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/158166596",
              "actor": "jefferai",
              "body": "I honestly do not know which distributions do or do not package Vault. We do not ourselves produce such a package at this time.\n",
              "user": "jefferai",
              "html_url": "https://github.com/hashicorp/vault/issues/793#issuecomment-158166596"
            },
            {
              "id": 469575274,
              "created_at": 1447961255000,
              "event": "closed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/469575274",
              "actor": "jefferai"
            },
            {
              "id": 218956220,
              "created_at": 1463117771000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/218956220",
              "actor": "msabramo",
              "body": "Haven't found one for Vault, but found one for Consul:\n\nhttps://github.com/bcandrea/consul-deb\n\nPerhaps that could be adapted for Vault (and ideally shared on GitHub as well). \n",
              "user": "msabramo",
              "html_url": "https://github.com/hashicorp/vault/issues/793#issuecomment-218956220"
            },
            {
              "id": 218956402,
              "created_at": 1463117865000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/218956402",
              "actor": "msabramo",
              "body": "Oh, just found this:\n\nhttps://github.com/Buzer/vault-deb\n",
              "user": "msabramo",
              "html_url": "https://github.com/hashicorp/vault/issues/793#issuecomment-218956402"
            },
            {
              "id": 342901022,
              "created_at": 1510163824000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/342901022",
              "actor": "elopio",
              "body": "There is a [vault snap](https://github.com/snapcrafters/vault) in the store.",
              "user": "elopio",
              "html_url": "https://github.com/hashicorp/vault/issues/793#issuecomment-342901022"
            },
            {
              "id": 658431413,
              "created_at": 1594763429000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/658431413",
              "actor": "nyetwurk",
              "body": "Snap is not acceptable.",
              "user": "nyetwurk",
              "html_url": "https://github.com/hashicorp/vault/issues/793#issuecomment-658431413"
            }
          ]
        },
        {
          "id": "642394956",
          "node_id": "MDU6SXNzdWU2NDIzOTQ5NTY=",
          "number": 9276,
          "html_url": "https://github.com/hashicorp/vault/issues/9276",
          "title": "Vault leaking file descriptors in Standby Mode",
          "user": {
            "type": "user",
            "login": "pierresouchay"
          },
          "labels": [
            {
              "id": "1492658523",
              "node_id": "MDU6TGFiZWwxNDkyNjU4NTIz",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/bug",
              "name": "bug",
              "color": "ef97a7",
              "description": "",
              "default": true
            },
            {
              "id": "1657574876",
              "node_id": "MDU6TGFiZWwxNjU3NTc0ODc2",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/core",
              "name": "core",
              "color": "0052cc",
              "description": "Issues and Pull-Requests specific to Vault Core",
              "default": false
            },
            {
              "id": "1658581560",
              "node_id": "MDU6TGFiZWwxNjU4NTgxNTYw",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/waiting-for-response",
              "name": "waiting-for-response",
              "color": "5dd892",
              "description": "",
              "default": false
            }
          ],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 7,
          "created_at": 1592666359000,
          "updated_at": 1594817142000,
          "author_association": "NONE",
          "body": "**Describe the bug**\r\n\r\nIn standby mode, Vault is leaking descriptors (while the leader is fine)\r\nThis happens only in one of our clusters, but vault is leaking around 10 fd/s until it reaches its limit (16k).\r\n\r\nThe file descriptors are not shown with `ss` command but can be shown with `lsof -U vault`:\r\n```\r\nvault   1353 vault *190u     sock                0,9       0t0    110799 protocol: TCP\r\nvault   1353 vault *191u     sock                0,9       0t0    110801 protocol: TCP\r\nvault   1353 vault *192u     sock                0,9       0t0    105365 protocol: TCP\r\nvault   1353 vault *193u     sock                0,9       0t0    105367 protocol: TCP\r\nvault   1353 vault *194u     sock                0,9       0t0    110803 protocol: TCP\r\nvault   1353 vault *195u     sock                0,9       0t0    105369 protocol: TCP\r\nvault   1353 vault *196u     sock                0,9       0t0    110805 protocol: TCP\r\n```\r\n\r\n```\r\nsudo lsof -u vault|wc -l\r\n16388\r\n```\r\n\r\n99% of them are showing \"protocol: TCP\": \r\n```\r\nsudo lsof -u vault|grep \"protocol: TCP\"|wc -l\r\n16365\r\n```\r\n\r\n**To Reproduce**\r\nUntil unsealed, no problem, but when unsealling the vault, it starts leaking FDs.\r\n\r\n**Expected behavior**\r\nA clear and concise description of what you expected to happen.\r\n\r\n**Environment:**\r\n```\r\nKey             Value\r\n---             -----\r\nSeal Type       shamir\r\nInitialized     true\r\nSealed          false\r\nTotal Shares    4\r\nThreshold       2\r\nVersion         1.4.0-criteo1\r\nCluster Name    vault-cluster-2c1f174d\r\nCluster ID      a238e897-cf90-684d-90e9-0030d0a6de47\r\nHA Enabled      true\r\nHA Cluster      https://consulkv06-par.central.criteo.prod:8201\r\nHA Mode         active\r\n```\r\n\r\nVau\r\n\r\nVault server configuration file(s):\r\n\r\n```json\r\n{\r\n  \"api_addr\": \"http://mymachine.example.acme.org:8200\",\r\n  \"disable_mlock\": true,\r\n  \"ui\": true,\r\n  \"plugin_directory\": \"/var/opt/vault/plugins/\",\r\n  \"listener\": {\r\n    \"tcp\": {\r\n      \"address\": \"0.0.0.0:8200\",\r\n      \"tls_disable\": \"true\"\r\n    }\r\n  },\r\n  \"storage\": {\r\n    \"consul\": {\r\n      \"address\": \"http://localhost:9500\",\r\n      \"token\": \"xxxx-xxxx-xxxx-xxxxx-xxxxx\"\r\n    }\r\n  },\r\n  \"ha_storage\": {\r\n    \"consul\": {\r\n      \"address\": \"http://localhost:9500\",\r\n      \"path\": \"ha-vault\",\r\n      \"token\": \"xxxx-xxxxx-xxxx-xxxx-xxxx-xxx\"\r\n    }\r\n  },\r\n  \"telemetry\": {\r\n    \"prometheus_retention_time\": \"24h\",\r\n    \"disable_hostname\": true\r\n  }\r\n}\r\n```\r\n\r\nLooks a bit similar to #3633 and https://github.com/hashicorp/vault/issues/3244",
          "events": [
            {
              "id": 647692666,
              "created_at": 1592849770000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/647692666",
              "actor": "ncabatoff",
              "body": "Hi @pierresouchay,\r\n\r\nThis looks like a custom build/fork of Vault.  Can you reproduce this with one of our binaries?",
              "user": "ncabatoff",
              "html_url": "https://github.com/hashicorp/vault/issues/9276#issuecomment-647692666"
            },
            {
              "id": 3469616723,
              "created_at": 1592849770000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3469616723",
              "actor": "pierresouchay"
            },
            {
              "id": 3469616726,
              "created_at": 1592849770000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3469616726",
              "actor": "pierresouchay"
            },
            {
              "id": 647698493,
              "created_at": 1592850514000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/647698493",
              "actor": "pierresouchay",
              "body": "@ncabatoff We are still investigating, we will keep you posted\r\ncc @tionebsalocin ",
              "user": "pierresouchay",
              "html_url": "https://github.com/hashicorp/vault/issues/9276#issuecomment-647698493"
            },
            {
              "id": 3469658227,
              "created_at": 1592850514000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3469658227",
              "actor": "ncabatoff"
            },
            {
              "id": 3469658229,
              "created_at": 1592850514000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3469658229",
              "actor": "ncabatoff"
            },
            {
              "id": 3469658235,
              "created_at": 1592850514000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3469658235",
              "actor": "tionebsalocin"
            },
            {
              "id": 3469658240,
              "created_at": 1592850514000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3469658240",
              "actor": "tionebsalocin"
            },
            {
              "id": 3516271952,
              "created_at": 1594046413000,
              "event": "labeled",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3516271952",
              "actor": "ncabatoff",
              "label": "bug"
            },
            {
              "id": 3516271953,
              "created_at": 1594046413000,
              "event": "labeled",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3516271953",
              "actor": "ncabatoff",
              "label": "core"
            },
            {
              "id": 3516272341,
              "created_at": 1594046418000,
              "event": "labeled",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3516272341",
              "actor": "ncabatoff",
              "label": "waiting-for-response"
            },
            {
              "id": 658176858,
              "created_at": 1594733028000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/658176858",
              "actor": "ncabatoff",
              "body": "I wonder if this is related to #9383?",
              "user": "ncabatoff",
              "html_url": "https://github.com/hashicorp/vault/issues/9276#issuecomment-658176858"
            },
            {
              "id": 658180155,
              "created_at": 1594733416000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/658180155",
              "actor": "pierresouchay",
              "body": "@ncabatoff Indeed that's possible we are using plugins!",
              "user": "pierresouchay",
              "html_url": "https://github.com/hashicorp/vault/issues/9276#issuecomment-658180155"
            },
            {
              "id": 3544173369,
              "created_at": 1594733416000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3544173369",
              "actor": "ncabatoff"
            },
            {
              "id": 3544173374,
              "created_at": 1594733416000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3544173374",
              "actor": "ncabatoff"
            },
            {
              "id": 658649977,
              "created_at": 1594804443000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/658649977",
              "actor": "sorindumitru",
              "body": "@ncabatoff @pierresouchay I ran my reproducer locally and this does seem to be the case. After each `Setup()` failure for a plugin I get the following extra fds in vault:\r\n```\r\nvault   2730652 sdumitru   11r     FIFO               0,13       0t0 8877065 pipe\r\nvault   2730652 sdumitru   12u     IPv4            8877068       0t0     TCP localhost:14505->localhost:50884 (ESTABLISHED)\r\nvault   2730652 sdumitru   13r     FIFO               0,13       0t0 8877066 pipe\r\nvault   2730652 sdumitru   14u     unix 0x000000005e240baf       0t0 8877071 /tmp/plugin047720296 type=STREAM\r\nvault   2730652 sdumitru   15u     unix 0x00000000caae83d0       0t0 8875129 type=STREAM\r\nvault   2730652 sdumitru   16u     unix 0x00000000b7849ca2       0t0 8873950 /tmp/plugin047720296 type=STREAM\r\n```\r\n\r\nThe easiest way to reproduce it for me was to run with TRACE logging, an external authentication plugin and this patch to vault:\r\n```\r\ndiff --git a/sdk/plugin/middleware.go b/sdk/plugin/middleware.go\r\nindex 04a6f4c50..12da9dbd4 100644\r\n--- a/sdk/plugin/middleware.go\r\n+++ b/sdk/plugin/middleware.go\r\n@@ -2,6 +2,7 @@ package plugin\r\n\r\n import (\r\n        \"context\"\r\n+       \"fmt\"\r\n        \"time\"\r\n\r\n        log \"github.com/hashicorp/go-hclog\"\r\n@@ -81,13 +82,23 @@ func (b *backendTracingMiddleware) InvalidateKey(ctx context.Context, key string\r\n        b.next.InvalidateKey(ctx, key)\r\n }\r\n\r\n+var fail int = 0\r\n+\r\n func (b *backendTracingMiddleware) Setup(ctx context.Context, config *logical.BackendConfig) (err error) {\r\n        defer func(then time.Time) {\r\n                b.logger.Trace(\"setup\", \"status\", \"finished\", \"err\", err, \"took\", time.Since(then))\r\n        }(time.Now())\r\n\r\n        b.logger.Trace(\"setup\", \"status\", \"started\")\r\n-       return b.next.Setup(ctx, config)\r\n+       err = b.next.Setup(ctx, config)\r\n+\r\n+       if b.Type() == logical.TypeCredential {\r\n+               if fail >= 1 {\r\n+                       err = fmt.Errorf(\"just giving up\")\r\n+               }\r\n+               fail = fail + 1\r\n+       }\r\n+       return err\r\n }\r\n\r\n func (b *backendTracingMiddleware) Type() logical.BackendType {\r\n```\r\n\r\nI used that fail condition to test a bunch of cases. With this i just `curl` the authentication endpoint for my plugin and that triggers a leak.\r\n",
              "user": "sorindumitru",
              "html_url": "https://github.com/hashicorp/vault/issues/9276#issuecomment-658649977"
            },
            {
              "id": 3547651825,
              "created_at": 1594804443000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3547651825",
              "actor": "ncabatoff"
            },
            {
              "id": 3547651828,
              "created_at": 1594804443000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3547651828",
              "actor": "ncabatoff"
            },
            {
              "id": 3547651840,
              "created_at": 1594804443000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3547651840",
              "actor": "pierresouchay"
            },
            {
              "id": 3547651845,
              "created_at": 1594804444000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3547651845",
              "actor": "pierresouchay"
            },
            {
              "id": 658739774,
              "created_at": 1594816324000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/658739774",
              "actor": "ncabatoff",
              "body": "Further evidence: `lsof -U` shows only unix domain sockets, which IIRC are only used in Vault for talking to plugins.",
              "user": "ncabatoff",
              "html_url": "https://github.com/hashicorp/vault/issues/9276#issuecomment-658739774"
            },
            {
              "id": 658745764,
              "created_at": 1594817141000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/658745764",
              "actor": "pierresouchay",
              "body": "@ncabatoff yes, same here",
              "user": "pierresouchay",
              "html_url": "https://github.com/hashicorp/vault/issues/9276#issuecomment-658745764"
            },
            {
              "id": 3548392461,
              "created_at": 1594817142000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3548392461",
              "actor": "ncabatoff"
            },
            {
              "id": 3548392462,
              "created_at": 1594817142000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3548392462",
              "actor": "ncabatoff"
            }
          ]
        },
        {
          "id": "657417451",
          "node_id": "MDU6SXNzdWU2NTc0MTc0NTE=",
          "number": 9486,
          "html_url": "https://github.com/hashicorp/vault/issues/9486",
          "title": "Autojoin for integrated raft storage and SSL issues",
          "user": {
            "type": "user",
            "login": "awolde"
          },
          "labels": [],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594824905000,
          "updated_at": 1594824926000,
          "author_association": "NONE",
          "body": "In my `vault.hcl` config I have to list all the \"expected\" IPs of vault nodes like this to setup integrated storage:\r\n\r\n```\r\nstorage \"raft\" {\r\n  path    = \"/opt/vault/\"\r\n  node_id = \"node-${INSTANCE_ID}\"\r\n  retry_join {\r\n    leader_api_addr = \"https://${IP1}:8200\"\r\n  }\r\n  retry_join {\r\n    leader_api_addr = \"https://${IP2}:8200\"\r\n  }\r\n}\r\n```\r\n\r\n**Describe the solution you'd like**\r\nHaving something like what Consul is doing with autojoin will greatly help:\r\n```\r\nretry_join          = [\"provider=gce project_name=${project} tag_value=my-consul\"]\r\n```\r\n\r\nAlso if I am using a single SSL cert for my Vault cluster, the `retry_join` block wont work because there is no way I can map the cert's CN to different IPs. The only way I can use TLS is if I have some dynamic way of DNS updates when nodes in the cluster come and go and a wildcard cert for all my nodes. Maybe leverage the 8201 port for raft backend??\r\n\r\n**Describe alternatives you've considered**\r\nBecause of the above reasons, I'm still using Consul backend.\r\n\r\n",
          "events": []
        },
        {
          "id": "656962439",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ5MTY2Mjg0",
          "number": 9482,
          "html_url": "https://github.com/hashicorp/vault/pull/9482",
          "title": "Backport 1.5: Remove namespace from mount_point label. (#9436)",
          "user": {
            "type": "user",
            "login": "mgritter"
          },
          "labels": [
            {
              "id": "965254381",
              "node_id": "MDU6TGFiZWw5NjUyNTQzODE=",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/backport",
              "name": "backport",
              "color": "ed8496",
              "description": "",
              "default": false
            },
            {
              "id": "1661028911",
              "node_id": "MDU6TGFiZWwxNjYxMDI4OTEx",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/core/metric",
              "name": "core/metric",
              "color": "0000ff",
              "description": "",
              "default": false
            }
          ],
          "state": "closed",
          "locked": false,
          "assignee": {
            "type": "user",
            "login": "mgritter"
          },
          "assignees": [
            {
              "type": "user",
              "login": "mgritter"
            }
          ],
          "comments": 0,
          "created_at": 1594770167000,
          "updated_at": 1594826979000,
          "closed_at": 1594826793000,
          "author_association": "CONTRIBUTOR",
          "body": "* Remove namespace from mount_point label.\r\n* Fix the other two places where vault.token.creation is emitted.",
          "milestone": {
            "id": "5107883",
            "number": 65,
            "title": "1.5"
          },
          "events": []
        },
        {
          "id": "578737203",
          "node_id": "MDU6SXNzdWU1Nzg3MzcyMDM=",
          "number": 8522,
          "html_url": "https://github.com/hashicorp/vault/issues/8522",
          "title": "Vault HA bug",
          "user": {
            "type": "user",
            "login": "riuvshyn"
          },
          "labels": [
            {
              "id": "1492658523",
              "node_id": "MDU6TGFiZWwxNDkyNjU4NTIz",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/bug",
              "name": "bug",
              "color": "ef97a7",
              "description": "",
              "default": true
            },
            {
              "id": "1806917238",
              "node_id": "MDU6TGFiZWwxODA2OTE3MjM4",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/core/ha",
              "name": "core/ha",
              "color": "0000ff",
              "description": "specific to high-availability",
              "default": false
            }
          ],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 3,
          "created_at": 1583860525000,
          "updated_at": 1594827362000,
          "author_association": "CONTRIBUTOR",
          "body": "`Version 1.3.1, 1.3.3`\r\nHA backend: `MySQL` \r\nStorage backend: `s3`\r\nruntime env `k8s`\r\nreplicas: `3`\r\n\r\nWhen leadership is lost and re-election happens clients getting errors:\r\n\r\n```\r\nlocal node not active but active cluster node not found\r\n```\r\n\r\nVault logs:\r\n\r\nStand-by `replica(1)` received client request and failed with\r\n```\r\n2020-03-10T17:01:55.901Z [INFO]  core: entering standby mode\r\n2020-03-10T17:01:55.907Z [INFO]  core: vault is unsealed\r\n2020-03-10T17:01:55.907Z [INFO]  core: unsealed with stored keys: stored_keys_used=1\r\n2020-03-10T17:06:09.206Z [ERROR] core: error during forwarded RPC request: error=\"rpc error: code = Unavailable desc = transport is closing\"\r\n2020-03-10T17:06:09.206Z [ERROR] core: forward request error: error=\"error during forwarding RPC request\"\r\n```\r\n\r\nSteps to reproduce:\r\n1) This can be easily reproduced using `vault operator step-down` command.\r\nEvery time I run `step-down` command some clients are getting `local node not active but active cluster node not found` error.\r\n\r\n2) another way to reproduce it is a  Vault version upgrade, configuration change or anything that will cause vault restart and change leader. That makes using Vault in production environments with critical workload very dangerous especially in dynamic environments like k8s where pods can be rescheduled anytime.\r\n\r\nThat error seems to happen only on stand-by replicas that are forwarding requests to the leader.\r\n\r\nEx leader  `replica(2)` does not have any errors:\r\n```\r\n2020-03-10T17:03:06.226Z [INFO]  identity: entities restored\r\n2020-03-10T17:03:06.236Z [INFO]  identity: groups restored\r\n2020-03-10T17:03:06.354Z [INFO]  core: post-unseal setup complete\r\n2020-03-10T17:03:06.513Z [INFO]  expiration: lease restore complete\r\n2020-03-10T17:06:08.705Z [WARN]  core: stepping down from active operation to standby\r\n2020-03-10T17:06:08.705Z [INFO]  core: pre-seal teardown starting\r\n2020-03-10T17:06:09.205Z [INFO]  rollback: stopping rollback manager\r\n2020-03-10T17:06:09.206Z [INFO]  core: pre-seal teardown complete\r\n```\r\n\r\nNew leader `replica(3)` logs are also clean...\r\n\r\npossibly related to https://github.com/hashicorp/vault/issues/8467",
          "events": [
            {
              "id": 3115719115,
              "created_at": 1583861228000,
              "event": "labeled",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3115719115",
              "actor": "catsby",
              "label": "bug"
            },
            {
              "id": 3115719118,
              "created_at": 1583861228000,
              "event": "labeled",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3115719118",
              "actor": "catsby",
              "label": "core/ha"
            },
            {
              "id": 597225264,
              "created_at": 1583862655000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/597225264",
              "actor": "riuvshyn",
              "body": "reproduced on `1.3.3`",
              "user": "riuvshyn",
              "html_url": "https://github.com/hashicorp/vault/issues/8522#issuecomment-597225264"
            },
            {
              "id": 613902752,
              "created_at": 1586940017000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/613902752",
              "actor": "riuvshyn",
              "body": "reproduced on `1.4.0`,  any update on this? \r\nThis bug causes downtime for every Vault restart / upgrade.\r\nI can share configuration to reproduce this if that could help...\r\n\r\nSo here I put configuration I use to reproduce this. https://github.com/riuvshyn/vault-ha-local\r\nIt basically runs docker-compose with 3 Vault replicas MysqlDB and Nginx frontend as LB\r\nthere is no automation on init & unseal so this is manual steps.\r\nOnce Vault is unsealed you can use script `test.sh` which basically jus runs in a loop `VAULT_ADDR=http://localhost:8080 VAULT_TOKEN=${VAULT_TOKEN} vault policy read default` command and while it is running just execute stepdown command like this: `VAULT_ADDR=http://localhost:8080 VAULT_TOKEN=${VAULT_TOKEN} vault operator step-down`\r\nafter executing the stepdown command `test.sh` script will stop executing with some error like:\r\n```\r\nError reading policy named default: Error making API request.\r\n\r\nURL: GET http://localhost:8080/v1/sys/policies/acl/default\r\nCode: 500. Errors:\r\n\r\n* local node not active but active cluster node not found\r\n```\r\n\r\nSometimes the error is different but for most cases I am getting this one.",
              "user": "riuvshyn",
              "html_url": "https://github.com/hashicorp/vault/issues/8522#issuecomment-613902752"
            },
            {
              "id": 658837575,
              "created_at": 1594827147000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/658837575",
              "actor": "pratiklotia",
              "body": "+1\r\nI'm facing the same issue on 1.4.0. Except getting it on raft integrated storage.\r\n\r\n```\r\n[root@vault1 ~]# vault operator raft list-peers\r\nError reading the raft cluster configuration: Error making API request.\r\n\r\nURL: GET http://10.0.0.1:8200/v1/sys/storage/raft/configuration\r\nCode: 500. Errors:\r\n\r\n* local node not active but active cluster node not found\r\n```\r\n\r\nAny update? Please let me know if I can provide any other details.",
              "user": "pratiklotia",
              "html_url": "https://github.com/hashicorp/vault/issues/8522#issuecomment-658837575"
            }
          ]
        },
        {
          "id": "595693847",
          "node_id": "MDU6SXNzdWU1OTU2OTM4NDc=",
          "number": 8690,
          "html_url": "https://github.com/hashicorp/vault/issues/8690",
          "title": "Vault as an ACME-based CA",
          "user": {
            "type": "user",
            "login": "marcofranssen"
          },
          "labels": [
            {
              "id": "1488905226",
              "node_id": "MDU6TGFiZWwxNDg4OTA1MjI2",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/enhancement",
              "name": "enhancement",
              "color": "0d8232",
              "description": "",
              "default": true
            }
          ],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 7,
          "created_at": 1586248574000,
          "updated_at": 1594827543000,
          "author_association": "NONE",
          "body": "It would be great to be able to use vault as an ACME-based CA which could be used for company internal Certificates.\r\n\r\nSee here a link to the ACME specs. https://github.com/ietf-wg-acme/acme/\r\n\r\nA project that might help on implementing the ACME CA within vault \r\n\r\nhttps://github.com/letsencrypt/boulder\r\n\r\nThat would also allow this project to be integrated with https://github.com/go-acme/lego/issues/1107\r\n",
          "events": [
            {
              "id": 3214827996,
              "created_at": 1586362355000,
              "event": "labeled",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3214827996",
              "actor": "tyrannosaurus-becks",
              "label": "enhancement"
            },
            {
              "id": 611523798,
              "created_at": 1586438395000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/611523798",
              "actor": "delamart",
              "body": "Could this be done by adding ACME API endpoints to the PKI secret engine ?",
              "user": "delamart",
              "html_url": "https://github.com/hashicorp/vault/issues/8690#issuecomment-611523798"
            },
            {
              "id": 618996575,
              "created_at": 1587733554000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/618996575",
              "actor": "marcofranssen",
              "body": "I was also thinking this might be something we have to add on top of the pki engine.",
              "user": "marcofranssen",
              "html_url": "https://github.com/hashicorp/vault/issues/8690#issuecomment-618996575"
            },
            {
              "id": 3275886171,
              "created_at": 1587995543000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3275886171",
              "actor": "jahkeup"
            },
            {
              "id": 627281874,
              "created_at": 1589282753000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/627281874",
              "actor": "chewi",
              "body": "As much as I'd like this, it has already been shot down in #668.",
              "user": "chewi",
              "html_url": "https://github.com/hashicorp/vault/issues/8690#issuecomment-627281874"
            },
            {
              "id": 643051841,
              "created_at": 1591934435000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/643051841",
              "actor": "MarkDeckert",
              "body": "@chewi  That's too bad :(\r\n\r\n https://github.com/hashicorp/vault/issues/668 was filed in 2015, only 1 month after the very first letsencrypt certificate was issued.  I remember for quite a while most client implementations were cludgy at best.\r\n\r\nFast forward to 2020:  Given the sheer amount of software that has 1st class support for ACME built-in now, should ACME compatibility in Vault be reconsidered as worthy of pursuit?",
              "user": "MarkDeckert",
              "html_url": "https://github.com/hashicorp/vault/issues/8690#issuecomment-643051841"
            },
            {
              "id": 3436807129,
              "created_at": 1591934436000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3436807129",
              "actor": "chewi"
            },
            {
              "id": 3436807137,
              "created_at": 1591934436000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3436807137",
              "actor": "chewi"
            },
            {
              "id": 656373341,
              "created_at": 1594332274000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/656373341",
              "actor": "danlsgiga",
              "body": "This would be very much appreciated and a good use case is to enable internal mTLS among a chain of proxies that talk ACME without much effort.",
              "user": "danlsgiga",
              "html_url": "https://github.com/hashicorp/vault/issues/8690#issuecomment-656373341"
            },
            {
              "created_at": 1594800041000,
              "event": "cross-referenced",
              "actor": "nvx",
              "source": {
                "type": "issue",
                "issue": {
                  "url": "https://api.github.com/repos/hashicorp/vault/issues/4950",
                  "repository_url": "https://api.github.com/repos/hashicorp/vault",
                  "labels_url": "https://api.github.com/repos/hashicorp/vault/issues/4950/labels{/name}",
                  "comments_url": "https://api.github.com/repos/hashicorp/vault/issues/4950/comments",
                  "events_url": "https://api.github.com/repos/hashicorp/vault/issues/4950/events",
                  "html_url": "https://github.com/hashicorp/vault/issues/4950",
                  "id": 342522477,
                  "node_id": "MDU6SXNzdWUzNDI1MjI0Nzc=",
                  "number": 4950,
                  "title": "Feature Request: Support Let's Encrypt secret engine",
                  "user": {
                    "login": "tamalsaha",
                    "id": 94814,
                    "node_id": "MDQ6VXNlcjk0ODE0",
                    "avatar_url": "https://avatars1.githubusercontent.com/u/94814?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/tamalsaha",
                    "html_url": "https://github.com/tamalsaha",
                    "followers_url": "https://api.github.com/users/tamalsaha/followers",
                    "following_url": "https://api.github.com/users/tamalsaha/following{/other_user}",
                    "gists_url": "https://api.github.com/users/tamalsaha/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/tamalsaha/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/tamalsaha/subscriptions",
                    "organizations_url": "https://api.github.com/users/tamalsaha/orgs",
                    "repos_url": "https://api.github.com/users/tamalsaha/repos",
                    "events_url": "https://api.github.com/users/tamalsaha/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/tamalsaha/received_events",
                    "type": "User",
                    "site_admin": false
                  },
                  "labels": [
                    {
                      "id": 1658694629,
                      "node_id": "MDU6TGFiZWwxNjU4Njk0NjI5",
                      "url": "https://api.github.com/repos/hashicorp/vault/labels/core/secret",
                      "name": "core/secret",
                      "color": "0000ff",
                      "default": false,
                      "description": ""
                    },
                    {
                      "id": 1658842398,
                      "node_id": "MDU6TGFiZWwxNjU4ODQyMzk4",
                      "url": "https://api.github.com/repos/hashicorp/vault/labels/feature-request",
                      "name": "feature-request",
                      "color": "2a7eba",
                      "default": false,
                      "description": ""
                    }
                  ],
                  "state": "open",
                  "locked": false,
                  "assignees": [],
                  "comments": 31,
                  "created_at": "2018-07-18T23:08:15Z",
                  "updated_at": "2020-07-15T15:47:18Z",
                  "author_association": "NONE",
                  "repository": {
                    "id": 31288958,
                    "node_id": "MDEwOlJlcG9zaXRvcnkzMTI4ODk1OA==",
                    "name": "vault",
                    "full_name": "hashicorp/vault",
                    "private": false,
                    "owner": {
                      "login": "hashicorp",
                      "id": 761456,
                      "node_id": "MDEyOk9yZ2FuaXphdGlvbjc2MTQ1Ng==",
                      "avatar_url": "https://avatars2.githubusercontent.com/u/761456?v=4",
                      "gravatar_id": "",
                      "url": "https://api.github.com/users/hashicorp",
                      "html_url": "https://github.com/hashicorp",
                      "followers_url": "https://api.github.com/users/hashicorp/followers",
                      "following_url": "https://api.github.com/users/hashicorp/following{/other_user}",
                      "gists_url": "https://api.github.com/users/hashicorp/gists{/gist_id}",
                      "starred_url": "https://api.github.com/users/hashicorp/starred{/owner}{/repo}",
                      "subscriptions_url": "https://api.github.com/users/hashicorp/subscriptions",
                      "organizations_url": "https://api.github.com/users/hashicorp/orgs",
                      "repos_url": "https://api.github.com/users/hashicorp/repos",
                      "events_url": "https://api.github.com/users/hashicorp/events{/privacy}",
                      "received_events_url": "https://api.github.com/users/hashicorp/received_events",
                      "type": "Organization",
                      "site_admin": false
                    },
                    "html_url": "https://github.com/hashicorp/vault",
                    "description": "A tool for secrets management, encryption as a service, and privileged access management",
                    "fork": false,
                    "url": "https://api.github.com/repos/hashicorp/vault",
                    "forks_url": "https://api.github.com/repos/hashicorp/vault/forks",
                    "keys_url": "https://api.github.com/repos/hashicorp/vault/keys{/key_id}",
                    "collaborators_url": "https://api.github.com/repos/hashicorp/vault/collaborators{/collaborator}",
                    "teams_url": "https://api.github.com/repos/hashicorp/vault/teams",
                    "hooks_url": "https://api.github.com/repos/hashicorp/vault/hooks",
                    "issue_events_url": "https://api.github.com/repos/hashicorp/vault/issues/events{/number}",
                    "events_url": "https://api.github.com/repos/hashicorp/vault/events",
                    "assignees_url": "https://api.github.com/repos/hashicorp/vault/assignees{/user}",
                    "branches_url": "https://api.github.com/repos/hashicorp/vault/branches{/branch}",
                    "tags_url": "https://api.github.com/repos/hashicorp/vault/tags",
                    "blobs_url": "https://api.github.com/repos/hashicorp/vault/git/blobs{/sha}",
                    "git_tags_url": "https://api.github.com/repos/hashicorp/vault/git/tags{/sha}",
                    "git_refs_url": "https://api.github.com/repos/hashicorp/vault/git/refs{/sha}",
                    "trees_url": "https://api.github.com/repos/hashicorp/vault/git/trees{/sha}",
                    "statuses_url": "https://api.github.com/repos/hashicorp/vault/statuses/{sha}",
                    "languages_url": "https://api.github.com/repos/hashicorp/vault/languages",
                    "stargazers_url": "https://api.github.com/repos/hashicorp/vault/stargazers",
                    "contributors_url": "https://api.github.com/repos/hashicorp/vault/contributors",
                    "subscribers_url": "https://api.github.com/repos/hashicorp/vault/subscribers",
                    "subscription_url": "https://api.github.com/repos/hashicorp/vault/subscription",
                    "commits_url": "https://api.github.com/repos/hashicorp/vault/commits{/sha}",
                    "git_commits_url": "https://api.github.com/repos/hashicorp/vault/git/commits{/sha}",
                    "comments_url": "https://api.github.com/repos/hashicorp/vault/comments{/number}",
                    "issue_comment_url": "https://api.github.com/repos/hashicorp/vault/issues/comments{/number}",
                    "contents_url": "https://api.github.com/repos/hashicorp/vault/contents/{+path}",
                    "compare_url": "https://api.github.com/repos/hashicorp/vault/compare/{base}...{head}",
                    "merges_url": "https://api.github.com/repos/hashicorp/vault/merges",
                    "archive_url": "https://api.github.com/repos/hashicorp/vault/{archive_format}{/ref}",
                    "downloads_url": "https://api.github.com/repos/hashicorp/vault/downloads",
                    "issues_url": "https://api.github.com/repos/hashicorp/vault/issues{/number}",
                    "pulls_url": "https://api.github.com/repos/hashicorp/vault/pulls{/number}",
                    "milestones_url": "https://api.github.com/repos/hashicorp/vault/milestones{/number}",
                    "notifications_url": "https://api.github.com/repos/hashicorp/vault/notifications{?since,all,participating}",
                    "labels_url": "https://api.github.com/repos/hashicorp/vault/labels{/name}",
                    "releases_url": "https://api.github.com/repos/hashicorp/vault/releases{/id}",
                    "deployments_url": "https://api.github.com/repos/hashicorp/vault/deployments",
                    "created_at": "2015-02-25T00:15:59Z",
                    "updated_at": "2020-07-17T20:30:27Z",
                    "pushed_at": "2020-07-17T20:57:34Z",
                    "git_url": "git://github.com/hashicorp/vault.git",
                    "ssh_url": "git@github.com:hashicorp/vault.git",
                    "clone_url": "https://github.com/hashicorp/vault.git",
                    "svn_url": "https://github.com/hashicorp/vault",
                    "homepage": "https://www.vaultproject.io/",
                    "size": 123698,
                    "stargazers_count": 16436,
                    "watchers_count": 16436,
                    "language": "Go",
                    "has_issues": true,
                    "has_projects": false,
                    "has_downloads": true,
                    "has_wiki": false,
                    "has_pages": false,
                    "forks_count": 2534,
                    "archived": false,
                    "disabled": false,
                    "open_issues_count": 708,
                    "license": {
                      "key": "mpl-2.0",
                      "name": "Mozilla Public License 2.0",
                      "spdx_id": "MPL-2.0",
                      "url": "https://api.github.com/licenses/mpl-2.0",
                      "node_id": "MDc6TGljZW5zZTE0"
                    },
                    "forks": 2534,
                    "open_issues": 708,
                    "watchers": 16436,
                    "default_branch": "master"
                  },
                  "body": "We would like to be able to issue ssl certificates from Let's Encrypt using Vault and auto refresh then when certs are about to expire. Do you think Vault can support this as a secret engine?\r\n\r\nWe will be interested in contributing this feature if acceptable."
                }
              }
            },
            {
              "id": 658615530,
              "created_at": 1594800486000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/658615530",
              "actor": "nvx",
              "body": "The problem with ACME is it's designed for an unauthenticated user to be able to get a certificate via completing eg a DNS/http challenge. This is completely opposite to the Vault model where users are strongly authenticated, or as I've seen implemented in other implementations instead of requiring a challenge the ACME url instead has a token in it embedding some form of authorization (using a Vault token here has other issues around token lifecycles). Mapping anonymous or semi-anonymous via some token to eg PKI roles is a whole additional amount of complexity.\r\n\r\nInstead if you wanted to use a Vault CA to issue certificates via an ACME Interface it would make more sense to have a separate service that talks to Vault (benefit no new attack surface on Vault, just the existing well understood PKI roles and policies to hit them) which in turn exposes an ACME compatible API secured via whatever mechanism is desired (some form of token in the URL, doing it's own DNS validation, etc). Since the ACME security model is entirely different than Vault's there is really no advantage to adding ACME endpoints to Vault directly (aside from convenience of not having to run a separate process), and a number of real disadvantages.",
              "user": "nvx",
              "html_url": "https://github.com/hashicorp/vault/issues/8690#issuecomment-658615530"
            },
            {
              "id": 658840881,
              "created_at": 1594827543000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/658840881",
              "actor": "mholt",
              "body": "> The problem with ACME is it's designed for an unauthenticated user to be able to get a certificate\r\n\r\nFYI, ACME supports external account bindings to enforce authentication; several CAs use this to ensure a customer has a paid account: https://tools.ietf.org/html/rfc8555#section-7.3.4",
              "user": "mholt",
              "html_url": "https://github.com/hashicorp/vault/issues/8690#issuecomment-658840881"
            }
          ]
        },
        {
          "id": "635759631",
          "node_id": "MDU6SXNzdWU2MzU3NTk2MzE=",
          "number": 9179,
          "html_url": "https://github.com/hashicorp/vault/issues/9179",
          "title": "returning after previous LDAP auth gives a blank page",
          "user": {
            "type": "user",
            "login": "adq"
          },
          "labels": [
            {
              "id": "1492658523",
              "node_id": "MDU6TGFiZWwxNDkyNjU4NTIz",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/bug",
              "name": "bug",
              "color": "ef97a7",
              "description": "",
              "default": true
            },
            {
              "id": "872623767",
              "node_id": "MDU6TGFiZWw4NzI2MjM3Njc=",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/ui",
              "name": "ui",
              "color": "88e56e",
              "description": "",
              "default": false
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": {
            "type": "user",
            "login": "chelshaw"
          },
          "assignees": [
            {
              "type": "user",
              "login": "chelshaw"
            }
          ],
          "comments": 4,
          "created_at": 1591736904000,
          "updated_at": 1594827764000,
          "author_association": "NONE",
          "body": "**Describe the bug**\r\nI logged in with LDAP: all fine.\r\nI returned the next day, and all I see is a blank page from vault.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Login with LDAP\r\n2. Wait a bit\r\n3. Blank page\r\n\r\n**Expected behavior**\r\nNot a blank page.\r\n\r\n**Environment:**\r\n* Vault Server Version (retrieve with `vault status`): 1.4.2\r\n* Vault CLI Version (retrieve with `vault version`): 1.4.2\r\n* Server Operating System/Architecture: Your docker image 1.4.2\r\n\r\nVault server configuration file(s):\r\n\r\n```hcl\r\nstorage \"file\" {\r\n  path = \"/vault/file/\"\r\n}\r\n\r\nlistener \"tcp\" {\r\n  address = \"0.0.0.0:8200\"\r\n  tls_disable = 1\r\n}\r\n\r\nui = true\r\ndefault_lease_ttl = \"168h\"\r\nmax_lease_ttl = \"720h\"\r\n```\r\n\r\n**Additional context**\r\nLooking in chrome debug, I only see some js files being requested over the network: no API calls.\r\n\r\nIn chrome console, I see:\r\n```\r\nvendor-29fe75b1145b75f4a79611c74b4f0a5a.js:2127 Error while processing route: vault.index Cannot read property 'includes' of null TypeError: Cannot read property 'includes' of null\r\n    at https://myvaultserver/ui/assets/vault-41e3c883fe60cc5e9659c9c7bbbd2062.js:2308:15\r\n    at Array.forEach (<anonymous>)\r\n    at n.checkForRootToken (https://myvaultserver/ui/assets/vault-41e3c883fe60cc5e9659c9c7bbbd2062.js:2307:65)\r\n    at n.init (https://myvaultserver/ui/assets/vault-41e3c883fe60cc5e9659c9c7bbbd2062.js:2277:242)\r\n    at n [as init] (https://myvaultserver/ui/assets/vendor-29fe75b1145b75f4a79611c74b4f0a5a.js:2460:9)\r\n    at m (https://myvaultserver/ui/assets/vendor-29fe75b1145b75f4a79611c74b4f0a5a.js:2369:218)\r\n    at Function.e.create (https://myvaultserver/ui/assets/vendor-29fe75b1145b75f4a79611c74b4f0a5a.js:2378:8)\r\n    at e.n.create (https://myvaultserver/ui/assets/vendor-29fe75b1145b75f4a79611c74b4f0a5a.js:881:18)\r\n    at https://myvaultserver/ui/assets/vendor-29fe75b1145b75f4a79611c74b4f0a5a.js:855:76\r\n    at l (https://myvaultserver/ui/assets/vendor-29fe75b1145b75f4a79611c74b4f0a5a.js:861:45)\r\n```\r\n\r\nClicking on that shows: `n.policies.includes(\"root\")` is the failing line.\r\n\r\nIf I look at the cached login details in my chrome browser, I see this:\r\n```\r\n{\r\n   \"backend\" : {\r\n      \"description\" : \"LDAP authentication.\",\r\n      \"displayNamePath\" : \"metadata.username\",\r\n      \"formAttributes\" : [\r\n         \"username\",\r\n         \"password\"\r\n      ],\r\n      \"tokenPath\" : \"client_token\",\r\n      \"type\" : \"ldap\",\r\n      \"typeDisplay\" : \"LDAP\"\r\n   },\r\n   \"displayName\" : \"adq\",\r\n   \"entity_id\" : \"MYENTITY\",\r\n   \"policies\" : null,\r\n   \"renewable\" : true,\r\n   \"token\" : \"MYTOKEN\",\r\n   \"tokenExpirationEpoch\" : 1592165203112,\r\n   \"ttl\" : 604800,\r\n   \"userRootNamespace\" : \"\"\r\n}\r\n```\r\nI notice policies is `null` - could this be the problem?\r\n\r\nMy user doesn't have any direct policies - its all done by groups.\r\n\r\nThis only seems to happen \"after a while\".. if I clear the token and login all is fine again, even if I close browser etc. I will check tomorrow and report back here. My browser's cached login details now has a full policies list: `[\"default\", \"netadmin\", \"testsecrets\"]` rather than null.\r\n\r\n",
          "events": [
            {
              "id": 3430762618,
              "created_at": 1591810789000,
              "event": "labeled",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3430762618",
              "actor": "austingebauer",
              "label": "bug"
            },
            {
              "id": 3430762620,
              "created_at": 1591810789000,
              "event": "labeled",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3430762620",
              "actor": "austingebauer",
              "label": "ui"
            },
            {
              "id": 643746887,
              "created_at": 1592130080000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/643746887",
              "actor": "adq",
              "body": "Hi, I've been unable to replicate this, however at least one other person did see it over here around the same time I did. \r\n\r\nThis is despite me waiting multiple days and then waiting to use the vault GUI. I also tried messing with the TTLs to see if I could trigger it sooner. Nope.\r\n\r\nI wonder if its something caused when we set it up: we're using LDAP auth and had some faff to get LDAP groups working properly. Its now all ok though.\r\n\r\nObviously it does happen, and the current failure mode is that the UI completely fails (is totally blank). I would suggest having a global try {} catch {} (or equivalent) so that it can be caught and at least give the user an option to clear + fix it.\r\n",
              "user": "adq",
              "html_url": "https://github.com/hashicorp/vault/issues/9179#issuecomment-643746887"
            },
            {
              "id": 643753510,
              "created_at": 1592134047000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/643753510",
              "actor": "adq",
              "body": "Hi, literally an hour since I submitted the previous comment, it happened again. Unfortunately I was not watching my browser logs to see the start of the problem.\r\n\r\nWe have not changed the config on our server or anything in the last hour.\r\n\r\nI manually edited the local credentials document in my browser's Local Storage, so that policies is now an array [] - GUI works again, and I can access everything as normal. This has **not** been auto-updated to contain the actual list of policies I have access to.\r\n\r\nWhat causes the policies array to be updated on the browser? If anyone can suggest anything I can try it out.\r\n",
              "user": "adq",
              "html_url": "https://github.com/hashicorp/vault/issues/9179#issuecomment-643753510"
            },
            {
              "created_at": 1594664918000,
              "event": "cross-referenced",
              "actor": "chelshaw",
              "source": {
                "type": "issue",
                "issue": {
                  "url": "https://api.github.com/repos/hashicorp/vault/issues/9467",
                  "repository_url": "https://api.github.com/repos/hashicorp/vault",
                  "labels_url": "https://api.github.com/repos/hashicorp/vault/issues/9467/labels{/name}",
                  "comments_url": "https://api.github.com/repos/hashicorp/vault/issues/9467/comments",
                  "events_url": "https://api.github.com/repos/hashicorp/vault/issues/9467/events",
                  "html_url": "https://github.com/hashicorp/vault/pull/9467",
                  "id": 656052451,
                  "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ4NDE4ODcx",
                  "number": 9467,
                  "title": "Add truthy check for data.policies before calling 'includes' on it",
                  "user": {
                    "login": "chelshaw",
                    "id": 16182107,
                    "node_id": "MDQ6VXNlcjE2MTgyMTA3",
                    "avatar_url": "https://avatars3.githubusercontent.com/u/16182107?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/chelshaw",
                    "html_url": "https://github.com/chelshaw",
                    "followers_url": "https://api.github.com/users/chelshaw/followers",
                    "following_url": "https://api.github.com/users/chelshaw/following{/other_user}",
                    "gists_url": "https://api.github.com/users/chelshaw/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/chelshaw/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/chelshaw/subscriptions",
                    "organizations_url": "https://api.github.com/users/chelshaw/orgs",
                    "repos_url": "https://api.github.com/users/chelshaw/repos",
                    "events_url": "https://api.github.com/users/chelshaw/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/chelshaw/received_events",
                    "type": "User",
                    "site_admin": false
                  },
                  "labels": [
                    {
                      "id": 965254381,
                      "node_id": "MDU6TGFiZWw5NjUyNTQzODE=",
                      "url": "https://api.github.com/repos/hashicorp/vault/labels/backport",
                      "name": "backport",
                      "color": "ed8496",
                      "default": false,
                      "description": ""
                    },
                    {
                      "id": 872623767,
                      "node_id": "MDU6TGFiZWw4NzI2MjM3Njc=",
                      "url": "https://api.github.com/repos/hashicorp/vault/labels/ui",
                      "name": "ui",
                      "color": "88e56e",
                      "default": false,
                      "description": ""
                    }
                  ],
                  "state": "closed",
                  "locked": false,
                  "assignees": [],
                  "comments": 0,
                  "created_at": "2020-07-13T18:28:38Z",
                  "updated_at": "2020-07-13T20:14:55Z",
                  "closed_at": "2020-07-13T20:07:26Z",
                  "author_association": "CONTRIBUTOR",
                  "repository": {
                    "id": 31288958,
                    "node_id": "MDEwOlJlcG9zaXRvcnkzMTI4ODk1OA==",
                    "name": "vault",
                    "full_name": "hashicorp/vault",
                    "private": false,
                    "owner": {
                      "login": "hashicorp",
                      "id": 761456,
                      "node_id": "MDEyOk9yZ2FuaXphdGlvbjc2MTQ1Ng==",
                      "avatar_url": "https://avatars2.githubusercontent.com/u/761456?v=4",
                      "gravatar_id": "",
                      "url": "https://api.github.com/users/hashicorp",
                      "html_url": "https://github.com/hashicorp",
                      "followers_url": "https://api.github.com/users/hashicorp/followers",
                      "following_url": "https://api.github.com/users/hashicorp/following{/other_user}",
                      "gists_url": "https://api.github.com/users/hashicorp/gists{/gist_id}",
                      "starred_url": "https://api.github.com/users/hashicorp/starred{/owner}{/repo}",
                      "subscriptions_url": "https://api.github.com/users/hashicorp/subscriptions",
                      "organizations_url": "https://api.github.com/users/hashicorp/orgs",
                      "repos_url": "https://api.github.com/users/hashicorp/repos",
                      "events_url": "https://api.github.com/users/hashicorp/events{/privacy}",
                      "received_events_url": "https://api.github.com/users/hashicorp/received_events",
                      "type": "Organization",
                      "site_admin": false
                    },
                    "html_url": "https://github.com/hashicorp/vault",
                    "description": "A tool for secrets management, encryption as a service, and privileged access management",
                    "fork": false,
                    "url": "https://api.github.com/repos/hashicorp/vault",
                    "forks_url": "https://api.github.com/repos/hashicorp/vault/forks",
                    "keys_url": "https://api.github.com/repos/hashicorp/vault/keys{/key_id}",
                    "collaborators_url": "https://api.github.com/repos/hashicorp/vault/collaborators{/collaborator}",
                    "teams_url": "https://api.github.com/repos/hashicorp/vault/teams",
                    "hooks_url": "https://api.github.com/repos/hashicorp/vault/hooks",
                    "issue_events_url": "https://api.github.com/repos/hashicorp/vault/issues/events{/number}",
                    "events_url": "https://api.github.com/repos/hashicorp/vault/events",
                    "assignees_url": "https://api.github.com/repos/hashicorp/vault/assignees{/user}",
                    "branches_url": "https://api.github.com/repos/hashicorp/vault/branches{/branch}",
                    "tags_url": "https://api.github.com/repos/hashicorp/vault/tags",
                    "blobs_url": "https://api.github.com/repos/hashicorp/vault/git/blobs{/sha}",
                    "git_tags_url": "https://api.github.com/repos/hashicorp/vault/git/tags{/sha}",
                    "git_refs_url": "https://api.github.com/repos/hashicorp/vault/git/refs{/sha}",
                    "trees_url": "https://api.github.com/repos/hashicorp/vault/git/trees{/sha}",
                    "statuses_url": "https://api.github.com/repos/hashicorp/vault/statuses/{sha}",
                    "languages_url": "https://api.github.com/repos/hashicorp/vault/languages",
                    "stargazers_url": "https://api.github.com/repos/hashicorp/vault/stargazers",
                    "contributors_url": "https://api.github.com/repos/hashicorp/vault/contributors",
                    "subscribers_url": "https://api.github.com/repos/hashicorp/vault/subscribers",
                    "subscription_url": "https://api.github.com/repos/hashicorp/vault/subscription",
                    "commits_url": "https://api.github.com/repos/hashicorp/vault/commits{/sha}",
                    "git_commits_url": "https://api.github.com/repos/hashicorp/vault/git/commits{/sha}",
                    "comments_url": "https://api.github.com/repos/hashicorp/vault/comments{/number}",
                    "issue_comment_url": "https://api.github.com/repos/hashicorp/vault/issues/comments{/number}",
                    "contents_url": "https://api.github.com/repos/hashicorp/vault/contents/{+path}",
                    "compare_url": "https://api.github.com/repos/hashicorp/vault/compare/{base}...{head}",
                    "merges_url": "https://api.github.com/repos/hashicorp/vault/merges",
                    "archive_url": "https://api.github.com/repos/hashicorp/vault/{archive_format}{/ref}",
                    "downloads_url": "https://api.github.com/repos/hashicorp/vault/downloads",
                    "issues_url": "https://api.github.com/repos/hashicorp/vault/issues{/number}",
                    "pulls_url": "https://api.github.com/repos/hashicorp/vault/pulls{/number}",
                    "milestones_url": "https://api.github.com/repos/hashicorp/vault/milestones{/number}",
                    "notifications_url": "https://api.github.com/repos/hashicorp/vault/notifications{?since,all,participating}",
                    "labels_url": "https://api.github.com/repos/hashicorp/vault/labels{/name}",
                    "releases_url": "https://api.github.com/repos/hashicorp/vault/releases{/id}",
                    "deployments_url": "https://api.github.com/repos/hashicorp/vault/deployments",
                    "created_at": "2015-02-25T00:15:59Z",
                    "updated_at": "2020-07-17T20:30:27Z",
                    "pushed_at": "2020-07-17T20:57:34Z",
                    "git_url": "git://github.com/hashicorp/vault.git",
                    "ssh_url": "git@github.com:hashicorp/vault.git",
                    "clone_url": "https://github.com/hashicorp/vault.git",
                    "svn_url": "https://github.com/hashicorp/vault",
                    "homepage": "https://www.vaultproject.io/",
                    "size": 123698,
                    "stargazers_count": 16436,
                    "watchers_count": 16436,
                    "language": "Go",
                    "has_issues": true,
                    "has_projects": false,
                    "has_downloads": true,
                    "has_wiki": false,
                    "has_pages": false,
                    "forks_count": 2534,
                    "archived": false,
                    "disabled": false,
                    "open_issues_count": 708,
                    "license": {
                      "key": "mpl-2.0",
                      "name": "Mozilla Public License 2.0",
                      "spdx_id": "MPL-2.0",
                      "url": "https://api.github.com/licenses/mpl-2.0",
                      "node_id": "MDc6TGljZW5zZTE0"
                    },
                    "forks": 2534,
                    "open_issues": 708,
                    "watchers": 16436,
                    "default_branch": "master"
                  },
                  "pull_request": {
                    "url": "https://api.github.com/repos/hashicorp/vault/pulls/9467",
                    "html_url": "https://github.com/hashicorp/vault/pull/9467",
                    "diff_url": "https://github.com/hashicorp/vault/pull/9467.diff",
                    "patch_url": "https://github.com/hashicorp/vault/pull/9467.patch"
                  },
                  "body": "This _should_ fix issue #9179 but unfortunately I haven't been able to replicate the same behavior, before or after the fix. \r\n\r\nShould be backported to the next 1.4.x release. Still looking into what could be causing the root issue (`policies` is saved as null) and open to other ways this could be addressed"
                }
              }
            },
            {
              "id": 3544552556,
              "created_at": 1594738494000,
              "event": "assigned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3544552556",
              "actor": "chelshaw",
              "assignee": "chelshaw"
            },
            {
              "id": 658234147,
              "created_at": 1594739134000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/658234147",
              "actor": "chelshaw",
              "body": "Hello and thank you for the thorough details on this bug report. Unfortunately I've been unable to replicate the behavior you describe, but we're going to go ahead and push a change that should catch a null `policies` value and at the very least not show a blank page. \r\n\r\nI notice you're currently on 1.4.2, are you looking for a minor release or are you and your team open to upgrading to the next major version (1.5.0) when it is released?",
              "user": "chelshaw",
              "html_url": "https://github.com/hashicorp/vault/issues/9179#issuecomment-658234147"
            },
            {
              "id": 658842654,
              "created_at": 1594827763000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/658842654",
              "actor": "chelshaw",
              "body": "@adq I realized I forgot to tag you so you may have missed my message yesterday. Any thoughts on versions you're comfortable upgrading to? ",
              "user": "chelshaw",
              "html_url": "https://github.com/hashicorp/vault/issues/9179#issuecomment-658842654"
            },
            {
              "id": 3549209670,
              "created_at": 1594829372000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3549209670",
              "actor": "adq"
            },
            {
              "id": 3549209674,
              "created_at": 1594829372000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3549209674",
              "actor": "adq"
            }
          ]
        },
        {
          "id": "342522477",
          "node_id": "MDU6SXNzdWUzNDI1MjI0Nzc=",
          "number": 4950,
          "html_url": "https://github.com/hashicorp/vault/issues/4950",
          "title": "Feature Request: Support Let's Encrypt secret engine",
          "user": {
            "type": "user",
            "login": "tamalsaha"
          },
          "labels": [
            {
              "id": "1658694629",
              "node_id": "MDU6TGFiZWwxNjU4Njk0NjI5",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/core/secret",
              "name": "core/secret",
              "color": "0000ff",
              "description": "",
              "default": false
            },
            {
              "id": "1658842398",
              "node_id": "MDU6TGFiZWwxNjU4ODQyMzk4",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/feature-request",
              "name": "feature-request",
              "color": "2a7eba",
              "description": "",
              "default": false
            }
          ],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 31,
          "created_at": 1531955295000,
          "updated_at": 1594828038000,
          "author_association": "NONE",
          "body": "We would like to be able to issue ssl certificates from Let's Encrypt using Vault and auto refresh then when certs are about to expire. Do you think Vault can support this as a secret engine?\r\n\r\nWe will be interested in contributing this feature if acceptable.",
          "events": [
            {
              "id": 406267016,
              "created_at": 1532005072000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/406267016",
              "actor": "jefferai",
              "body": "How exactly would this work? What will Vault use to authorize all of the different names to LE?",
              "user": "jefferai",
              "html_url": "https://github.com/hashicorp/vault/issues/4950#issuecomment-406267016"
            },
            {
              "id": 406318320,
              "created_at": 1532014270000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/406318320",
              "actor": "tamalsaha",
              "body": "@jefferai, for DNS challenges Vault can do all the parts. This is also required for issuing wild card certificates. User provides the domain names and the DNS provider (Route53, etc) credential. Vault setups the TXT record needed to pass domain validation. \r\n\r\nFor HTTP challenge, I am not sure. The domain validation happens via responding to a well-known path .  Vault could potentially expose this path and user's have to manually setup their LB (nginx/haproxy) to expose under their domains . If user is running in Kubernetes, they have to just configure their `Ingress` object to pass well known paths to Vault.\r\n\r\nWe are using https://github.com/xenolf/lego project as a library in our [Voyager](https://github.com/appscode/voyager) . We struggled with dealing with LE's rate limiting. But I think we have a good handle on it now. \r\n\r\nMy general motivation is to make Vault the center piece for secret management for Kubernetes (not official project). We have written an [operator](https://github.com/kubevault), making Vault as [db secret manager](https://github.com/kubedb/user-manager), looking into adding a [CSI driver](https://github.com/kubernetes/kubernetes/issues/66362) and handle TLS secrets. Kubernetes has a crazy maze of mTLS. I feel life will be easier for ops folks if there was a central place to deal with TLS stuff.\r\n\r\n\r\n\r\n\r\n\r\n",
              "user": "tamalsaha",
              "html_url": "https://github.com/hashicorp/vault/issues/4950#issuecomment-406318320"
            },
            {
              "id": 1742872174,
              "created_at": 1532014270000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/1742872174",
              "actor": "jefferai"
            },
            {
              "id": 1742872177,
              "created_at": 1532014270000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/1742872177",
              "actor": "jefferai"
            },
            {
              "id": 408591724,
              "created_at": 1532766012000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/408591724",
              "actor": "munnerz",
              "body": "I am not a Vault expert, but from what I understand, no other secret backend has to deal with a similar type of authorisation in order to issue secrets.\r\n\r\nAs you've already noted @tamalsaha, it can be difficult to deal with rate limits properly & the wide variety of HTTP servers, and even differing APIs and authentication mechanisms involved with ACME can quickly become very complex.\r\n\r\nFrom what I understand, vault tries to keep this kind of code, either listening for unauthenticated connections or calling out to many different types of APIs to a minimum, given the sensitivity of data stored in Vault. Solving HTTP at least would involve exposing Vault on the public internet (for LE/public acme servers)\r\n\r\nBeyond that, I think waiting until the ACME draft spec has stabilised would be wise - there are currently still a number of divergences between Let's Encrypt and the ACME spec (these are gradually going away!) which could cause quite a lot of backwards compatibility pain.\r\n\r\n> My general motivation is to make Vault the center piece for secret management for Kubernetes (not official project) .... \r\n> I feel life will be easier for ops folks if there was a central place to deal with TLS stuff.\r\n\r\nRegarding kubernetes specifically, and a shameless self plug, but that is one of the main drivers/goals for cert-manager, albeit we don't have a well defined charter that notes this anywhere  although we don't yet have a CSI plugin or flex volume plugin.",
              "user": "munnerz",
              "html_url": "https://github.com/hashicorp/vault/issues/4950#issuecomment-408591724"
            },
            {
              "id": 1758458867,
              "created_at": 1532766012000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/1758458867",
              "actor": "tamalsaha"
            },
            {
              "id": 1758458868,
              "created_at": 1532766012000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/1758458868",
              "actor": "tamalsaha"
            },
            {
              "id": 408599820,
              "created_at": 1532776009000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/408599820",
              "actor": "jefferai",
              "body": "All well said, @munnerz . We generally take the approach of making Vault a one stop shop for secrets needs within your Intranet, and as such what we often find are people using Vault for easy deployment of certificates to apps and machines communicating with each other and LE for anything on the edge. It's a reasonable model given the different goals of the product.\r\n\r\nFWIW we have many endeavors going on to make it easier to use Vault when on Kubernetes. The automatic authentication provided by Vault Agent that was just released is a step towards that. We plan to eventually have a sidecar and/or CSI container mixing Vault and Consul-Template to make it easy to do the rest.",
              "user": "jefferai",
              "html_url": "https://github.com/hashicorp/vault/issues/4950#issuecomment-408599820"
            },
            {
              "id": 1758501586,
              "created_at": 1532776009000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/1758501586",
              "actor": "munnerz"
            },
            {
              "id": 1758501587,
              "created_at": 1532776009000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/1758501587",
              "actor": "munnerz"
            },
            {
              "id": 409077764,
              "created_at": 1533005753000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/409077764",
              "actor": "tamalsaha",
              "body": "@jefferai , Does this mean that LE based certificate issuing should be outside the scope of Vault ?\r\n\r\nRegarding `We plan to eventually have a sidecar and/or CSI container mixing Vault and Consul-Template to make it easy to do the rest.` Do you have any issue that we can follow? We have been interested in that too https://github.com/kubernetes/kubernetes/issues/66362 . If Vault project wants to do this, we can wait :) .",
              "user": "tamalsaha",
              "html_url": "https://github.com/hashicorp/vault/issues/4950#issuecomment-409077764"
            },
            {
              "id": 1761685211,
              "created_at": 1533005753000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/1761685211",
              "actor": "jefferai"
            },
            {
              "id": 1761685212,
              "created_at": 1533005753000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/1761685212",
              "actor": "jefferai"
            },
            {
              "id": 409081661,
              "created_at": 1533007307000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/409081661",
              "actor": "jefferai",
              "body": "@tamalsaha They're really quite different paradigms. I don't know the ACME spec well enough to know whether it's feasible at all in Vault, but we generally have viewed Vault's PKI capability and LE as complementary, rather than replacements for each other. Vault is significantly more flexible but not really suited for issuing publicly-trusted certs, and vice versa.\r\n\r\nRe an init/sidecar/CSI container, there's no issue to follow. All I can tell you right now is that it will happen, but I can't give any concrete timeline. The release of Vault Agent was a step made very specifically in that direction, however (as well as other directions, of course) as it's a key component of any such solution.",
              "user": "jefferai",
              "html_url": "https://github.com/hashicorp/vault/issues/4950#issuecomment-409081661"
            },
            {
              "id": 1761708161,
              "created_at": 1533007307000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/1761708161",
              "actor": "tamalsaha"
            },
            {
              "id": 1761708162,
              "created_at": 1533007307000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/1761708162",
              "actor": "tamalsaha"
            },
            {
              "id": 409082234,
              "created_at": 1533007548000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/409082234",
              "actor": "jefferai",
              "body": "To clarify: an init/sidecar container is definitely on our roadmap. CSI is something we'd like to support but as you are probably aware from https://github.com/kubernetes/kubernetes/issues/64984 there are still gaps.",
              "user": "jefferai",
              "html_url": "https://github.com/hashicorp/vault/issues/4950#issuecomment-409082234"
            },
            {
              "id": 409225784,
              "created_at": 1533044661000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/409225784",
              "actor": "tamalsaha",
              "body": "Thanks @jefferai. If there is any way we can contribute, we will be interested.",
              "user": "tamalsaha",
              "html_url": "https://github.com/hashicorp/vault/issues/4950#issuecomment-409225784"
            },
            {
              "id": 1762752082,
              "created_at": 1533044661000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/1762752082",
              "actor": "jefferai"
            },
            {
              "id": 1762752085,
              "created_at": 1533044661000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/1762752085",
              "actor": "jefferai"
            },
            {
              "id": 534137978,
              "created_at": 1569250743000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/534137978",
              "actor": "remilapeyre",
              "body": "Hi, I'm having the same issue as the author, we would like to use Vault to distribute Let's Encrypt signed certificates to our services. Using Vault's PKI engine means we would need to distribute the root CA to all our users which would be OK for our servers but is pretty inconvenient and difficult to do securely for our users.\r\n\r\nWhile we could use certbot, this would mean we would have to give the API key to our DNS provider to every service that need a TLS cert but as CloudFlare (and many others) does not support granular permissions we would like to avoid that.\r\n\r\nWe are currently using https://www.terraform.io/docs/providers/acme/index.html which solves the signing part but not how to distribute the cert to the service nor how to renew them.\r\n\r\nIt seems to me that making Vault use the DNS Acme challenge would be great for this, it should be easy enough as most of the work has already be done in lego and the Acme terraform provider.\r\n\r\nI don't think implementing the HTTP challenge would be a great idea, in most of the deployment Vault is not accessible from the Internet, does not listen to 80/443 and this would require cooperation from the load-balancers which would make the configuration complex.\r\n\r\nIf this seems good to you, I will start working on an implementation for this.",
              "user": "remilapeyre",
              "html_url": "https://github.com/hashicorp/vault/issues/4950#issuecomment-534137978"
            },
            {
              "id": 534138265,
              "created_at": 1569250782000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/534138265",
              "actor": "remilapeyre",
              "body": "BTW https://github.com/hashicorp/vault/issues/4362 is related to this and has 46  ",
              "user": "remilapeyre",
              "html_url": "https://github.com/hashicorp/vault/issues/4950#issuecomment-534138265"
            },
            {
              "created_at": 1569250855000,
              "event": "cross-referenced",
              "actor": "remilapeyre",
              "source": {
                "type": "issue",
                "issue": {
                  "url": "https://api.github.com/repos/hashicorp/vault/issues/4362",
                  "repository_url": "https://api.github.com/repos/hashicorp/vault",
                  "labels_url": "https://api.github.com/repos/hashicorp/vault/issues/4362/labels{/name}",
                  "comments_url": "https://api.github.com/repos/hashicorp/vault/issues/4362/comments",
                  "events_url": "https://api.github.com/repos/hashicorp/vault/issues/4362/events",
                  "html_url": "https://github.com/hashicorp/vault/issues/4362",
                  "id": 314410943,
                  "node_id": "MDU6SXNzdWUzMTQ0MTA5NDM=",
                  "number": 4362,
                  "title": "Feature Requst: acme client support",
                  "user": {
                    "login": "jdelic",
                    "id": 1956349,
                    "node_id": "MDQ6VXNlcjE5NTYzNDk=",
                    "avatar_url": "https://avatars3.githubusercontent.com/u/1956349?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/jdelic",
                    "html_url": "https://github.com/jdelic",
                    "followers_url": "https://api.github.com/users/jdelic/followers",
                    "following_url": "https://api.github.com/users/jdelic/following{/other_user}",
                    "gists_url": "https://api.github.com/users/jdelic/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/jdelic/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/jdelic/subscriptions",
                    "organizations_url": "https://api.github.com/users/jdelic/orgs",
                    "repos_url": "https://api.github.com/users/jdelic/repos",
                    "events_url": "https://api.github.com/users/jdelic/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/jdelic/received_events",
                    "type": "User",
                    "site_admin": false
                  },
                  "labels": [
                    {
                      "id": 1467741097,
                      "node_id": "MDU6TGFiZWwxNDY3NzQxMDk3",
                      "url": "https://api.github.com/repos/hashicorp/vault/labels/ecosystem",
                      "name": "ecosystem",
                      "color": "f2bc59",
                      "default": false,
                      "description": ""
                    },
                    {
                      "id": 1658842398,
                      "node_id": "MDU6TGFiZWwxNjU4ODQyMzk4",
                      "url": "https://api.github.com/repos/hashicorp/vault/labels/feature-request",
                      "name": "feature-request",
                      "color": "2a7eba",
                      "default": false,
                      "description": ""
                    }
                  ],
                  "state": "open",
                  "locked": false,
                  "assignees": [],
                  "comments": 2,
                  "created_at": "2018-04-15T12:21:45Z",
                  "updated_at": "2019-11-08T16:49:57Z",
                  "author_association": "NONE",
                  "repository": {
                    "id": 31288958,
                    "node_id": "MDEwOlJlcG9zaXRvcnkzMTI4ODk1OA==",
                    "name": "vault",
                    "full_name": "hashicorp/vault",
                    "private": false,
                    "owner": {
                      "login": "hashicorp",
                      "id": 761456,
                      "node_id": "MDEyOk9yZ2FuaXphdGlvbjc2MTQ1Ng==",
                      "avatar_url": "https://avatars2.githubusercontent.com/u/761456?v=4",
                      "gravatar_id": "",
                      "url": "https://api.github.com/users/hashicorp",
                      "html_url": "https://github.com/hashicorp",
                      "followers_url": "https://api.github.com/users/hashicorp/followers",
                      "following_url": "https://api.github.com/users/hashicorp/following{/other_user}",
                      "gists_url": "https://api.github.com/users/hashicorp/gists{/gist_id}",
                      "starred_url": "https://api.github.com/users/hashicorp/starred{/owner}{/repo}",
                      "subscriptions_url": "https://api.github.com/users/hashicorp/subscriptions",
                      "organizations_url": "https://api.github.com/users/hashicorp/orgs",
                      "repos_url": "https://api.github.com/users/hashicorp/repos",
                      "events_url": "https://api.github.com/users/hashicorp/events{/privacy}",
                      "received_events_url": "https://api.github.com/users/hashicorp/received_events",
                      "type": "Organization",
                      "site_admin": false
                    },
                    "html_url": "https://github.com/hashicorp/vault",
                    "description": "A tool for secrets management, encryption as a service, and privileged access management",
                    "fork": false,
                    "url": "https://api.github.com/repos/hashicorp/vault",
                    "forks_url": "https://api.github.com/repos/hashicorp/vault/forks",
                    "keys_url": "https://api.github.com/repos/hashicorp/vault/keys{/key_id}",
                    "collaborators_url": "https://api.github.com/repos/hashicorp/vault/collaborators{/collaborator}",
                    "teams_url": "https://api.github.com/repos/hashicorp/vault/teams",
                    "hooks_url": "https://api.github.com/repos/hashicorp/vault/hooks",
                    "issue_events_url": "https://api.github.com/repos/hashicorp/vault/issues/events{/number}",
                    "events_url": "https://api.github.com/repos/hashicorp/vault/events",
                    "assignees_url": "https://api.github.com/repos/hashicorp/vault/assignees{/user}",
                    "branches_url": "https://api.github.com/repos/hashicorp/vault/branches{/branch}",
                    "tags_url": "https://api.github.com/repos/hashicorp/vault/tags",
                    "blobs_url": "https://api.github.com/repos/hashicorp/vault/git/blobs{/sha}",
                    "git_tags_url": "https://api.github.com/repos/hashicorp/vault/git/tags{/sha}",
                    "git_refs_url": "https://api.github.com/repos/hashicorp/vault/git/refs{/sha}",
                    "trees_url": "https://api.github.com/repos/hashicorp/vault/git/trees{/sha}",
                    "statuses_url": "https://api.github.com/repos/hashicorp/vault/statuses/{sha}",
                    "languages_url": "https://api.github.com/repos/hashicorp/vault/languages",
                    "stargazers_url": "https://api.github.com/repos/hashicorp/vault/stargazers",
                    "contributors_url": "https://api.github.com/repos/hashicorp/vault/contributors",
                    "subscribers_url": "https://api.github.com/repos/hashicorp/vault/subscribers",
                    "subscription_url": "https://api.github.com/repos/hashicorp/vault/subscription",
                    "commits_url": "https://api.github.com/repos/hashicorp/vault/commits{/sha}",
                    "git_commits_url": "https://api.github.com/repos/hashicorp/vault/git/commits{/sha}",
                    "comments_url": "https://api.github.com/repos/hashicorp/vault/comments{/number}",
                    "issue_comment_url": "https://api.github.com/repos/hashicorp/vault/issues/comments{/number}",
                    "contents_url": "https://api.github.com/repos/hashicorp/vault/contents/{+path}",
                    "compare_url": "https://api.github.com/repos/hashicorp/vault/compare/{base}...{head}",
                    "merges_url": "https://api.github.com/repos/hashicorp/vault/merges",
                    "archive_url": "https://api.github.com/repos/hashicorp/vault/{archive_format}{/ref}",
                    "downloads_url": "https://api.github.com/repos/hashicorp/vault/downloads",
                    "issues_url": "https://api.github.com/repos/hashicorp/vault/issues{/number}",
                    "pulls_url": "https://api.github.com/repos/hashicorp/vault/pulls{/number}",
                    "milestones_url": "https://api.github.com/repos/hashicorp/vault/milestones{/number}",
                    "notifications_url": "https://api.github.com/repos/hashicorp/vault/notifications{?since,all,participating}",
                    "labels_url": "https://api.github.com/repos/hashicorp/vault/labels{/name}",
                    "releases_url": "https://api.github.com/repos/hashicorp/vault/releases{/id}",
                    "deployments_url": "https://api.github.com/repos/hashicorp/vault/deployments",
                    "created_at": "2015-02-25T00:15:59Z",
                    "updated_at": "2020-07-17T20:30:27Z",
                    "pushed_at": "2020-07-17T20:57:34Z",
                    "git_url": "git://github.com/hashicorp/vault.git",
                    "ssh_url": "git@github.com:hashicorp/vault.git",
                    "clone_url": "https://github.com/hashicorp/vault.git",
                    "svn_url": "https://github.com/hashicorp/vault",
                    "homepage": "https://www.vaultproject.io/",
                    "size": 123698,
                    "stargazers_count": 16436,
                    "watchers_count": 16436,
                    "language": "Go",
                    "has_issues": true,
                    "has_projects": false,
                    "has_downloads": true,
                    "has_wiki": false,
                    "has_pages": false,
                    "forks_count": 2534,
                    "archived": false,
                    "disabled": false,
                    "open_issues_count": 708,
                    "license": {
                      "key": "mpl-2.0",
                      "name": "Mozilla Public License 2.0",
                      "spdx_id": "MPL-2.0",
                      "url": "https://api.github.com/licenses/mpl-2.0",
                      "node_id": "MDc6TGljZW5zZTE0"
                    },
                    "forks": 2534,
                    "open_issues": 708,
                    "watchers": 16436,
                    "default_branch": "master"
                  },
                  "body": "Feature Request: acme client/challenge support\r\n=================================\r\n\r\nA server implementation of the acme protocol was previously discussed in 2015 in #668. This is not that. :)\r\n\r\nThe problem space\r\n---------------------------\r\n\r\nWe deploy Vault for secret management. Many of our non-customer-facing systems use certificates issued through LetsEncrypt, which delivers a convenient certificate that can still be validated by common public CAs. What annoys me is that `certbot` and other available acme implementations require us to tunnel `http` challenges or set up credentials for production systems to access DNS APIs to process `dns` challenges. Even acme implementations that run inside of server software (like lua-based plugins for haproxy), result in the suboptimal situation that the retained certificate must be distributed through the cluster or every endpoint needs to request its own certificate.\r\n\r\nAn idea\r\n-----------\r\n\r\nWhile discussing a solution based around the consul kv store and consul-template, I realized that it would be so much nicer to do the following:\r\n\r\n* Have Vault generate the certificate private key and CSR\r\n* Create the challenge and communicate with an acme endpoint when triggered through an API\r\n* Have the CA (LetsEncrypt) talk to a public endpoint that is tunneled through a vault instance (i.e. Vault directly handles the `.well-known/acme-challenge/` request and response)\r\n* Have Vault receive, validate and store the certificate from the CA\r\n* Vault would also schedule and handle certificate renewal\r\n* Clients inside the network can use `consul-template` and `nomad` and the Vault API to receive the certificate, private key and certificate chain as needed\r\n\r\nVault ACLs, tokens and response wrapping could then be used to their full effect. It would be a beautiful solution in my opinion."
                }
              }
            },
            {
              "id": 542895032,
              "created_at": 1571260558000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/542895032",
              "actor": "mholt",
              "body": "May I recommend using [CertMagic](https://github.com/mholt/certmagic) for this?\r\n\r\nIt's the same well-vetted library used by the [Caddy Web Server](https://caddyserver.com), and it is the most mature ACME client implementation in Go that is available.\r\n\r\nIt also supports pluggable storage, so you could have CertMagic store certificates directly in Vault.\r\n\r\nIt also coordinates certificate management in a cluster, as long as all instances in the cluster use the same storage configuration (i.e. a Vault instance).\r\n\r\nYou could also side-car Caddy if you prefer an external solution, but I'd strongly recommend bundling it directly into the application as a library whenever possible.",
              "user": "mholt",
              "html_url": "https://github.com/hashicorp/vault/issues/4950#issuecomment-542895032"
            },
            {
              "id": 544560913,
              "created_at": 1571670738000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/544560913",
              "actor": "p3lim",
              "body": "I'm currently developing a secrets plugin for Vault using [lego](https://github.com/go-acme/lego). In my brief overview of certmagic I found that the pluggable storage adds unnecessary complexity to the logic. It seems more targeted at web developers, just wrapping the logic of lego (no offense intended, it looks like a great project, just not suited for this in my opinion).\r\n\r\nI'm currently writing tests for the plugin, the basic functionality (register, obtain, renew and revoke) is in. It only supports dns-01 right now, and I'm unsure about supporting other challenges (like http-01 and tls-alpn-01) due to the fact that you'd have to expose the server running Vault.",
              "user": "p3lim",
              "html_url": "https://github.com/hashicorp/vault/issues/4950#issuecomment-544560913"
            },
            {
              "id": 544562939,
              "created_at": 1571670998000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/544562939",
              "actor": "mholt",
              "body": "@p3lim Lego is a raw ACME client library -- it simply facilitates the ACME protocol for you. It has methods like `Register()` and `Obtain()`. The difference is that CertMagic is all about keeping certificates renewed in the long run: while your server/process is running, ensure certificates stay renewed and that your TLS config can always serve the current certificates, without downtime.\r\n\r\nSo for anything long-running (and not a once-and-done command, for instance), use CertMagic.\r\n\r\n> In my brief overview of certmagic I found that the pluggable storage adds unnecessary complexity to the logic. \r\n\r\nCan you explain what you mean? CertMagic's storage interface basically just requires Load, Store, List, Delete, and Lock/Unlock.",
              "user": "mholt",
              "html_url": "https://github.com/hashicorp/vault/issues/4950#issuecomment-544562939"
            },
            {
              "id": 2730089844,
              "created_at": 1571670998000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/2730089844",
              "actor": "p3lim"
            },
            {
              "id": 2730089848,
              "created_at": 1571670998000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/2730089848",
              "actor": "p3lim"
            },
            {
              "id": 546641988,
              "created_at": 1572126204000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/546641988",
              "actor": "remilapeyre",
              "body": "Hi everybody, I published my current implementation for this at https://github.com/remilapeyre/vault-acme.\r\n\r\nIt does most of what was asked for in this thread and we've been using it for some days and it seems to work fine.\r\n\r\nRegarding CertMagic, I'm not sure I see what it may add to Lego that we need. One thing I needed from Lego that is not implemented is the ability to update an ACME account but I should be able to contribute that during next week. Lego is also the library used by the Terraform ACME provider and it may make maintenance easier to share the same library in Terraform and Vault\r\n\r\nA few notes regarding the current plugin (I'm probably will forget plenty of things and will complete this later):\r\n\r\n- Contrary to the other secret backends in Vault, the ACME provider may implement arbitrary rate limits, Let's Encrypt document those at https://letsencrypt.org/docs/rate-limits/. This means that we may have to implement some cache for this backend to reduce the CSR sent to the provider, during the development I did hit those limits a few time. This would also help regarding the latency as settings the DNS records, waiting for the DNS propagation, asking the ACME provider to validate them, generating the CSR and sending it to the provider can take some time. During our tests and in our internal deployment it has been can fast though, generally a few seconds.\r\n- I did not implement support `tls-alpn-*` challenges as those where withdrawn from the RFC after some vulnerabilities where found in them.\r\n- I did not implement support for HTTP challenges as this would require to expose Vault to the Internet or have some convoluted way to set an external webserver. If we wish to add support for something like this, I think we may implement a way to use an external program to do this like the [external program](https://go-acme.github.io/lego/dns/exec/) provider does.\r\n\r\nI'm looking forward for feedback regarding this first implementation, let me now if you try it :)",
              "user": "remilapeyre",
              "html_url": "https://github.com/hashicorp/vault/issues/4950#issuecomment-546641988"
            },
            {
              "id": 546644123,
              "created_at": 1572128277000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/546644123",
              "actor": "mholt",
              "body": "@remilapeyre Great, I am looking forward to taking a closer look when I have a chance.\r\n\r\nA few points of initial feedback:\r\n\r\n- I'm glad to see you're using lego at least, that's definitely the best low-level ACME implementation in Go.\r\n\r\n> This means that we may have to implement some cache for this backend to reduce the CSR sent to the provider, during the development I did hit those limits a few time. \r\n\r\n- I'd highly recommend reading this draft of an upcoming document which advises best practices for ACME clients: https://github.com/https-dev/docs/blob/master/acme-ops.md -- it's written in collaboration with Google, Let's Encrypt, the EFF, and some others. It will especially help with regards to rate limits, error handling, and improving uptime.\r\n\r\n> I did not implement support tls-alpn-* challenges as those where withdrawn from the RFC after some vulnerabilities where found in them.\r\n\r\n- I strongly advise you support the TLS-ALPN challenge. It is the only challenge that works over port 443 (the TLS port), and is required if port 80 is not available or if the HTTP challenge has trouble getting a certificate. Lego does not support the TLS-SNI challenge, which is deprecated.\r\n\r\n> I did not implement support for HTTP challenges as this would require to expose Vault to the Internet or have some convoluted way to set an external webserver. \r\n\r\n- You'll have to expose something on port 443 for the TLS-ALPN challenge, too. With either the HTTP or TLS-ALPN challenges, you have to expose your ACME client on port 80 or 443, respectively. The only challenge type that does not require any external access is the DNS challenge, which requires integration with the DNS provider to automatically change zone files (or do it manually).\r\n\r\nIf you have in fact disabled the HTTP and TLS-ALPN challenges, it sounds like the only challenge that is enabled is the DNS challenge (?), which is fine if necessary, but it's also the challenge that requires the most configuration and has the most moving parts. Users should be aware that this DNS integration is required.\r\n\r\nDoes vault-acme automatically renew certificates too? Or does an outside program/user/lib trigger the reload?",
              "user": "mholt",
              "html_url": "https://github.com/hashicorp/vault/issues/4950#issuecomment-546644123"
            },
            {
              "id": 2746324975,
              "created_at": 1572128277000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/2746324975",
              "actor": "remilapeyre"
            },
            {
              "id": 2746324976,
              "created_at": 1572128277000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/2746324976",
              "actor": "remilapeyre"
            },
            {
              "id": 548150268,
              "created_at": 1572476924000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/548150268",
              "actor": "remilapeyre",
              "body": "Thanks @mholt, I will update my secret backend based on your feedbacks.\r\n\r\n> I'd highly recommend reading this draft of an upcoming document which advises best practices for ACME clients: https://github.com/https-dev/docs/blob/master/acme-ops.md\r\n\r\nHere's what will need to be changed to match the recommendations:\r\n\r\n- *Upon obtaining a certificate, immediately write it to persistent storage.*\r\n  Currently each client requesting a certificate for `foo.com` will get a new one. This is the usual behavior for Vault secrets backends and this mean I didn't need to save the certificate.\r\n\r\n- *If a valid certificate already exists in storage, use that one instead of obtaining a new one.*\r\n  Since I didn't save certificates on persistent storage, I could not do this. This is in line with the rest of the secrets engine that give a new secret on each call so their usage can be tracked and they can be revoked separately. Since this new secrets engine uses resources from the ACME provider, it makes sense to change the behavior and have caching. I will add a `disable_cache` attribute on the `acme/roles/:role` resource that defaults to `false` so cache will be enabled by default, and users that want to disable it can do so.\r\n\r\n- *Renew certificates after  of usable lifetime.*\r\n  Currently, the TTL of the lease associated to the certificate is `min(TTL of certificate, max TTL of the backend)`. When the secret is actually renewed depends on the client, for example Consul Template will renew the secret when it reaches 90% of the lease TTL which is more than the 2/3 recommended. To improve this I will add a `cache_duration_ratio` that defaults to 0.7 and make the lease TTL `min(cache_duration_ratio * TTL of certificate, max TTL of the backend)`. This should make clients renew the certificate when it reaches around 2/3 of its lifetime.\r\n\r\n>I strongly advise you support the TLS-ALPN challenge. It is the only challenge that works over port 443 (the TLS port), and is required if port 80 is not available or if the HTTP challenge has trouble getting a certificate.\r\n\r\nI mistook TLS-ALPN for TLS-SNI as I had not seen the RFC that introduced TLS-ALPN.\r\n\r\nVault won't be able to handle those without substantial changes as secrets engine cannot use the `.well-known/acme-challenge/` our set the content-type and the response body. Furthermore it is not recommended for Vault to listen for external traffic.\r\n\r\nI think this could be achieved with a simple sidecar that handles `.well-known/acme-challenge/` and looks in Vault to respond to the challenge. I will write it in the next week.\r\n\r\n> Does vault-acme automatically renew certificates too? Or does an outside program/user/lib trigger the reload?\r\n\r\nVault ACME does not renew certificates before a client asks for it when a lease expires. All secrets given by Vault have an associated lease though so they should already know to get a new secret when the current one expires.",
              "user": "remilapeyre",
              "html_url": "https://github.com/hashicorp/vault/issues/4950#issuecomment-548150268"
            },
            {
              "id": 2757943666,
              "created_at": 1572476924000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/2757943666",
              "actor": "mholt"
            },
            {
              "id": 2757943669,
              "created_at": 1572476924000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/2757943669",
              "actor": "mholt"
            },
            {
              "id": 548572221,
              "created_at": 1572556599000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/548572221",
              "actor": "mholt",
              "body": "> Vault ACME does not renew certificates before a client asks for it when a lease expires. All secrets given by Vault have an associated lease though so they should already know to get a new secret when the current one expires.\r\n\r\nI see, so this essentially acts as liaison between Vault clients and an ACME service, establishing 1:1 functions for Obtain() and Renew() (etc).\r\n\r\nIn other words, it is up to the client to take care of certificate management, and this tool only provides the functions to do ACME transactions. (Correct?)\r\n\r\nIf so, then hopefully, whatever clients use this tool will abide the best practices. :)\r\n\r\n> I think this could be achieved with a simple sidecar that handles .well-known/acme-challenge/ and looks in Vault to respond to the challenge. I will write it in the next week.\r\n\r\nAny way that Caddy or CertMagic can help here? Their storage implementation is pluggable, so they could dump the certificates directly into Vault.",
              "user": "mholt",
              "html_url": "https://github.com/hashicorp/vault/issues/4950#issuecomment-548572221"
            },
            {
              "id": 549391900,
              "created_at": 1572879406000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/549391900",
              "actor": "remilapeyre",
              "body": "> In other words, it is up to the client to take care of certificate management, and this tool only provides the functions to do ACME transactions. (Correct?)\r\n\r\nThis is the idea yes.\r\n\r\n> If so, then hopefully, whatever clients use this tool will abide the best practices. :)\r\n\r\nThe Vault operator can still enforce some of those at the server level and I added cache support in https://github.com/remilapeyre/vault-acme/commit/bd9589152a15d2642df8a4573724ccbb97518d3b\r\n\r\n> Any way that Caddy or CertMagic can help here?\r\n\r\nI don't  think so, a huge advantage of having the plugin generate the cert is that it is `mlock`-ed and only speak to Vault through a secure channel with temporary credentials only usable once. We would loose some of the benefits by using Caddy or CertMagic.",
              "user": "remilapeyre",
              "html_url": "https://github.com/hashicorp/vault/issues/4950#issuecomment-549391900"
            },
            {
              "created_at": 1572956778000,
              "event": "cross-referenced",
              "actor": "michelvocks",
              "source": {
                "type": "issue",
                "issue": {
                  "url": "https://api.github.com/repos/hashicorp/vault/issues/7576",
                  "repository_url": "https://api.github.com/repos/hashicorp/vault",
                  "labels_url": "https://api.github.com/repos/hashicorp/vault/issues/7576/labels{/name}",
                  "comments_url": "https://api.github.com/repos/hashicorp/vault/issues/7576/comments",
                  "events_url": "https://api.github.com/repos/hashicorp/vault/issues/7576/events",
                  "html_url": "https://github.com/hashicorp/vault/issues/7576",
                  "id": 502914385,
                  "node_id": "MDU6SXNzdWU1MDI5MTQzODU=",
                  "number": 7576,
                  "title": "How to Publicly-trusted certificates using Hashicorp PKI  and let's encrypt ",
                  "user": {
                    "login": "sithuyeaung",
                    "id": 39179317,
                    "node_id": "MDQ6VXNlcjM5MTc5MzE3",
                    "avatar_url": "https://avatars1.githubusercontent.com/u/39179317?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/sithuyeaung",
                    "html_url": "https://github.com/sithuyeaung",
                    "followers_url": "https://api.github.com/users/sithuyeaung/followers",
                    "following_url": "https://api.github.com/users/sithuyeaung/following{/other_user}",
                    "gists_url": "https://api.github.com/users/sithuyeaung/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/sithuyeaung/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/sithuyeaung/subscriptions",
                    "organizations_url": "https://api.github.com/users/sithuyeaung/orgs",
                    "repos_url": "https://api.github.com/users/sithuyeaung/repos",
                    "events_url": "https://api.github.com/users/sithuyeaung/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/sithuyeaung/received_events",
                    "type": "User",
                    "site_admin": false
                  },
                  "labels": [],
                  "state": "closed",
                  "locked": false,
                  "assignees": [],
                  "comments": 1,
                  "created_at": "2019-10-05T04:27:07Z",
                  "updated_at": "2019-11-05T12:26:19Z",
                  "closed_at": "2019-11-05T12:26:18Z",
                  "author_association": "NONE",
                  "repository": {
                    "id": 31288958,
                    "node_id": "MDEwOlJlcG9zaXRvcnkzMTI4ODk1OA==",
                    "name": "vault",
                    "full_name": "hashicorp/vault",
                    "private": false,
                    "owner": {
                      "login": "hashicorp",
                      "id": 761456,
                      "node_id": "MDEyOk9yZ2FuaXphdGlvbjc2MTQ1Ng==",
                      "avatar_url": "https://avatars2.githubusercontent.com/u/761456?v=4",
                      "gravatar_id": "",
                      "url": "https://api.github.com/users/hashicorp",
                      "html_url": "https://github.com/hashicorp",
                      "followers_url": "https://api.github.com/users/hashicorp/followers",
                      "following_url": "https://api.github.com/users/hashicorp/following{/other_user}",
                      "gists_url": "https://api.github.com/users/hashicorp/gists{/gist_id}",
                      "starred_url": "https://api.github.com/users/hashicorp/starred{/owner}{/repo}",
                      "subscriptions_url": "https://api.github.com/users/hashicorp/subscriptions",
                      "organizations_url": "https://api.github.com/users/hashicorp/orgs",
                      "repos_url": "https://api.github.com/users/hashicorp/repos",
                      "events_url": "https://api.github.com/users/hashicorp/events{/privacy}",
                      "received_events_url": "https://api.github.com/users/hashicorp/received_events",
                      "type": "Organization",
                      "site_admin": false
                    },
                    "html_url": "https://github.com/hashicorp/vault",
                    "description": "A tool for secrets management, encryption as a service, and privileged access management",
                    "fork": false,
                    "url": "https://api.github.com/repos/hashicorp/vault",
                    "forks_url": "https://api.github.com/repos/hashicorp/vault/forks",
                    "keys_url": "https://api.github.com/repos/hashicorp/vault/keys{/key_id}",
                    "collaborators_url": "https://api.github.com/repos/hashicorp/vault/collaborators{/collaborator}",
                    "teams_url": "https://api.github.com/repos/hashicorp/vault/teams",
                    "hooks_url": "https://api.github.com/repos/hashicorp/vault/hooks",
                    "issue_events_url": "https://api.github.com/repos/hashicorp/vault/issues/events{/number}",
                    "events_url": "https://api.github.com/repos/hashicorp/vault/events",
                    "assignees_url": "https://api.github.com/repos/hashicorp/vault/assignees{/user}",
                    "branches_url": "https://api.github.com/repos/hashicorp/vault/branches{/branch}",
                    "tags_url": "https://api.github.com/repos/hashicorp/vault/tags",
                    "blobs_url": "https://api.github.com/repos/hashicorp/vault/git/blobs{/sha}",
                    "git_tags_url": "https://api.github.com/repos/hashicorp/vault/git/tags{/sha}",
                    "git_refs_url": "https://api.github.com/repos/hashicorp/vault/git/refs{/sha}",
                    "trees_url": "https://api.github.com/repos/hashicorp/vault/git/trees{/sha}",
                    "statuses_url": "https://api.github.com/repos/hashicorp/vault/statuses/{sha}",
                    "languages_url": "https://api.github.com/repos/hashicorp/vault/languages",
                    "stargazers_url": "https://api.github.com/repos/hashicorp/vault/stargazers",
                    "contributors_url": "https://api.github.com/repos/hashicorp/vault/contributors",
                    "subscribers_url": "https://api.github.com/repos/hashicorp/vault/subscribers",
                    "subscription_url": "https://api.github.com/repos/hashicorp/vault/subscription",
                    "commits_url": "https://api.github.com/repos/hashicorp/vault/commits{/sha}",
                    "git_commits_url": "https://api.github.com/repos/hashicorp/vault/git/commits{/sha}",
                    "comments_url": "https://api.github.com/repos/hashicorp/vault/comments{/number}",
                    "issue_comment_url": "https://api.github.com/repos/hashicorp/vault/issues/comments{/number}",
                    "contents_url": "https://api.github.com/repos/hashicorp/vault/contents/{+path}",
                    "compare_url": "https://api.github.com/repos/hashicorp/vault/compare/{base}...{head}",
                    "merges_url": "https://api.github.com/repos/hashicorp/vault/merges",
                    "archive_url": "https://api.github.com/repos/hashicorp/vault/{archive_format}{/ref}",
                    "downloads_url": "https://api.github.com/repos/hashicorp/vault/downloads",
                    "issues_url": "https://api.github.com/repos/hashicorp/vault/issues{/number}",
                    "pulls_url": "https://api.github.com/repos/hashicorp/vault/pulls{/number}",
                    "milestones_url": "https://api.github.com/repos/hashicorp/vault/milestones{/number}",
                    "notifications_url": "https://api.github.com/repos/hashicorp/vault/notifications{?since,all,participating}",
                    "labels_url": "https://api.github.com/repos/hashicorp/vault/labels{/name}",
                    "releases_url": "https://api.github.com/repos/hashicorp/vault/releases{/id}",
                    "deployments_url": "https://api.github.com/repos/hashicorp/vault/deployments",
                    "created_at": "2015-02-25T00:15:59Z",
                    "updated_at": "2020-07-17T20:30:27Z",
                    "pushed_at": "2020-07-17T20:57:34Z",
                    "git_url": "git://github.com/hashicorp/vault.git",
                    "ssh_url": "git@github.com:hashicorp/vault.git",
                    "clone_url": "https://github.com/hashicorp/vault.git",
                    "svn_url": "https://github.com/hashicorp/vault",
                    "homepage": "https://www.vaultproject.io/",
                    "size": 123698,
                    "stargazers_count": 16436,
                    "watchers_count": 16436,
                    "language": "Go",
                    "has_issues": true,
                    "has_projects": false,
                    "has_downloads": true,
                    "has_wiki": false,
                    "has_pages": false,
                    "forks_count": 2534,
                    "archived": false,
                    "disabled": false,
                    "open_issues_count": 708,
                    "license": {
                      "key": "mpl-2.0",
                      "name": "Mozilla Public License 2.0",
                      "spdx_id": "MPL-2.0",
                      "url": "https://api.github.com/licenses/mpl-2.0",
                      "node_id": "MDc6TGljZW5zZTE0"
                    },
                    "forks": 2534,
                    "open_issues": 708,
                    "watchers": 16436,
                    "default_branch": "master"
                  },
                  "body": "In my test Env (Hashicorp PKI) . very nice but i don't know how to do config public trusted certificate using let's encrypt certificate . Please help me ......."
                }
              }
            },
            {
              "id": 2783863102,
              "created_at": 1573231762000,
              "event": "labeled",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/2783863102",
              "actor": "catsby",
              "label": "feature-request"
            },
            {
              "id": 2783863283,
              "created_at": 1573231766000,
              "event": "labeled",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/2783863283",
              "actor": "catsby",
              "label": "core/secret"
            },
            {
              "id": 555110050,
              "created_at": 1574096488000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/555110050",
              "actor": "remilapeyre",
              "body": "@mholt I've finally added support for the HTTP-01 and TLS-ALPN-01 challenges in https://github.com/remilapeyre/vault-acme/commit/6ac7a952d9f7d04354aa4ecc0cc2be963e7da411 so all basic functionality should now be present.\r\n\r\nWe are not using TLS-ALPN-01 and HTTP-01 in our infra so they are less tested than DNS-01. We've been using DNS-01 for a few weeks now without issues, except when we hit Let'sEncrypt rate limits once before I implemented the cache.\r\n\r\nI will look at the code in the next days to see what can be simplified, better documented but I think it may be ready for a cursory review.\r\n\r\nI also plan to make a few changes in the next days:\r\n\r\n- There can only be one contact for an account and it must be an email, this is too restrictive according to the RFC, I need to make changes in Lego for this which I will do once https://github.com/go-acme/lego/pull/1002 is merged.\r\n- The DNS-01 challenge solver currently support one DNS provider, I would be useful to make it work with multiple DNS providers e.g. `cloudflare,route53`. This is already the behavior of the Terraform ACME provider so this should not be an issue.\r\n- I'll implemented the support to update accounts once https://github.com/go-acme/lego/pull/1002 is merged.",
              "user": "remilapeyre",
              "html_url": "https://github.com/hashicorp/vault/issues/4950#issuecomment-555110050"
            },
            {
              "id": 2808326420,
              "created_at": 1574096489000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/2808326420",
              "actor": "mholt"
            },
            {
              "id": 2808326422,
              "created_at": 1574096489000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/2808326422",
              "actor": "mholt"
            },
            {
              "id": 555260155,
              "created_at": 1574119998000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/555260155",
              "actor": "heri16",
              "body": "Looking forward to support for more DNS providers. What's needed to get it working?",
              "user": "heri16",
              "html_url": "https://github.com/hashicorp/vault/issues/4950#issuecomment-555260155"
            },
            {
              "id": 555402978,
              "created_at": 1574154176000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/555402978",
              "actor": "remilapeyre",
              "body": "All DNS providers supported by Lego are supported, I need to document this, you can look at the list at https://www.terraform.io/docs/providers/acme/dns_providers/index.html. So far it's only possible to use environment variables for the credentials.\r\n\r\nIf you are using a provider not yet configured, adding it to go-acme/lego would be the path forward.",
              "user": "remilapeyre",
              "html_url": "https://github.com/hashicorp/vault/issues/4950#issuecomment-555402978"
            },
            {
              "id": 555471792,
              "created_at": 1574163924000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/555471792",
              "actor": "heri16",
              "body": "Not sure how the environment variables are passed into vault. The relevant document is here?\r\n\r\nhttps://github.com/remilapeyre/vault-acme/blob/master/website/source/docs/secrets/acme/index.html.md",
              "user": "heri16",
              "html_url": "https://github.com/hashicorp/vault/issues/4950#issuecomment-555471792"
            },
            {
              "id": 555496218,
              "created_at": 1574168300000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/555496218",
              "actor": "remilapeyre",
              "body": "Vault's environment variables are given to the plugin, so it depends on the way you are running them but doing `export AKAMAI_ACCESS_TOKEN=...` before running Vault, using `AKAMAI_ACCESS_TOKEN=... vault server -config-file=vault.hcl` or `docker run -e AKAMAI_ACCESS_TOKEN=... vault` should work.",
              "user": "remilapeyre",
              "html_url": "https://github.com/hashicorp/vault/issues/4950#issuecomment-555496218"
            },
            {
              "id": 568776327,
              "created_at": 1577205550000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/568776327",
              "actor": "binlab",
              "body": "@remilapeyre nice work!",
              "user": "binlab",
              "html_url": "https://github.com/hashicorp/vault/issues/4950#issuecomment-568776327"
            },
            {
              "id": 2907135285,
              "created_at": 1577205550000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/2907135285",
              "actor": "remilapeyre"
            },
            {
              "id": 2907135286,
              "created_at": 1577205550000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/2907135286",
              "actor": "remilapeyre"
            },
            {
              "id": 596709159,
              "created_at": 1583778759000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/596709159",
              "actor": "karl-tpio",
              "body": "@remilapeyre **Thank You**.  We use Auto Scaling EXTENSIVELY here and all \"people facing\" applications use Lets Encrypt for certificates. For many reasons, these application hosts can't use the web based challenge for Lets Encrypt, so we rely exclusively on the DNS based challenge.\r\n\r\nIt's unacceptable to give each auto-scale host permission to edit the _entire_ DNS Zone and even if they all did have this permission, we'd quickly hit the rate-limits (i think it's 7 certs in 7 days?) due to auto scale activity.\r\n\r\nI was *about* to embark on building a Lets Encrypt cache service using a small client based daemon i'd have to write and MQTT to link that client-daemon to some small service that i'd also have to write which would use S3/KMS and or Secure Parameter Store to cache the certificates and do the DNS challenge. \r\n\r\nI'm **so glad** I checked to see if there was already any work around this subject involving Vault. You've saved me a *ton* of headache w/r/t re-inventing the wheel!",
              "user": "karl-tpio",
              "html_url": "https://github.com/hashicorp/vault/issues/4950#issuecomment-596709159"
            },
            {
              "id": 3111905843,
              "created_at": 1583778762000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3111905843",
              "actor": "remilapeyre"
            },
            {
              "id": 3111905845,
              "created_at": 1583778762000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3111905845",
              "actor": "remilapeyre"
            },
            {
              "id": 596714907,
              "created_at": 1583779421000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/596714907",
              "actor": "kfox1111",
              "body": "we are using acme-dns (https://github.com/joohoi/acme-dns) to restrict external dns for handshaking to limited records to individual users in a private environment. Seems to work ok.",
              "user": "kfox1111",
              "html_url": "https://github.com/hashicorp/vault/issues/4950#issuecomment-596714907"
            },
            {
              "id": 596758137,
              "created_at": 1583785063000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/596758137",
              "actor": "remilapeyre",
              "body": "@karl-tpio thanks for the feedback. Keep in mind that while there is tests and that I should fix all bugs shortly, it has not been reviewed so far. I would love to get your feedback and fix any issue you find though.",
              "user": "remilapeyre",
              "html_url": "https://github.com/hashicorp/vault/issues/4950#issuecomment-596758137"
            },
            {
              "id": 3112251892,
              "created_at": 1583785063000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3112251892",
              "actor": "karl-tpio"
            },
            {
              "id": 3112251895,
              "created_at": 1583785063000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3112251895",
              "actor": "karl-tpio"
            },
            {
              "id": 658551048,
              "created_at": 1594790231000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/658551048",
              "actor": "weitzj",
              "body": "Hi. I am looking for the other side:\r\n\r\nHaving vault implement the acme server protocol. So I can just use Caddy/Traefik/... with vault as an ACME server to issue certificates from a private CA.\r\nDoes anybody have a hint for me?",
              "user": "weitzj",
              "html_url": "https://github.com/hashicorp/vault/issues/4950#issuecomment-658551048"
            },
            {
              "id": 658605071,
              "created_at": 1594799196000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/658605071",
              "actor": "remilapeyre",
              "body": "I think the support of the ACME protocol as a server was previously discussed and deemed out of scope as it is very different that the way Vault currently work. ACME suppose that you are unauthenticated and use a DNS or HTTP protocol to make sure you have access to the domain names you claimed while Vault has authentication built-in and only has an API.\r\n\r\nI think the best way to use the Vault private CA with Traefik and Caddy might be to use `vault agent template` to fetch and renew the SSL certificates.",
              "user": "remilapeyre",
              "html_url": "https://github.com/hashicorp/vault/issues/4950#issuecomment-658605071"
            },
            {
              "id": 658611827,
              "created_at": 1594800041000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/658611827",
              "actor": "nvx",
              "body": "At any rate #8690 would be the issue to track for that",
              "user": "nvx",
              "html_url": "https://github.com/hashicorp/vault/issues/4950#issuecomment-658611827"
            },
            {
              "id": 658844535,
              "created_at": 1594827995000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/658844535",
              "actor": "mholt",
              "body": "@remilapeyre @weitzj Even if Vault does not become an ACME server, I can suggest a couple of ways Vault can be used with Caddy, at least (this thread is two years old; and things have advanced now that Caddy 2 is released):\r\n\r\n- Caddy can use ACME with any compatible endpoint and then store the certificates in [any storage backend](https://caddyserver.com/docs/json/storage/). Vault could be that storage backend. (Caddy already supports Consul, redis, DynamoDB, and the file system.)\r\n- Caddy can use any [certmagic.Issuer](https://pkg.go.dev/github.com/caddyserver/certmagic?tab=doc#Issuer) to obtain certificates. These implementations do not have to use ACME and can be pretty much any Go function that yields a certificate from a CSR.\r\n- Caddy can be its own CA, either with or without ACME. It has [facilities for managing its own private PKI](https://caddyserver.com/docs/modules/pki) and has a [built-in ACME server](https://caddyserver.com/docs/modules/http.handlers.acme_server) if that is desired.\r\n- If using ACME, Caddy [can be configured to use any kind of DNS provider](https://caddyserver.com/docs/modules/tls.issuance.acme) to solve the DNS challenge, where that is relevant.\r\n\r\nThere are numerous options here to support all sorts of use cases. I'm sure Vault could be compatible with at least one or two of these.",
              "user": "mholt",
              "html_url": "https://github.com/hashicorp/vault/issues/4950#issuecomment-658844535"
            },
            {
              "id": 3549202989,
              "created_at": 1594829250000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3549202989",
              "actor": "weitzj"
            },
            {
              "id": 3549202990,
              "created_at": 1594829250000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3549202990",
              "actor": "weitzj"
            },
            {
              "id": 3549202992,
              "created_at": 1594829250000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3549202992",
              "actor": "remilapeyre"
            },
            {
              "id": 3549202995,
              "created_at": 1594829250000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3549202995",
              "actor": "remilapeyre"
            }
          ]
        },
        {
          "id": "654053824",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ2ODU0OTYz",
          "number": 9432,
          "html_url": "https://github.com/hashicorp/vault/pull/9432",
          "title": "Update the seal migration docs",
          "user": {
            "type": "user",
            "login": "mjarmy"
          },
          "labels": [
            {
              "id": "1874015060",
              "node_id": "MDU6TGFiZWwxODc0MDE1MDYw",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/docs-cherrypick",
              "name": "docs-cherrypick",
              "color": "0e8a16",
              "description": "",
              "default": false
            }
          ],
          "state": "closed",
          "locked": false,
          "assignee": {
            "type": "user",
            "login": "mjarmy"
          },
          "assignees": [
            {
              "type": "user",
              "login": "mjarmy"
            }
          ],
          "comments": 2,
          "created_at": 1594300704000,
          "updated_at": 1594828537000,
          "closed_at": 1594828529000,
          "author_association": "CONTRIBUTOR",
          "body": "This PR clarifies the seal migration docs a bit, and adds a section about using `step-down` on the old active node.",
          "milestone": {
            "id": "5107883",
            "number": 65,
            "title": "1.5"
          },
          "events": []
        },
        {
          "id": "656050978",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ4NDE3Njg1",
          "number": 9466,
          "html_url": "https://github.com/hashicorp/vault/pull/9466",
          "title": "Fetch quota by name before updating it",
          "user": {
            "type": "user",
            "login": "vishalnayak"
          },
          "labels": [],
          "state": "closed",
          "locked": false,
          "assignee": {
            "type": "user",
            "login": "vishalnayak"
          },
          "assignees": [
            {
              "type": "user",
              "login": "vishalnayak"
            }
          ],
          "comments": 0,
          "created_at": 1594664757000,
          "updated_at": 1594833908000,
          "closed_at": 1594833901000,
          "author_association": "MEMBER",
          "body": "",
          "milestone": {
            "id": "5107883",
            "number": 65,
            "title": "1.5"
          },
          "events": []
        },
        {
          "id": "657540062",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ5NjM5MDIw",
          "number": 9490,
          "html_url": "https://github.com/hashicorp/vault/pull/9490",
          "title": "Backport: Fetch quota by name before updating it",
          "user": {
            "type": "user",
            "login": "vishalnayak"
          },
          "labels": [],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594835495000,
          "updated_at": 1594836605000,
          "closed_at": 1594836601000,
          "author_association": "MEMBER",
          "body": "",
          "milestone": {
            "id": "5107883",
            "number": 65,
            "title": "1.5"
          },
          "events": []
        },
        {
          "id": "657496271",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ5NjAyNDU3",
          "number": 9489,
          "html_url": "https://github.com/hashicorp/vault/pull/9489",
          "title": "Add CL entry for mount_type addition",
          "user": {
            "type": "user",
            "login": "sgmiller"
          },
          "labels": [],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594831373000,
          "updated_at": 1594836759000,
          "closed_at": 1594836756000,
          "author_association": "CONTRIBUTOR",
          "events": []
        },
        {
          "id": "649788645",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDQzMzk5NTkx",
          "number": 9383,
          "html_url": "https://github.com/hashicorp/vault/pull/9383",
          "title": "plugin: fix process leak when Setup() fails",
          "user": {
            "type": "user",
            "login": "sorindumitru"
          },
          "labels": [],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 5,
          "created_at": 1593682700000,
          "updated_at": 1594839744000,
          "author_association": "NONE",
          "body": "We've noticed some leftover processes from vault plugins on our boxes. Some\r\nof them were even left over from previous instances of the service and reparented\r\nto init.  This could cause issues if too many of them accumulate.\r\n\r\nWhen running with TRACE logging the logs showed that there was an error return by\r\nthe call to Setup() the plugin. Looking through the code it looks like we do not\r\ncall Cleanup() in that case.\r\n\r\nBefore the patch our logs used to show this:\r\n```\r\n{\"@level\":\"trace\",\"@message\":\"setup\",\"@module\":\"aplugin\",\"@timestamp\":\"2020-06-30T11:42:42.110935-04:00\",\"status\":\"started\",\"transport\":\"gRPC\"}\r\n{\"@level\":\"trace\",\"@message\":\"setup\",\"@module\":\"aplugin,\"@timestamp\":\"2020-06-30T11:42:42.110986-04:00\",\"err\":\"rpc error: code = Canceled desc = context canceled\",\"status\":\"finished\",\"took\":50151,\"transport\":\"gRPC\"}\r\n```\r\nand after the patch we get the trace that the plugin has existed:\r\n```\r\n{\"@level\":\"trace\",\"@message\":\"setup\",\"@module\":\"aplugin\",\"@timestamp\":\"2020-07-02T05:27:02.065347-04:00\",\"status\":\"started\",\"transport\":\"gRPC\"}\r\n{\"@level\":\"trace\",\"@message\":\"setup\",\"@module\":\"aplugin,\"@timestamp\":\"2020-07-02T05:27:02.065386-04:00\",\"err\":\"rpc error: code = Canceled desc = context canceled\",\"status\":\"finished\",\"took\":39222,\"transport\":\"gRPC\"}\r\n{\"@level\":\"trace\",\"@message\":\"cleanup\",\"@module\":\"aplugin\",\"@timestamp\":\"2020-07-02T05:27:02.065410-04:00\",\"status\":\"started\",\"transport\":\"gRPC\"}\r\n{\"@level\":\"trace\",\"@message\":\"cleanup\",\"@module\":\"aplugin\",\"@timestamp\":\"2020-07-02T05:27:02.065883-04:00\",\"status\":\"finished\",\"took\":471538,\"transport\":\"gRPC\"}\r\n{\"@level\":\"warn\",\"@message\":\"error closing client during Kill\",\"@module\":\"aplugin\",\"@timestamp\":\"2020-07-02T05:27:02.065929-04:00\",\"err\":\"rpc error: code = Canceled desc = grpc: the client connection is closing\"}\r\n{\"@level\":\"debug\",\"@message\":\"plugin process exited\",\"@module\":\"aaplugin\",\"@timestamp\":\"2020-07-02T05:27:02.118913-04:00\",\"error\":\"signal: killed\",\"path\":\"...\",\"pid\":92276}\r\n```",
          "events": []
        },
        {
          "id": "657636545",
          "node_id": "MDU6SXNzdWU2NTc2MzY1NDU=",
          "number": 9492,
          "html_url": "https://github.com/hashicorp/vault/issues/9492",
          "title": "Vault client fails with \"net/http: TLS handshake timeout\"",
          "user": {
            "type": "user",
            "login": "rsk0"
          },
          "labels": [],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594845286000,
          "updated_at": 1594845286000,
          "author_association": "NONE",
          "body": "**Describe the bug**\r\nVault client fails with \"net/http: TLS handshake timeout\"\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Be on macOS\r\n2. Make about 120 certificate exceptions, have them added to your Keychain certificates\r\n3. Attempt Vault login (or, presumably, any hashitool action requiring TLS)\r\n\r\n```\r\n% vault login -field=token -method=ldap username=$USER\r\nPassword (will be hidden):\r\nError authenticating: Put \"https://vault.mydomain.com:8200/v1/auth/ldap/login/myusername\": net/http: TLS handshake timeout\r\n```\r\n\r\n**Environment:**\r\n* Vault Server 1.3.4+prem\r\n* Vault CLI v1.4.2\r\n* macOS Catalina 10.15.5\r\n\r\n**Additional context**\r\nIIRC, there seemed to be a period of erratic failures before this began failing consistently.  Those might have been before I upgraded from Sierra.  The increase in failure frequency might have corresponded to a continuing accumulation of certificates that gradually slowed the process down and/or to OS upgrade.",
          "events": []
        },
        {
          "id": "656047400",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ4NDE0NzM5",
          "number": 9465,
          "html_url": "https://github.com/hashicorp/vault/pull/9465",
          "title": "Bug fix: PKI ca cert field set initial value to 720hr",
          "user": {
            "type": "user",
            "login": "Monkeychip"
          },
          "labels": [
            {
              "id": "1492658523",
              "node_id": "MDU6TGFiZWwxNDkyNjU4NTIz",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/bug",
              "name": "bug",
              "color": "ef97a7",
              "description": "",
              "default": true
            },
            {
              "id": "872623767",
              "node_id": "MDU6TGFiZWw4NzI2MjM3Njc=",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/ui",
              "name": "ui",
              "color": "88e56e",
              "description": "",
              "default": false
            }
          ],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 1,
          "created_at": 1594664371000,
          "updated_at": 1594846847000,
          "closed_at": 1594846846000,
          "author_association": "CONTRIBUTOR",
          "body": "We had originally added the `intiailvalue` on the `pki-certificate` file in this [PR](https://github.com/hashicorp/vault/pull/9405).  However, this set all initial values used in the PKI to 720hr, which was problematic when you created a certificate after you created your CA certificate; naturally, it outlived your CA certificate.\r\n\r\nTo fix this we are now only set the initial value of ca certs to 720h, and everything else to 30hr. \r\n\r\n**Note**: there is duplication between the `TtlPicker2` components displayed when `isCaCert` is true and when `isCaCert` is false.  We opted for the duplication instead of making a difficult to read inline conditional for the `intialValue` property, which is the only property that is different between the two.",
          "milestone": {
            "id": "5107883",
            "number": 65,
            "title": "1.5"
          },
          "events": []
        },
        {
          "id": "657778491",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ5ODM5NjU5",
          "number": 9494,
          "html_url": "https://github.com/hashicorp/vault/pull/9494",
          "title": "Changes the default iam_alias and gce_alias values in the GCP auth API docs",
          "user": {
            "type": "user",
            "login": "austingebauer"
          },
          "labels": [],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594864268000,
          "updated_at": 1594864268000,
          "author_association": "MEMBER",
          "body": "This PR changes the default `iam_alias` and `gce_alias` values in the GCP auth API docs to `role_id`.\r\n\r\nRelated PR: https://github.com/hashicorp/vault-plugin-auth-gcp/pull/99",
          "events": []
        },
        {
          "id": "658139935",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDUwMTQ1MjI4",
          "number": 9496,
          "html_url": "https://github.com/hashicorp/vault/pull/9496",
          "title": "Use the accessor method so state lock is used to check if perf standby",
          "user": {
            "type": "user",
            "login": "ncabatoff"
          },
          "labels": [
            {
              "id": "2208353319",
              "node_id": "MDU6TGFiZWwyMjA4MzUzMzE5",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/data-race",
              "name": "data-race",
              "color": "f2abbf",
              "description": "",
              "default": false
            }
          ],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594901377000,
          "updated_at": 1594901733000,
          "author_association": "CONTRIBUTOR",
          "body": "Solves this race:\r\n\r\n```\r\nARNING: DATA RACE\r\nRead at 0x00c0046f3061 by goroutine 434:\r\n  github.com/hashicorp/vault/vault.(*Core).ForwardRequest()\r\n      /home/ncc/gh/vault-enterprise/vault/request_forwarding.go:374 +0x7f9\r\n  github.com/hashicorp/vault/http.forwardRequest()\r\n      /home/ncc/gh/vault-enterprise/http/handler.go:741 +0x2bb\r\n  github.com/hashicorp/vault/http.handleRequestForwarding.func1()\r\n      /home/ncc/gh/vault-enterprise/http/handler.go:709 +0x17a\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /home/ncc/go1.13.7/src/net/http/server.go:2007 +0x51\r\n  net/http.(*ServeMux).ServeHTTP()\r\n      /home/ncc/go1.13.7/src/net/http/server.go:2387 +0x288\r\n  github.com/hashicorp/vault/http.wrapHelpHandler.func1()\r\n      /home/ncc/gh/vault-enterprise/http/help.go:24 +0x1b3\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /home/ncc/go1.13.7/src/net/http/server.go:2007 +0x51\r\n  github.com/hashicorp/vault/http.wrapCORSHandler.func1()\r\n      /home/ncc/gh/vault-enterprise/http/cors.go:29 +0xe37\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /home/ncc/go1.13.7/src/net/http/server.go:2007 +0x51\r\n  github.com/hashicorp/vault/http.rateLimitQuotaWrapping.func1()\r\n      /home/ncc/gh/vault-enterprise/http/util.go:90 +0xd45\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /home/ncc/go1.13.7/src/net/http/server.go:2007 +0x51\r\n  github.com/hashicorp/vault/http.wrapDRSecondaryHandler.func1()\r\n      /home/ncc/gh/vault-enterprise/http/util_ent.go:72 +0x960\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /home/ncc/go1.13.7/src/net/http/server.go:2007 +0x51\r\n  github.com/hashicorp/vault/http.wrapGenericHandler.func1()\r\n      /home/ncc/gh/vault-enterprise/http/handler.go:308 +0x7c0\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /home/ncc/go1.13.7/src/net/http/server.go:2007 +0x51\r\n  github.com/hashicorp/go-cleanhttp.PrintablePathCheckHandler.func1()\r\n      /home/ncc/gh/vault-enterprise/vendor/github.com/hashicorp/go-cleanhttp/handlers.go:42 +0x105\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /home/ncc/go1.13.7/src/net/http/server.go:2007 +0x51\r\n  net/http.serverHandler.ServeHTTP()\r\n      /home/ncc/go1.13.7/src/net/http/server.go:2802 +0xce\r\n  net/http.initNPNRequest.ServeHTTP()\r\n      /home/ncc/go1.13.7/src/net/http/server.go:3366 +0xfc\r\n  net/http.(*initNPNRequest).ServeHTTP()\r\n      <autogenerated>:1 +0xa6\r\n  net/http.Handler.ServeHTTP-fm()\r\n      /home/ncc/go1.13.7/src/net/http/server.go:86 +0x64\r\n  net/http.(*http2serverConn).runHandler()\r\n      /home/ncc/go1.13.7/src/net/http/h2_bundle.go:5713 +0xac\r\n\r\nPrevious write at 0x00c0046f3061 by goroutine 336:\r\n  github.com/hashicorp/vault/vault.(*Core).waitForPerfStandby.func5()\r\n      /home/ncc/gh/vault-enterprise/vault/ha_ent.go:238 +0x1629\r\n  github.com/oklog/run.(*Group).Run.func1()\r\n      /home/ncc/gh/vault-enterprise/vendor/github.com/oklog/run/group.go:38 +0x34\r\n\r\nGoroutine 434 (running) created at:\r\n  net/http.(*http2serverConn).processHeaders()\r\n      /home/ncc/go1.13.7/src/net/http/h2_bundle.go:5447 +0x90f\r\n  net/http.(*http2serverConn).processFrame()\r\n      /home/ncc/go1.13.7/src/net/http/h2_bundle.go:4976 +0x59b\r\n  net/http.(*http2serverConn).processFrameFromReader()\r\n      /home/ncc/go1.13.7/src/net/http/h2_bundle.go:4934 +0x7ad\r\n  net/http.(*http2serverConn).serve()\r\n      /home/ncc/go1.13.7/src/net/http/h2_bundle.go:4433 +0x1493\r\n  net/http.(*http2Server).ServeConn()\r\n      /home/ncc/go1.13.7/src/net/http/h2_bundle.go:4031 +0xd9b\r\n  net/http.http2ConfigureServer.func1()\r\n      /home/ncc/go1.13.7/src/net/http/h2_bundle.go:3857 +0x117\r\n  net/http.(*conn).serve()\r\n      /home/ncc/go1.13.7/src/net/http/server.go:1800 +0x1d35\r\n\r\nGoroutine 336 (running) created at:\r\n  github.com/oklog/run.(*Group).Run()\r\n      /home/ncc/gh/vault-enterprise/vendor/github.com/oklog/run/group.go:37 +0x11c\r\n  github.com/hashicorp/vault/vault.(*Core).waitForPerfStandby()\r\n      /home/ncc/gh/vault-enterprise/vault/ha_ent.go:298 +0xf93\r\n  github.com/hashicorp/vault/vault.addEnterpriseHaActorsImpl.func1()\r\n      /home/ncc/gh/vault-enterprise/vault/ha_ent.go:48 +0x53\r\n  github.com/oklog/run.(*Group).Run.func1()\r\n      /home/ncc/gh/vault-enterprise/vendor/github.com/oklog/run/group.go:38 +0x34\r\n```",
          "events": []
        },
        {
          "id": "658183330",
          "node_id": "MDU6SXNzdWU2NTgxODMzMzA=",
          "number": 9497,
          "html_url": "https://github.com/hashicorp/vault/issues/9497",
          "title": "Vault: upstream rate limited error",
          "user": {
            "type": "user",
            "login": "ananthbh-debug"
          },
          "labels": [],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594904974000,
          "updated_at": 1594904974000,
          "author_association": "NONE",
          "body": "Hi,\r\n\r\nWe use Hashicorp Vault for authenticating our pods in the EKS clusters we run in us-east-1 and eu-central-1.\r\nThis means the pods make a call to Vault, which then queries the API server to authenticate the request.\r\n\r\nHowever, it seems that, in our systems, we are being rate limited and seeing an error message in vault pod logs \r\n\r\n\"error\": \"1 error occurred:\\n\\t* upstream rate limited\\n\\n\",\r\n\r\n Could you please let me know this particular error message is due to which API from AWS side and the reason for this error?\r\n\r\n\r\n\r\n**Environment:**\r\n* Vault Server Version (retrieve with `vault status`): \"version\": \"1.2.2\"\r\n* Vault CLI Version (retrieve with `vault version`): Vault v1.2.2\r\n\r\n",
          "events": []
        },
        {
          "id": "658207499",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDUwMjAzMDAx",
          "number": 9498,
          "html_url": "https://github.com/hashicorp/vault/pull/9498",
          "title": "pki: Allow to use not only one variable during templating in allowed_domains",
          "user": {
            "type": "user",
            "login": "qk4l"
          },
          "labels": [],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594906636000,
          "updated_at": 1594906680000,
          "author_association": "CONTRIBUTOR",
          "body": "Improve #8509 PR. \r\nNow it's possible to use not only pure variable in allowed_domains but also combinations of other ones or  domain suffices.\r\n",
          "events": []
        },
        {
          "id": "658214978",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDUwMjA5NDQw",
          "number": 9499,
          "html_url": "https://github.com/hashicorp/vault/pull/9499",
          "title": "Adding a Clone() function to the request handler ",
          "user": {
            "type": "user",
            "login": "bruj0"
          },
          "labels": [],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594907148000,
          "updated_at": 1594909996000,
          "closed_at": 1594907626000,
          "author_association": "CONTRIBUTOR",
          "body": "To be used when there's a need to modify the current request before saving it\r\n",
          "events": []
        },
        {
          "id": "658265723",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDUwMjUyNzU0",
          "number": 9500,
          "html_url": "https://github.com/hashicorp/vault/pull/9500",
          "title": "Allow consul repo override via env",
          "user": {
            "type": "user",
            "login": "freddygv"
          },
          "labels": [],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594910616000,
          "updated_at": 1594910893000,
          "closed_at": 1594910893000,
          "author_association": "MEMBER",
          "body": "For us to run these integration tests against unreleased versions of Consul (nightly or on commits) we need to be able to alter the Docker repo used for Consul images.\r\n\r\nThis PR allows us to override that repo as well as provide a username/password for authentication.",
          "events": []
        },
        {
          "id": "442275451",
          "node_id": "MDU6SXNzdWU0NDIyNzU0NTE=",
          "number": 6706,
          "html_url": "https://github.com/hashicorp/vault/issues/6706",
          "title": "Add `pki/issue_by_cn/<cn>` endpoint",
          "user": {
            "type": "user",
            "login": "mattmb"
          },
          "labels": [
            {
              "id": "1488905226",
              "node_id": "MDU6TGFiZWwxNDg4OTA1MjI2",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/enhancement",
              "name": "enhancement",
              "color": "0d8232",
              "description": "",
              "default": true
            },
            {
              "id": "1658610325",
              "node_id": "MDU6TGFiZWwxNjU4NjEwMzI1",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/secret/pki",
              "name": "secret/pki",
              "color": "59e560",
              "description": "",
              "default": false
            }
          ],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 8,
          "created_at": 1557413131000,
          "updated_at": 1594911131000,
          "author_association": "NONE",
          "body": "**Is your feature request related to a problem? Please describe.**\r\nI was disappointed to find that the `pki/issue/<role>` endpoint leaves me with no way to restrict the domain (CN) of the cert to the user's name. The use case is to use vault to issue user certificates and to only allow issuing certificates with the user's name in the CN. I can kinda achieve this by creating 1 role per user programmatically and then creating a policy that only allows `pki/issue/{{identity.entity.aliases.<auth_backend>.name}}`. However this is tedious because I must create roles automatically when users are added i.e. sync LDAP or whatever with the roles in Vault.\r\n\r\n**Describe the solution you'd like**\r\nHow about we add `pki/issue_by_cn/<cn>` which takes `role` in the body. This could then be restricted with a policy like `pki/issue_by_cn/{{identity.entity.aliases.<auth_backend>.name}}` and I would only need 1 `role` for all my users. This would just be an additional endpoint, not suggesting we change the existing ones.\r\n\r\n**Describe alternatives you've considered**\r\nTemplating the parameters has been considered in https://github.com/hashicorp/vault/pull/6558 and more generally doesn't seem to be in the plans.\r\nhttps://github.com/hashicorp/vault/pull/4157 considers checking token metadata.\r\n\r\n**Additional context**\r\nI think issuing client certs that have a CN matching the username with the PKI backend is an obvious use case and the above issues + https://groups.google.com/forum/#!topic/vault-tool/88CRNUIEG8Y show other people have wanted this.\r\n",
          "events": [
            {
              "id": 521611400,
              "created_at": 1565868903000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/521611400",
              "actor": "qk4l",
              "body": "It's really strange that there are no restrictions based CN in one pki role.\r\nPki role is more fundamental and it's nasty to create role per each host if we need a certificate per host based their FQDN.\r\n\r\nI see that controlling CN through policies, which supports templates, is more suitable than add templates to pki role - #7216  \r\n\r\n ",
              "user": "qk4l",
              "html_url": "https://github.com/hashicorp/vault/issues/6706#issuecomment-521611400"
            },
            {
              "id": 530871311,
              "created_at": 1568301002000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/530871311",
              "actor": "fcomte",
              "body": "Hello,\r\n\r\nI have this use case too :+1:  \r\n\r\nI was trying : \r\n\r\n`path \"pki/issue/server\" {\r\n  capabilities = [\"create\"]\r\n  allowed_parameters = {\r\n    \"common_name\" = [\"{{identity.entity.aliases.auth_jwt_2ba4da2e.name}}.domaine.name\" ]\r\n    \"*\"   = []\r\n  }\r\n}` \r\n\r\nIt seems that templating is not working on fine grained access control... ?\r\n",
              "user": "fcomte",
              "html_url": "https://github.com/hashicorp/vault/issues/6706#issuecomment-530871311"
            },
            {
              "id": 530938116,
              "created_at": 1568311246000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/530938116",
              "actor": "jefferai",
              "body": "Templating in policies is only supported in policy paths, at least for now.",
              "user": "jefferai",
              "html_url": "https://github.com/hashicorp/vault/issues/6706#issuecomment-530938116"
            },
            {
              "id": 531804087,
              "created_at": 1568644296000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/531804087",
              "actor": "mattmb",
              "body": "@jefferai what do you think about my suggested solution? Would you be happy to accept a PR to add an endpoint as described? If so I could probably work on it or find someone on my team to work on it.",
              "user": "mattmb",
              "html_url": "https://github.com/hashicorp/vault/issues/6706#issuecomment-531804087"
            },
            {
              "id": 2636626901,
              "created_at": 1568644296000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/2636626901",
              "actor": "jefferai"
            },
            {
              "id": 2636626903,
              "created_at": 1568644296000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/2636626903",
              "actor": "jefferai"
            },
            {
              "id": 2779668787,
              "created_at": 1573139022000,
              "event": "labeled",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/2779668787",
              "actor": "michelvocks",
              "label": "enhancement"
            },
            {
              "id": 2779668789,
              "created_at": 1573139022000,
              "event": "labeled",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/2779668789",
              "actor": "michelvocks",
              "label": "secret/pki"
            },
            {
              "id": 561386181,
              "created_at": 1575412103000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/561386181",
              "actor": "carnei-ro",
              "body": "Same scenario here.",
              "user": "carnei-ro",
              "html_url": "https://github.com/hashicorp/vault/issues/6706#issuecomment-561386181"
            },
            {
              "id": 606339500,
              "created_at": 1585617476000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/606339500",
              "actor": "nvx",
              "body": "Any update on this or #6558 / #7216? I feel like just limiting it to CN would be too restrictive so to me extending the templating to support the allowed/required parameters options seems like a more general solution but those seem stalled?",
              "user": "nvx",
              "html_url": "https://github.com/hashicorp/vault/issues/6706#issuecomment-606339500"
            },
            {
              "id": 659308043,
              "created_at": 1594893485000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/659308043",
              "actor": "mattmb",
              "body": "I *think* https://github.com/hashicorp/vault/pull/8509 might solve the problem?",
              "user": "mattmb",
              "html_url": "https://github.com/hashicorp/vault/issues/6706#issuecomment-659308043"
            },
            {
              "id": 659464512,
              "created_at": 1594911131000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/659464512",
              "actor": "qk4l",
              "body": "@mattmb Yes, you are right, check also #9498  which improve that solution.",
              "user": "qk4l",
              "html_url": "https://github.com/hashicorp/vault/issues/6706#issuecomment-659464512"
            },
            {
              "id": 3553628079,
              "created_at": 1594911131000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3553628079",
              "actor": "mattmb"
            },
            {
              "id": 3553628084,
              "created_at": 1594911131000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3553628084",
              "actor": "mattmb"
            }
          ]
        },
        {
          "id": "656741886",
          "node_id": "MDU6SXNzdWU2NTY3NDE4ODY=",
          "number": 9481,
          "html_url": "https://github.com/hashicorp/vault/issues/9481",
          "title": "DOCS: raft snapshots",
          "user": {
            "type": "user",
            "login": "assareh"
          },
          "labels": [],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594743984000,
          "updated_at": 1594915992000,
          "author_association": "CONTRIBUTOR",
          "body": "Hi team,\r\n\r\nThe documentation on raft snapshots is minimal. Perhaps we can take some verbiage from the [Consul](https://www.consul.io/docs/commands/snapshot) docs. Other questions I have heard from my customers are: \r\n\r\n- guidance on whether this is an offline or online operation\r\n- guidance on whether this should be done once per vault server node, or once per cluster (and if so, from which node)\r\n\r\nThanks for reading!",
          "events": []
        },
        {
          "id": "658343864",
          "node_id": "MDU6SXNzdWU2NTgzNDM4NjQ=",
          "number": 9501,
          "html_url": "https://github.com/hashicorp/vault/issues/9501",
          "title": "Use os.Setenv to set environment variables for a more seamless experience",
          "user": {
            "type": "user",
            "login": "dvbnrg"
          },
          "labels": [],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 2,
          "created_at": 1594915976000,
          "updated_at": 1594919731000,
          "closed_at": 1594919658000,
          "author_association": "NONE",
          "body": "When starting vault server, environment variables can and should be set automatically with the os package.\r\nsomething like this:\r\n\r\nNote: these variables were taken from the tutorial\r\n\r\nos.Setenv(VAULT_ADDR, 'http://127.0.0.1:8200')\r\nos.Setenv(VAULT_DEV_ROOT_TOKEN_ID, \"s.XmpNPoi9sRhYtdKHaQhkHP6x\")\r\n\r\nIf someone can elaborate as to when these variables are being generated, I can probably do it myself.\r\n",
          "events": [
            {
              "id": 659520396,
              "created_at": 1594916444000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/659520396",
              "actor": "ncabatoff",
              "body": "Hi @dvbnrg,\r\n\r\nI may be misunderstanding what you're proposing, but it sounds like you're suggesting that after running `vault server`, you would like to see some variables populated in your shell's environment.  Unfortunately that's not possible: a process can only modify the environment seen by it and its children.  Since `vault server` is a child of your shell, it's impossible for Vault to modify the shell's environment.\r\n\r\nThe way I do this when testing things is something like this script:\r\n\r\n```\r\nkill `ps axuw |grep 'vault server -dev' |awk '{print $2}'` && sleep 1\r\nvault server -log-level=debug -dev-listen-address=0.0.0.0:8200 -dev -dev-root-token-id=devroot \r\nwhile ! nc -w 1 localhost 8200 </dev/null; do sleep 1; done\r\n\r\nexport VAULT_ADDR=http://localhost:8200\r\nexport VAULT_TOKEN=devroot\r\n```\r\n\r\nThe catch is that you can't *run* this script, you have to use the bash `source` builtin.  So if you put the above into a file named `myvault`, you'd run\r\n\r\n```\r\n$ source myvault\r\n```\r\n\r\nrather than \r\n\r\n```\r\n./myvault\r\n```",
              "user": "ncabatoff",
              "html_url": "https://github.com/hashicorp/vault/issues/9501#issuecomment-659520396"
            },
            {
              "id": 3554063283,
              "created_at": 1594916445000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3554063283",
              "actor": "dvbnrg"
            },
            {
              "id": 3554063288,
              "created_at": 1594916445000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3554063288",
              "actor": "dvbnrg"
            },
            {
              "id": 659550799,
              "created_at": 1594919658000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/659550799",
              "actor": "dvbnrg",
              "body": "Understood. Thank you for the info!",
              "user": "dvbnrg",
              "html_url": "https://github.com/hashicorp/vault/issues/9501#issuecomment-659550799"
            },
            {
              "id": 3554281390,
              "created_at": 1594919658000,
              "event": "closed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3554281390",
              "actor": "dvbnrg"
            }
          ]
        },
        {
          "id": "657655662",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ5NzM2MjA4",
          "number": 9493,
          "html_url": "https://github.com/hashicorp/vault/pull/9493",
          "title": "Bug Fix: revert initialValue for PKI CA cert",
          "user": {
            "type": "user",
            "login": "Monkeychip"
          },
          "labels": [
            {
              "id": "872623767",
              "node_id": "MDU6TGFiZWw4NzI2MjM3Njc=",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/ui",
              "name": "ui",
              "color": "88e56e",
              "description": "",
              "default": false
            }
          ],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594847097000,
          "updated_at": 1594920417000,
          "closed_at": 1594919484000,
          "author_association": "CONTRIBUTOR",
          "body": "[A PR](https://github.com/hashicorp/vault/pull/9405) was merged to address a bug fix.  However, it created another bug, and to solve for this we are looking at changing the workflow to make this process clearer.\r\n\r\n",
          "milestone": {
            "id": "5107883",
            "number": 65,
            "title": "1.5"
          },
          "events": []
        },
        {
          "id": "656116292",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ4NDcxMTk2",
          "number": 9470,
          "html_url": "https://github.com/hashicorp/vault/pull/9470",
          "title": "Backport 1.4.4: Add truthy check for data.policies before calling 'includes' (#9467)",
          "user": {
            "type": "user",
            "login": "chelshaw"
          },
          "labels": [
            {
              "id": "872623767",
              "node_id": "MDU6TGFiZWw4NzI2MjM3Njc=",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/ui",
              "name": "ui",
              "color": "88e56e",
              "description": "",
              "default": false
            }
          ],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594671945000,
          "updated_at": 1594922459000,
          "closed_at": 1594922459000,
          "author_association": "CONTRIBUTOR",
          "body": "Backport of PR #9467 \r\n",
          "milestone": {
            "id": "5579414",
            "number": 74,
            "title": "1.4.4"
          },
          "events": []
        },
        {
          "id": "620376748",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDE5NjM2MTgx",
          "number": 9021,
          "html_url": "https://github.com/hashicorp/vault/pull/9021",
          "title": "Tests for PR 8991",
          "user": {
            "type": "user",
            "login": "tyrannosaurus-becks"
          },
          "labels": [
            {
              "id": "1659715356",
              "node_id": "MDU6TGFiZWwxNjU5NzE1MzU2",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/auth/aws",
              "name": "auth/aws",
              "color": "f968e8",
              "description": "",
              "default": false
            }
          ],
          "state": "open",
          "locked": false,
          "assignee": {
            "type": "user",
            "login": "jasonodonnell"
          },
          "assignees": [
            {
              "type": "user",
              "login": "jasonodonnell"
            }
          ],
          "comments": 0,
          "created_at": 1589822491000,
          "updated_at": 1594923306000,
          "author_association": "CONTRIBUTOR",
          "body": "This PR is only the tests used for verifying #8991. They've been separated out so that PR will only contain the minimum code change necessary for the fix.\r\n\r\nOne of the factors in AWS renewals being broken was that current tests did not flag issues with renewals. This PR adds the ability to mock the AWS clients used, allowing tests to be easily run in all environments. The approach taken was as close as possible to [AWS' recommended approach](https://aws.amazon.com/blogs/developer/mocking-out-then-aws-sdk-for-go-for-unit-testing/). There is also precedent for mocking the clients, as seen in [the Azure secrets plugin](https://github.com/hashicorp/vault-plugin-secrets-azure/blob/6544951c66d6c23b467877757d5f58dc7741dace/provider.go#L16).\r\n\r\nThe tests added would have flagged the issue. When run on master, they fail with:\r\n```\r\n--- FAIL: TestEC2LoginRenewDefaultSettings (0.00s)\r\n    use_cases_test.go:134: unable to fetch instance ID from metadata during renewal\r\n=== RUN   TestIAMLoginRenewDefaultSettings\r\n--- FAIL: TestIAMLoginRenewDefaultSettings (0.00s)\r\n    use_cases_test.go:270: unable to retrieve canonical ARN from metadata during renewal\r\n```\r\nOn this branch, they pass.\r\n\r\n**Additional Tests**\r\n- [x] SCP'd this binary onto an AWS EC2 instance (Ubuntu 18.04 LTS in us-east-1) and performed login and renewal as described [here](https://www.vaultproject.io/docs/auth/aws) for EC2 auth\r\n- [x] Also followed same instructions for logging in and renewing with the IAM method",
          "milestone": {
            "id": "5107962",
            "number": 66,
            "title": "triaged"
          },
          "events": []
        },
        {
          "id": "658403637",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDUwMzcwNTk3",
          "number": 9503,
          "html_url": "https://github.com/hashicorp/vault/pull/9503",
          "title": "Backport: 1.5.x: remove default value based on workflow discussions (#9493)",
          "user": {
            "type": "user",
            "login": "Monkeychip"
          },
          "labels": [
            {
              "id": "965254381",
              "node_id": "MDU6TGFiZWw5NjUyNTQzODE=",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/backport",
              "name": "backport",
              "color": "ed8496",
              "description": "",
              "default": false
            },
            {
              "id": "872623767",
              "node_id": "MDU6TGFiZWw4NzI2MjM3Njc=",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/ui",
              "name": "ui",
              "color": "88e56e",
              "description": "",
              "default": false
            }
          ],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594920637000,
          "updated_at": 1594923629000,
          "closed_at": 1594923624000,
          "author_association": "CONTRIBUTOR",
          "body": "This is a backport for this [PR](https://github.com/hashicorp/vault/pull/9493)",
          "milestone": {
            "id": "5107883",
            "number": 65,
            "title": "1.5"
          },
          "events": []
        },
        {
          "id": "658382445",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDUwMzUyMjU4",
          "number": 9502,
          "html_url": "https://github.com/hashicorp/vault/pull/9502",
          "title": "Resource Quotas: Remove 'burst' Param from Rate Limiter",
          "user": {
            "type": "user",
            "login": "alexanderbez"
          },
          "labels": [
            {
              "id": "965254381",
              "node_id": "MDU6TGFiZWw5NjUyNTQzODE=",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/backport",
              "name": "backport",
              "color": "ed8496",
              "description": "",
              "default": false
            },
            {
              "id": "1657574876",
              "node_id": "MDU6TGFiZWwxNjU3NTc0ODc2",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/core",
              "name": "core",
              "color": "0052cc",
              "description": "Issues and Pull-Requests specific to Vault Core",
              "default": false
            }
          ],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 2,
          "created_at": 1594918949000,
          "updated_at": 1594924487000,
          "closed_at": 1594924484000,
          "author_association": "CONTRIBUTOR",
          "body": "Per internal discussions, remove `burst` as a configurable parameter for rate limit quotas.",
          "milestone": {
            "id": "5107883",
            "number": 65,
            "title": "1.5"
          },
          "events": []
        },
        {
          "id": "658454351",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDUwNDE0NTg1",
          "number": 9504,
          "html_url": "https://github.com/hashicorp/vault/pull/9504",
          "title": "Backport 1.5.x: Resource Quotas: Remove 'burst' Param from Rate Limiter",
          "user": {
            "type": "user",
            "login": "alexanderbez"
          },
          "labels": [],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594924659000,
          "updated_at": 1594925051000,
          "closed_at": 1594925046000,
          "author_association": "CONTRIBUTOR",
          "body": "Backport https://github.com/hashicorp/vault/pull/9502 into 1.5.x",
          "milestone": {
            "id": "5107883",
            "number": 65,
            "title": "1.5"
          },
          "events": []
        },
        {
          "id": "578621185",
          "node_id": "MDExOlB1bGxSZXF1ZXN0Mzg2MTY2ODM5",
          "number": 8518,
          "html_url": "https://github.com/hashicorp/vault/pull/8518",
          "title": "Update cloud.google.com/go to the latest version",
          "user": {
            "type": "user",
            "login": "sethvargo"
          },
          "labels": [
            {
              "id": "1671974607",
              "node_id": "MDU6TGFiZWwxNjcxOTc0NjA3",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/auth/gcp",
              "name": "auth/gcp",
              "color": "f968e8",
              "description": "",
              "default": false
            }
          ],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 1,
          "created_at": 1583850523000,
          "updated_at": 1594926136000,
          "closed_at": 1594924154000,
          "author_association": "CONTRIBUTOR",
          "body": "",
          "milestone": {
            "id": "5107883",
            "number": 65,
            "title": "1.5"
          },
          "events": []
        },
        {
          "id": "657407143",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ5NTI4MzA0",
          "number": 9485,
          "html_url": "https://github.com/hashicorp/vault/pull/9485",
          "title": "Add a lock to seal migration",
          "user": {
            "type": "user",
            "login": "mjarmy"
          },
          "labels": [],
          "state": "closed",
          "locked": false,
          "assignee": {
            "type": "user",
            "login": "mjarmy"
          },
          "assignees": [
            {
              "type": "user",
              "login": "mjarmy"
            }
          ],
          "comments": 0,
          "created_at": 1594824094000,
          "updated_at": 1594926874000,
          "closed_at": 1594926870000,
          "author_association": "CONTRIBUTOR",
          "body": "Add a lock to seal migration so we'll know if its already in progress",
          "milestone": {
            "id": "5107883",
            "number": 65,
            "title": "1.5"
          },
          "events": []
        },
        {
          "id": "658492810",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDUwNDQ4MzEy",
          "number": 9507,
          "html_url": "https://github.com/hashicorp/vault/pull/9507",
          "title": "Updates the GCP auth plugin",
          "user": {
            "type": "user",
            "login": "austingebauer"
          },
          "labels": [
            {
              "id": "965254381",
              "node_id": "MDU6TGFiZWw5NjUyNTQzODE=",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/backport",
              "name": "backport",
              "color": "ed8496",
              "description": "",
              "default": false
            }
          ],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594927521000,
          "updated_at": 1594930466000,
          "closed_at": 1594928325000,
          "author_association": "MEMBER",
          "body": "Updates to bring in https://github.com/hashicorp/vault-plugin-auth-gcp/pull/99.\r\n\r\nThe following steps were taken:\r\n1. `go get github.com/hashicorp/vault-plugin-auth-gcp@v0.7.0`\r\n2. `go mod tidy`\r\n3. `go mod vendor`",
          "events": []
        },
        {
          "id": "658528360",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDUwNDc5NjE4",
          "number": 9508,
          "html_url": "https://github.com/hashicorp/vault/pull/9508",
          "title": "Backport 1.5.0: Updates the GCP auth plugin",
          "user": {
            "type": "user",
            "login": "austingebauer"
          },
          "labels": [
            {
              "id": "1671974607",
              "node_id": "MDU6TGFiZWwxNjcxOTc0NjA3",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/auth/gcp",
              "name": "auth/gcp",
              "color": "f968e8",
              "description": "",
              "default": false
            },
            {
              "id": "1467741097",
              "node_id": "MDU6TGFiZWwxNDY3NzQxMDk3",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/ecosystem",
              "name": "ecosystem",
              "color": "f2bc59",
              "description": "",
              "default": false
            }
          ],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1593930358000,
          "updated_at": 1593932534000,
          "closed_at": 1594932523000,
          "author_association": "MEMBER",
          "body": "This PR backports https://github.com/hashicorp/vault/pull/9507 by cherry-picking https://github.com/hashicorp/vault/commit/773c6d108ab215374496a96238237963b439479d.",
          "milestone": {
            "id": "5107883",
            "number": 65,
            "title": "1.5"
          },
          "events": []
        },
        {
          "id": "658588291",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDUwNTMyNDYx",
          "number": 9510,
          "html_url": "https://github.com/hashicorp/vault/pull/9510",
          "title": "Added instructions to step-down the active primary before upgrading",
          "user": {
            "type": "user",
            "login": "lkishalmi"
          },
          "labels": [],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 1,
          "created_at": 1594935053000,
          "updated_at": 1594935758000,
          "author_association": "NONE",
          "body": "By simply deleting the active primary pod, in a HA cluster the users can experience a few seconds downtime in Vault service, since it takes some time to detect and react on missing the active pod. By manually stepping down the active pod we re-routing the traffic to one of the previously upgraded standby pod. So Kubernetes engine will have the opportunity to recover a now standby pod.\r\n\r\nThe operation requires a valid root/sudo token.",
          "events": []
        },
        {
          "id": "574802447",
          "node_id": "MDExOlB1bGxSZXF1ZXN0MzgzMDYxODM5",
          "number": 8457,
          "html_url": "https://github.com/hashicorp/vault/pull/8457",
          "title": "Return logical.StatusBadRequest on requests with missing token",
          "user": {
            "type": "user",
            "login": "catsby"
          },
          "labels": [
            {
              "id": "1492658523",
              "node_id": "MDU6TGFiZWwxNDkyNjU4NTIz",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/bug",
              "name": "bug",
              "color": "ef97a7",
              "description": "",
              "default": true
            }
          ],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 1,
          "created_at": 1583254197000,
          "updated_at": 1594936127000,
          "author_association": "MEMBER",
          "body": "When request is made without a client token to an authenticated URL such as `sys/internal/ui/mounts/*`, we can return a `500` status code with `missing client token` error message. This PR changes a `missing client token`to instead return a `400` error. \r\n\r\nAlternatively, I considered adding a new error to the [`logical` package][logical-error] and checking for it in [`logical RespondErrorCommon`][logical-respond], but it wasn't clear that this error would be reused much as the text `\"missing client token\"` currently only appears twice in the codebase. `logicalStatusBadRequest` is already checked in that code, so I just leveraged that. \r\n\r\nFixes https://github.com/hashicorp/vault/issues/8377\r\n\r\n[logical-error]: https://github.com/hashicorp/vault/blob/1e4f1a4eb51053a1ba9146cfeb21fd72b81b433b/sdk/logical/error.go#L5-L31 \r\n\r\n[logical-respond]: https://github.com/hashicorp/vault/blob/1e4f1a4eb51053a1ba9146cfeb21fd72b81b433b/sdk/logical/response_util.go#L99-L114",
          "milestone": {
            "id": "5562772",
            "number": 72,
            "title": "1.6"
          },
          "events": []
        },
        {
          "id": "612450407",
          "node_id": "MDU6SXNzdWU2MTI0NTA0MDc=",
          "number": 8926,
          "html_url": "https://github.com/hashicorp/vault/issues/8926",
          "title": "IAM roles for AWS EKS service accounts not working",
          "user": {
            "type": "user",
            "login": "serhatcetinkaya"
          },
          "labels": [
            {
              "id": "1492658523",
              "node_id": "MDU6TGFiZWwxNDkyNjU4NTIz",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/bug",
              "name": "bug",
              "color": "ef97a7",
              "description": "",
              "default": true
            },
            {
              "id": "1658638636",
              "node_id": "MDU6TGFiZWwxNjU4NjM4NjM2",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/core/storage",
              "name": "core/storage",
              "color": "0000ff",
              "description": "",
              "default": false
            }
          ],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 8,
          "created_at": 1588669395000,
          "updated_at": 1594937589000,
          "author_association": "NONE",
          "body": "**Describe the bug**\r\nIAM roles for AWS EKS service accounts still don't work with Vault. I was expecting the issue to be resolved after #7450 and #7738 . I suspect the problem is [custom credential chain implementation in Vault](https://github.com/hashicorp/vault/blob/master/sdk/helper/awsutil/generate_credentials.go). \r\n\r\nIn EKS we have dummy IAM roles with almost no permission attached on worker nodes, instead we give permissions directly to pod (either with native IAM to service account solution or with third party tools like kube2iam etc). Expecting latest Vault would work with IAM to service account solution after seeing changelog, we upgraded to 1.4.1 and saw that instead of using service account IAM role it tries to use worker node IAM role, authenticates successfully but fails due to lack of privileges.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Attach dummy IAM roles on worker nodes \r\n2. Create a service account for Vault and attach an IAM role for it with proper permissions (https://docs.aws.amazon.com/eks/latest/userguide/iam-roles-for-service-accounts.html)\r\n3. Make the vault container run with service account\r\n4. In the logs see it tries to use worker instance role and fails\r\n\r\nTo easily reproduce use dynamodb backend and don't give any dynamodb permissions to worker node IAM role but give required permissions to IAM  role that is attached to service account, it will fail immediately with following error:\r\n```\r\nvault Error initializing storage of type dynamodb: AccessDeniedException: User: arn:aws:sts::****:assumed-role/****005/***005 is not authorized to perform: dynamodb:DescribeTable on resource: arn:aws:dynamodb:us-east-1:***:table/****\r\n vault     status code: 400, request id: AVE****AJG\r\n vault stream closed\r\n```\r\n\r\n**Expected behavior**\r\nI expect it to work like official SDK. With the same setup and different container when I do a call to AWS API the container uses IAM role from the service account.\r\n\r\n**Environment:**\r\nI used the official `vault:1.4.1` container.\r\n* `vault status` output:\r\n```\r\nvault status\r\nKey                      Value\r\n---                      -----\r\nRecovery Seal Type       shamir\r\nInitialized              true\r\nSealed                   false\r\nTotal Recovery Shares    5\r\nThreshold                3\r\nVersion                  1.4.1\r\nCluster Name             vault-cluster-6f587bab\r\nCluster ID               3d********ee\r\nHA Enabled               true\r\nHA Cluster               https://****:8201\r\nHA Mode                  active\r\n```\r\n* Vault CLI Version (retrieve with `vault version`): `Vault v1.4.1`\r\n* Server Operating System/Architecture:\r\n```\r\nLinux vault-0 4.14.165-133.209.amzn2.x86_64 #1 SMP Sun Feb 9 00:21:30 UTC 2020 x86_64 Linux\r\n```\r\n* Necessary environment variables exist:\r\n```\r\nenv | grep -i aws\r\nAWS_ROLE_ARN=arn:aws:iam::****:role/kubernetes-dev-vault\r\nAWS_WEB_IDENTITY_TOKEN_FILE=/var/run/secrets/eks.amazonaws.com/serviceaccount/token\r\n```\r\n* Filepath from `AWS_WEB_IDENTITY_TOKEN_FILE` is readable by vault user:\r\n```\r\n/ $ whoami\r\nvault\r\n/ $ id vault\r\nuid=100(vault) gid=1000(vault) groups=1000(vault),1000(vault)\r\n/ $ cat /var/run/secrets/eks.amazonaws.com/serviceaccount/token\r\neyJhb******VkN2E\r\n```\r\n\r\nVault server configuration file(s):\r\n\r\n```hcl\r\ndisable_mlock = true\r\nui = true\r\nlistener \"tcp\" {\r\n  address = \"[::]:8200\"\r\n  cluster_address = \"[::]:8201\"\r\n  tls_cert_file = \"/vault/userconfig/vault-server-tls/tls.crt\"\r\n  tls_key_file = \"/vault/userconfig/vault-server-tls/tls.key\"\r\n}\r\nstorage \"dynamodb\" {\r\n  ha_enabled = \"true\"\r\n  region     = \"us-east-1\"\r\n  table      = \"****\"\r\n}\r\nseal \"awskms\" {\r\n  kms_key_id = \"0*****7\"\r\n}\r\ntelemetry {\r\n  prometheus_retention_time = \"30s\",\r\n  disable_hostname = true\r\n}\r\nmax_lease_ttl = \"87600h\"\r\n```\r\n\r\n**Additional context**\r\nIn one of the related isssues, someone mentioned changing security context solves the problem but for me it didn't. Below is the securityContext used:\r\n```\r\n  securityContext:\r\n    fsGroup: 1000\r\n    runAsGroup: 1000\r\n    runAsNonRoot: true\r\n    runAsUser: 100\r\n```\r\nI tried different combinations mentioned in related issues.\r\n",
          "milestone": {
            "id": "5107962",
            "number": 66,
            "title": "triaged"
          },
          "events": [
            {
              "id": 3306480501,
              "created_at": 1588724698000,
              "event": "labeled",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3306480501",
              "actor": "calvn",
              "label": "bug"
            },
            {
              "id": 3306480503,
              "created_at": 1588724698000,
              "event": "labeled",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3306480503",
              "actor": "calvn",
              "label": "core/seal"
            },
            {
              "id": 3309452785,
              "created_at": 1588784951000,
              "event": "labeled",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3309452785",
              "actor": "pcman312",
              "label": "core/storage"
            },
            {
              "id": 3309453093,
              "created_at": 1588784955000,
              "event": "unlabeled",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3309453093",
              "actor": "pcman312",
              "label": "core/seal"
            },
            {
              "created_at": 1588849842000,
              "event": "cross-referenced",
              "actor": "serhatcetinkaya",
              "source": {
                "type": "issue",
                "issue": {
                  "url": "https://api.github.com/repos/aws/aws-sdk-go/issues/2828",
                  "repository_url": "https://api.github.com/repos/aws/aws-sdk-go",
                  "labels_url": "https://api.github.com/repos/aws/aws-sdk-go/issues/2828/labels{/name}",
                  "comments_url": "https://api.github.com/repos/aws/aws-sdk-go/issues/2828/comments",
                  "events_url": "https://api.github.com/repos/aws/aws-sdk-go/issues/2828/events",
                  "html_url": "https://github.com/aws/aws-sdk-go/issues/2828",
                  "id": 492510215,
                  "node_id": "MDU6SXNzdWU0OTI1MTAyMTU=",
                  "number": 2828,
                  "title": "session.New doesn't invoke NewWebIdentityCredentials unless AWS_SDK_LOAD_CONFIG is set",
                  "user": {
                    "login": "joelthompson",
                    "id": 1562980,
                    "node_id": "MDQ6VXNlcjE1NjI5ODA=",
                    "avatar_url": "https://avatars2.githubusercontent.com/u/1562980?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/joelthompson",
                    "html_url": "https://github.com/joelthompson",
                    "followers_url": "https://api.github.com/users/joelthompson/followers",
                    "following_url": "https://api.github.com/users/joelthompson/following{/other_user}",
                    "gists_url": "https://api.github.com/users/joelthompson/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/joelthompson/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/joelthompson/subscriptions",
                    "organizations_url": "https://api.github.com/users/joelthompson/orgs",
                    "repos_url": "https://api.github.com/users/joelthompson/repos",
                    "events_url": "https://api.github.com/users/joelthompson/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/joelthompson/received_events",
                    "type": "User",
                    "site_admin": false
                  },
                  "labels": [
                    {
                      "id": 154423093,
                      "node_id": "MDU6TGFiZWwxNTQ0MjMwOTM=",
                      "url": "https://api.github.com/repos/aws/aws-sdk-go/labels/guidance",
                      "name": "guidance",
                      "color": "8a19e7",
                      "default": false,
                      "description": "Question that needs advice or information."
                    }
                  ],
                  "state": "open",
                  "locked": false,
                  "assignee": {
                    "login": "diehlaws",
                    "id": 40442261,
                    "node_id": "MDQ6VXNlcjQwNDQyMjYx",
                    "avatar_url": "https://avatars0.githubusercontent.com/u/40442261?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/diehlaws",
                    "html_url": "https://github.com/diehlaws",
                    "followers_url": "https://api.github.com/users/diehlaws/followers",
                    "following_url": "https://api.github.com/users/diehlaws/following{/other_user}",
                    "gists_url": "https://api.github.com/users/diehlaws/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/diehlaws/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/diehlaws/subscriptions",
                    "organizations_url": "https://api.github.com/users/diehlaws/orgs",
                    "repos_url": "https://api.github.com/users/diehlaws/repos",
                    "events_url": "https://api.github.com/users/diehlaws/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/diehlaws/received_events",
                    "type": "User",
                    "site_admin": false
                  },
                  "assignees": [
                    {
                      "login": "diehlaws",
                      "id": 40442261,
                      "node_id": "MDQ6VXNlcjQwNDQyMjYx",
                      "avatar_url": "https://avatars0.githubusercontent.com/u/40442261?v=4",
                      "gravatar_id": "",
                      "url": "https://api.github.com/users/diehlaws",
                      "html_url": "https://github.com/diehlaws",
                      "followers_url": "https://api.github.com/users/diehlaws/followers",
                      "following_url": "https://api.github.com/users/diehlaws/following{/other_user}",
                      "gists_url": "https://api.github.com/users/diehlaws/gists{/gist_id}",
                      "starred_url": "https://api.github.com/users/diehlaws/starred{/owner}{/repo}",
                      "subscriptions_url": "https://api.github.com/users/diehlaws/subscriptions",
                      "organizations_url": "https://api.github.com/users/diehlaws/orgs",
                      "repos_url": "https://api.github.com/users/diehlaws/repos",
                      "events_url": "https://api.github.com/users/diehlaws/events{/privacy}",
                      "received_events_url": "https://api.github.com/users/diehlaws/received_events",
                      "type": "User",
                      "site_admin": false
                    }
                  ],
                  "comments": 7,
                  "created_at": "2019-09-11T23:17:35Z",
                  "updated_at": "2020-05-07T11:10:43Z",
                  "author_association": "NONE",
                  "repository": {
                    "id": 27576132,
                    "node_id": "MDEwOlJlcG9zaXRvcnkyNzU3NjEzMg==",
                    "name": "aws-sdk-go",
                    "full_name": "aws/aws-sdk-go",
                    "private": false,
                    "owner": {
                      "login": "aws",
                      "id": 2232217,
                      "node_id": "MDEyOk9yZ2FuaXphdGlvbjIyMzIyMTc=",
                      "avatar_url": "https://avatars3.githubusercontent.com/u/2232217?v=4",
                      "gravatar_id": "",
                      "url": "https://api.github.com/users/aws",
                      "html_url": "https://github.com/aws",
                      "followers_url": "https://api.github.com/users/aws/followers",
                      "following_url": "https://api.github.com/users/aws/following{/other_user}",
                      "gists_url": "https://api.github.com/users/aws/gists{/gist_id}",
                      "starred_url": "https://api.github.com/users/aws/starred{/owner}{/repo}",
                      "subscriptions_url": "https://api.github.com/users/aws/subscriptions",
                      "organizations_url": "https://api.github.com/users/aws/orgs",
                      "repos_url": "https://api.github.com/users/aws/repos",
                      "events_url": "https://api.github.com/users/aws/events{/privacy}",
                      "received_events_url": "https://api.github.com/users/aws/received_events",
                      "type": "Organization",
                      "site_admin": false
                    },
                    "html_url": "https://github.com/aws/aws-sdk-go",
                    "description": "AWS SDK for the Go programming language.",
                    "fork": false,
                    "url": "https://api.github.com/repos/aws/aws-sdk-go",
                    "forks_url": "https://api.github.com/repos/aws/aws-sdk-go/forks",
                    "keys_url": "https://api.github.com/repos/aws/aws-sdk-go/keys{/key_id}",
                    "collaborators_url": "https://api.github.com/repos/aws/aws-sdk-go/collaborators{/collaborator}",
                    "teams_url": "https://api.github.com/repos/aws/aws-sdk-go/teams",
                    "hooks_url": "https://api.github.com/repos/aws/aws-sdk-go/hooks",
                    "issue_events_url": "https://api.github.com/repos/aws/aws-sdk-go/issues/events{/number}",
                    "events_url": "https://api.github.com/repos/aws/aws-sdk-go/events",
                    "assignees_url": "https://api.github.com/repos/aws/aws-sdk-go/assignees{/user}",
                    "branches_url": "https://api.github.com/repos/aws/aws-sdk-go/branches{/branch}",
                    "tags_url": "https://api.github.com/repos/aws/aws-sdk-go/tags",
                    "blobs_url": "https://api.github.com/repos/aws/aws-sdk-go/git/blobs{/sha}",
                    "git_tags_url": "https://api.github.com/repos/aws/aws-sdk-go/git/tags{/sha}",
                    "git_refs_url": "https://api.github.com/repos/aws/aws-sdk-go/git/refs{/sha}",
                    "trees_url": "https://api.github.com/repos/aws/aws-sdk-go/git/trees{/sha}",
                    "statuses_url": "https://api.github.com/repos/aws/aws-sdk-go/statuses/{sha}",
                    "languages_url": "https://api.github.com/repos/aws/aws-sdk-go/languages",
                    "stargazers_url": "https://api.github.com/repos/aws/aws-sdk-go/stargazers",
                    "contributors_url": "https://api.github.com/repos/aws/aws-sdk-go/contributors",
                    "subscribers_url": "https://api.github.com/repos/aws/aws-sdk-go/subscribers",
                    "subscription_url": "https://api.github.com/repos/aws/aws-sdk-go/subscription",
                    "commits_url": "https://api.github.com/repos/aws/aws-sdk-go/commits{/sha}",
                    "git_commits_url": "https://api.github.com/repos/aws/aws-sdk-go/git/commits{/sha}",
                    "comments_url": "https://api.github.com/repos/aws/aws-sdk-go/comments{/number}",
                    "issue_comment_url": "https://api.github.com/repos/aws/aws-sdk-go/issues/comments{/number}",
                    "contents_url": "https://api.github.com/repos/aws/aws-sdk-go/contents/{+path}",
                    "compare_url": "https://api.github.com/repos/aws/aws-sdk-go/compare/{base}...{head}",
                    "merges_url": "https://api.github.com/repos/aws/aws-sdk-go/merges",
                    "archive_url": "https://api.github.com/repos/aws/aws-sdk-go/{archive_format}{/ref}",
                    "downloads_url": "https://api.github.com/repos/aws/aws-sdk-go/downloads",
                    "issues_url": "https://api.github.com/repos/aws/aws-sdk-go/issues{/number}",
                    "pulls_url": "https://api.github.com/repos/aws/aws-sdk-go/pulls{/number}",
                    "milestones_url": "https://api.github.com/repos/aws/aws-sdk-go/milestones{/number}",
                    "notifications_url": "https://api.github.com/repos/aws/aws-sdk-go/notifications{?since,all,participating}",
                    "labels_url": "https://api.github.com/repos/aws/aws-sdk-go/labels{/name}",
                    "releases_url": "https://api.github.com/repos/aws/aws-sdk-go/releases{/id}",
                    "deployments_url": "https://api.github.com/repos/aws/aws-sdk-go/deployments",
                    "created_at": "2014-12-05T05:29:41Z",
                    "updated_at": "2020-07-17T18:11:58Z",
                    "pushed_at": "2020-07-17T23:34:49Z",
                    "git_url": "git://github.com/aws/aws-sdk-go.git",
                    "ssh_url": "git@github.com:aws/aws-sdk-go.git",
                    "clone_url": "https://github.com/aws/aws-sdk-go.git",
                    "svn_url": "https://github.com/aws/aws-sdk-go",
                    "homepage": "http://aws.amazon.com/sdk-for-go/",
                    "size": 124364,
                    "stargazers_count": 5920,
                    "watchers_count": 5920,
                    "language": "Go",
                    "has_issues": true,
                    "has_projects": true,
                    "has_downloads": true,
                    "has_wiki": false,
                    "has_pages": false,
                    "forks_count": 1503,
                    "archived": false,
                    "disabled": false,
                    "open_issues_count": 176,
                    "license": {
                      "key": "apache-2.0",
                      "name": "Apache License 2.0",
                      "spdx_id": "Apache-2.0",
                      "url": "https://api.github.com/licenses/apache-2.0",
                      "node_id": "MDc6TGljZW5zZTI="
                    },
                    "forks": 1503,
                    "open_issues": 176,
                    "watchers": 5920,
                    "default_branch": "master"
                  },
                  "body": "Please fill out the sections below to help us address your issue.\r\n\r\n### Version of AWS SDK for Go?\r\n\r\n1.23.19\r\n\r\n### Version of Go (`go version`)?\r\n1.12.7\r\n\r\n### What issue did you see?\r\n\r\nThe title of the issue says it all. See https://github.com/hashicorp/vault/issues/7450#issuecomment-530160521 for more of my investigation. This prevents the SDK from picking up EKS pod service account credentials and exchanging them for AWS credentials when using `session.New` and AWS_SDK_LOAD_CONFIG isn't set.\r\n\r\n`session.NewSession` doesn't face this limitation. It will always try to invoke NewWebIdentityCredentials regardless of whether AWS_SDK_LOAD_CONFIG is set. It seems weird that there's a divergence in this behavior between the two when the documentation states that `session.NewSession` is the same as `session.New` except it the former can return errors.\r\n\r\n### Steps to reproduce\r\n\r\nHaven't tested it out yet, sorry. Mostly just looking through code."
                }
              }
            },
            {
              "id": 625256384,
              "created_at": 1588858183000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/625256384",
              "actor": "dogfish182",
              "body": "we are seeing same issue, \r\n\r\n```\r\n  securityContext:\r\n    fsGroup: 1000\r\n    runAsGroup: 1000\r\n    runAsNonRoot: true\r\n    runAsUser: 100\r\n```\r\nthis did not work for us either.",
              "user": "dogfish182",
              "html_url": "https://github.com/hashicorp/vault/issues/8926#issuecomment-625256384"
            },
            {
              "id": 625572827,
              "created_at": 1588899846000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/625572827",
              "actor": "papovyr",
              "body": "@serhatcetinkaya @dogfish182 this is working,\r\nEverything after commit `e82399a94fc08a0c9849822eb6ebb40210dae6ef` works \r\nregarding this file : [https://github.com/hashicorp/vault/blob/master/sdk/helper/awsutil/generate_credentials.go](https://github.com/hashicorp/vault/blob/master/sdk/helper/awsutil/generate_credentials.go)\r\nline 65\r\nYou Need also provide `AWS_ROLE_SESSION_NAME` as an environment variable for container \r\nAWS EKS will automatically ingest variables `AWS_ROLE_ARN` and `AWS_WEB_IDENTITY_TOKEN_FILE` based on service account \r\nbut `AWS_ROLE_SESSION_NAME` is required by vault (as they don't generate random value)\r\nTry to build from master, add AWS_ROLE_SESSION_NAME env variable  and it will work \r\nIm wondering when this commit will be part of release ?",
              "user": "papovyr",
              "html_url": "https://github.com/hashicorp/vault/issues/8926#issuecomment-625572827"
            },
            {
              "id": 3315182511,
              "created_at": 1588899846000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3315182511",
              "actor": "dogfish182"
            },
            {
              "id": 3315182514,
              "created_at": 1588899846000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3315182514",
              "actor": "dogfish182"
            },
            {
              "id": 3315182517,
              "created_at": 1588899846000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3315182517",
              "actor": "serhatcetinkaya"
            },
            {
              "id": 3315182519,
              "created_at": 1588899846000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3315182519",
              "actor": "serhatcetinkaya"
            },
            {
              "id": 627153304,
              "created_at": 1589266887000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/627153304",
              "actor": "dogfish182",
              "body": "thanks for that @papovyr! I would also love to know when the fix will be rolled into a release, I can't find any kind of release cycle description anywhere though. Does anyone know? \r\n\r\nWe would prefer to wait for an official release and use the helm chart for simplicity and can probably just work around it until then. ",
              "user": "dogfish182",
              "html_url": "https://github.com/hashicorp/vault/issues/8926#issuecomment-627153304"
            },
            {
              "id": 3326044661,
              "created_at": 1589266887000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3326044661",
              "actor": "papovyr"
            },
            {
              "id": 3326044665,
              "created_at": 1589266887000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3326044665",
              "actor": "papovyr"
            },
            {
              "id": 627498210,
              "created_at": 1589306098000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/627498210",
              "actor": "dgozalo",
              "body": "As far as I know, this change hasn't been added to any Vault release yet. The milestone for this change is 1.5.",
              "user": "dgozalo",
              "html_url": "https://github.com/hashicorp/vault/issues/8926#issuecomment-627498210"
            },
            {
              "id": 3398873845,
              "created_at": 1591121421000,
              "event": "milestoned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3398873845",
              "actor": "pbernal",
              "milestone": "triaged"
            },
            {
              "id": 652671216,
              "created_at": 1593641458000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/652671216",
              "actor": "chancez",
              "body": "I saw it also got backported to 1.4.3 (not yet released)",
              "user": "chancez",
              "html_url": "https://github.com/hashicorp/vault/issues/8926#issuecomment-652671216"
            },
            {
              "id": 655119668,
              "created_at": 1594154327000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/655119668",
              "actor": "orirawlings",
              "body": "I think this is fixed in 1.4.3, but it looks like there might be another bug (#9415) that requires that the otherwise optional parameter `AWS_ROLE_SESSION_NAME` to be set in the environment variables. To work-around, you'll just have to explicitly set a session name, rather than let one be randomly generated.",
              "user": "orirawlings",
              "html_url": "https://github.com/hashicorp/vault/issues/8926#issuecomment-655119668"
            },
            {
              "id": 658203298,
              "created_at": 1594735882000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/658203298",
              "actor": "serhatcetinkaya",
              "body": "I can confirm 1.4.3 works with `AWS_ROLE_SESSION_NAME` environment variable.",
              "user": "serhatcetinkaya",
              "html_url": "https://github.com/hashicorp/vault/issues/8926#issuecomment-658203298"
            },
            {
              "id": 659703409,
              "created_at": 1594937588000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/659703409",
              "actor": "tvoran",
              "body": "Now that #9416 has been merged to fix #9415, setting `AWS_ROLE_SESSION_NAME` should no longer be required in vault 1.4.4 and 1.5.0 (when they're released, that is).",
              "user": "tvoran",
              "html_url": "https://github.com/hashicorp/vault/issues/8926#issuecomment-659703409"
            }
          ]
        },
        {
          "id": "606592031",
          "node_id": "MDU6SXNzdWU2MDY1OTIwMzE=",
          "number": 8844,
          "html_url": "https://github.com/hashicorp/vault/issues/8844",
          "title": "Vault 1.4.0 won't start when a seal stanza is added in aws eks",
          "user": {
            "type": "user",
            "login": "corbesero"
          },
          "labels": [
            {
              "id": "1492658523",
              "node_id": "MDU6TGFiZWwxNDkyNjU4NTIz",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/bug",
              "name": "bug",
              "color": "ef97a7",
              "description": "",
              "default": true
            },
            {
              "id": "1658778046",
              "node_id": "MDU6TGFiZWwxNjU4Nzc4MDQ2",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/core/seal",
              "name": "core/seal",
              "color": "0000ff",
              "description": "",
              "default": false
            }
          ],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 14,
          "created_at": 1587763387000,
          "updated_at": 1594937901000,
          "author_association": "NONE",
          "body": "**Describe the bug**\r\n\r\nWhen I add a seal stanza (awskms) to a vault configuration via the vault-helm chart (0.5.0), the vault does not become available in the containers.  \r\n\r\n**To Reproduce**\r\n1. I do a helm install without the seal stanza.  Vaults (one active and one standby) will come up and I can unseal manually.  \r\n2. Add the seal stanza to access an existing kms key\r\n3. Do a helm update\r\n4. Delete the pods so they get recreated with the new configuration.\r\n\r\n**Expected behavior**\r\n\r\nThe vaults should come up so that I can do the unseal migrate.\r\n\r\n**Environment:**\r\nVault 1.4.0\r\nAWS EKS 1.15\r\nvault-helm chart at tag 0.5.0\r\n\r\nVault server configuration file(s):\r\n\r\n```hcl\r\ndisable_mlock = true\r\nui = true\r\nlog_level = \"trace\"\r\nlistener \"tcp\" {\r\n  tls_disable = 1\r\n  address = \"[::]:8200\"\r\n  cluster_address = \"[::]:8201\"\r\n}\r\nstorage \"raft\" {\r\n  path = \"/vault/data\"\r\n  retry_join {\r\n    leader_api_addr = \"http://vault-0.vault-internal:8200\"\r\n  }\r\n  retry_join {\r\n    leader_api_addr = \"http://vault-1.vault-internal:8200\"\r\n  }\r\n}\r\nseal \"awskms\" {\r\n region     = \"us-east-1\"\r\n kms_key_id = \"7899be0b-3be8-4dd7-a5b5-32b85c02c406\"\r\n}\r\n\r\n```\r\nAlso, see attached values file for helm\r\n\r\n**Additional context**\r\n\r\nNo log output is produced.\r\n\r\nThis is the output of a ps on the container\r\n```\r\n/ $ ps awx | grep vault\r\n    1 vault     0:00 /bin/sh -ec sed -E \"s/HOST_IP/${HOST_IP?}/g\" /vault/config/extraconfig-from-values.hcl > /tmp/storageconfig.hcl; sed -Ei \"s/POD_IP/${POD_IP?}/g\" /tmp/storageconfig.hcl; /usr/local/bin/docker-entrypoint.sh vault server -config=/tmp/storageconfig.hcl  \r\n    8 vault     0:00 {docker-entrypoi} /usr/bin/dumb-init /bin/sh /usr/local/bin/docker-entrypoint.sh vault server -config=/tmp/storageconfig.hcl\r\n    9 vault     0:00 vault server -config=/tmp/storageconfig.hcl\r\n  208 vault     0:00 /bin/sh\r\n  254 vault     0:00 ps awx\r\n  255 vault     0:00 grep vault\r\n```\r\nI have attached the output of `kubectl describe pods -n vault` for the vault-0 and vault-1 pods.  The vault-0 is when the pod is still there, but the vault-1 sows the output after a while when the container completely fails.\r\n\r\nIf I comment out the seal stanza, I can do a helm upgrade, delete the pods, and the new ones come up and can be unsealed.\r\n\r\n\r\n[kubectl-describe-pod-vault-0.txt](https://github.com/hashicorp/vault/files/4531583/kubectl-describe-pod-vault-0.txt)\r\n[kubectl-describe-pod-vault-1.txt](https://github.com/hashicorp/vault/files/4531584/kubectl-describe-pod-vault-1.txt)\r\n[values.yaml.txt](https://github.com/hashicorp/vault/files/4531585/values.yaml.txt)\r\n\r\n\r\n",
          "events": [
            {
              "id": 619292246,
              "created_at": 1587775160000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/619292246",
              "actor": "calvn",
              "body": "@corbesero thanks for opening a separate issue to follow up on this. We've done some initial investigation on our end, and believe that it might be an issue with the instance profile not being detected correctly. \r\n\r\nCan you create IAM Access Keys (with the [proper permissions](https://www.vaultproject.io/docs/configuration/seal/awskms#authentication)), and provide them directly to test things out?\r\n\r\n```\r\nserver:\r\n  # extraSecretEnvironmentVars is a list of extra enviroment variables to set with the stateful set.\r\n  # These variables take value from existing Secret objects.\r\n  extraSecretEnvironmentVars:\r\n  - envName: AWS_ACCESS_KEY_ID\r\n    secretName: vault-aws\r\n    secretKey: AWS_ACCESS_KEY_ID\r\n  - envName: AWS_SECRET_ACCESS_KEY\r\n    secretName: vault-aws\r\n    secretKey: AWS_SECRET_ACCESS_KEY\r\n\r\n  ha:\r\n    enabled: true\r\n    raft:\r\n      enabled: true\r\n      config: |\r\n        ui = true\r\n\r\n        listener \"tcp\" {\r\n          tls_disable = 1\r\n          address = \"[::]:8200\"\r\n          cluster_address = \"[::]:8201\"\r\n        }\r\n\r\n        storage \"raft\" {\r\n          path = \"/vault/data\"\r\n          retry_join {\r\n            leader_api_addr = \"http://vault-0.vault-internal:8200\"\r\n          }\r\n          retry_join {\r\n            leader_api_addr = \"http://vault-1.vault-internal:8200\"\r\n          }\r\n        }\r\n\r\n        service_registration \"kubernetes\" {}\r\n\r\n        seal \"awskms\" {\r\n          region     = \"us-east-1\"\r\n          kms_key_id = \"<aws-kms-key-id>\"\r\n        }\r\n```\r\n\r\nSide note: If you're doing this on a test environment, make sure to delete to volumes that were created on the last attempt (via `kubectl delete pvc <name of claim>`) since helm does not do that automatically.",
              "user": "calvn",
              "html_url": "https://github.com/hashicorp/vault/issues/8844#issuecomment-619292246"
            },
            {
              "id": 3271411540,
              "created_at": 1587775160000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3271411540",
              "actor": "corbesero"
            },
            {
              "id": 3271411543,
              "created_at": 1587775160000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3271411543",
              "actor": "corbesero"
            },
            {
              "id": 3271411895,
              "created_at": 1587775177000,
              "event": "labeled",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3271411895",
              "actor": "calvn",
              "label": "core/seal"
            },
            {
              "id": 619455005,
              "created_at": 1587857812000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/619455005",
              "actor": "corbesero",
              "body": "I did that.  I created a new AWS key pair with the policy to allow kms access, and vault did come up.  I  did not unseal it, but I saw log messages.  This is not exactly an identical test, since I didn't go through the step of first letting it come up w/o the awskms seal.  I will try that on Monday.\r\n\r\nBut, this does imply the vault is not happy depending on the profile of the instance role or pod OIDC from the service account.\r\n\r\nWe were really expecting to be able to use that feature since our other EKS services use that mechanism.  ",
              "user": "corbesero",
              "html_url": "https://github.com/hashicorp/vault/issues/8844#issuecomment-619455005"
            },
            {
              "id": 619999981,
              "created_at": 1587995505000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/619999981",
              "actor": "corbesero",
              "body": "I can confirm my original scenario.  I have an AWS access/secret key pair set in the helm and the secret in the namespace.  If I create a vault without the unseal stanza, it can start up.  If I then add the seal stanza, the new containers do come up.  I as able to do the migrate, and afterwards the containers did seem to do the auto unseal correctly.\r\n\r\nThis seems to strongly imply that vault is having a problem coming up when depending on the instance or service account profile instead of an explicit AWS key configuration.",
              "user": "corbesero",
              "html_url": "https://github.com/hashicorp/vault/issues/8844#issuecomment-619999981"
            },
            {
              "id": 620279325,
              "created_at": 1588028402000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/620279325",
              "actor": "calvn",
              "body": "Thanks for doing the setup to verify things! I don't want to draw conclusions yet, but it _may_ be related to https://github.com/hashicorp/vault/issues/8847 (also an issue with instance profile metadata not being picked up).",
              "user": "calvn",
              "html_url": "https://github.com/hashicorp/vault/issues/8844#issuecomment-620279325"
            },
            {
              "id": 3277920442,
              "created_at": 1588028419000,
              "event": "labeled",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3277920442",
              "actor": "calvn",
              "label": "bug"
            },
            {
              "id": 620595831,
              "created_at": 1588079331000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/620595831",
              "actor": "corbesero",
              "body": "@calvn I think it is the same issue.  I noticed #8847 recently too. When we were installing vault 1.3, the pods were only getting the instance profile of the worker node, not the role specified in the service account via the OIDC.  Our Switching to 1.4 just didn't expose the underlying profile issue until I added the aws unseal, which completely broke the instance profile being used.",
              "user": "corbesero",
              "html_url": "https://github.com/hashicorp/vault/issues/8844#issuecomment-620595831"
            },
            {
              "id": 3280235028,
              "created_at": 1588079333000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3280235028",
              "actor": "calvn"
            },
            {
              "id": 3280235032,
              "created_at": 1588079334000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3280235032",
              "actor": "calvn"
            },
            {
              "id": 622952689,
              "created_at": 1588425600000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/622952689",
              "actor": "inkblot",
              "body": "I opened #8847. I am also using an AWS KMS seal with 1.4.0, and vault successfully uses the ECS task role and not the EC2 instance profile to acquire AWS credentials for using KMS to unseal. Even so, credential acquisition is not working for the AWS auth backend.",
              "user": "inkblot",
              "html_url": "https://github.com/hashicorp/vault/issues/8844#issuecomment-622952689"
            },
            {
              "id": 623955302,
              "created_at": 1588671471000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/623955302",
              "actor": "rubroboletus",
              "body": "Any progress here? We have the same issue on AWS EKS 1.15 with OIDC mapped to serviceaccount. Creating new vault 1.4.1 from scratch, deploying from fresh git helm chart. SA is annotated according to EKS documentation, pods have AWS_ROLE_ARN and AWS_WEB_IDENTITY_TOKEN_FILE environment variables set, tokens are mounted, access to EC2 instance profile is disabled (drop any packets to 169.254.169.254).",
              "user": "rubroboletus",
              "html_url": "https://github.com/hashicorp/vault/issues/8844#issuecomment-623955302"
            },
            {
              "id": 629299441,
              "created_at": 1589555906000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/629299441",
              "actor": "kalafut",
              "body": "My comment on the linked issue might apply here too:  https://github.com/hashicorp/vault/issues/8847#issuecomment-629297745",
              "user": "kalafut",
              "html_url": "https://github.com/hashicorp/vault/issues/8844#issuecomment-629299441"
            },
            {
              "id": 631191299,
              "created_at": 1589940749000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/631191299",
              "actor": "michaeljohnalbers",
              "body": "I'm seeing pretty much the same problem, but on a manually created Kubernetes cluster (not EKS, kops or anything, just plain EC2 instances with kubeadm). As soon as I add the awskms seal Vault starts but does not output any logs (regardless of log level) nor does it open the 8200 port.\r\n\r\nI've tried attaching a completely wide open IAM role to the EC2 instance as well as using a secret key/access key pair for a role which is constrained to just the KMS operations listed in the docs. I verified these keys work with KMS operations when used with the aws cli.\r\n\r\nKubernetes version: 1.18.2\r\nVault Version: 1.4.0\r\nHelm Chart version: 0.5.0",
              "user": "michaeljohnalbers",
              "html_url": "https://github.com/hashicorp/vault/issues/8844#issuecomment-631191299"
            },
            {
              "id": 652669591,
              "created_at": 1593641204000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/652669591",
              "actor": "chancez",
              "body": "I believe https://github.com/hashicorp/vault/pull/7738 fixes this",
              "user": "chancez",
              "html_url": "https://github.com/hashicorp/vault/issues/8844#issuecomment-652669591"
            },
            {
              "id": 656924437,
              "created_at": 1594420671000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/656924437",
              "actor": "michaeljohnalbers",
              "body": "@chancez I just tried the new 1.4.3 vault image and it doesn't appear to have fixed the issue. I'm still seeing the exact same symptoms as I described above. I'm also using version 0.6.0 of the Helm chart.",
              "user": "michaeljohnalbers",
              "html_url": "https://github.com/hashicorp/vault/issues/8844#issuecomment-656924437"
            },
            {
              "id": 3535657788,
              "created_at": 1594420672000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3535657788",
              "actor": "chancez"
            },
            {
              "id": 3535657789,
              "created_at": 1594420672000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3535657789",
              "actor": "chancez"
            },
            {
              "id": 656948026,
              "created_at": 1594426926000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/656948026",
              "actor": "chancez",
              "body": "I had to set `AWS_ROLE_SESSION_NAME` to make it work with 1.4.3",
              "user": "chancez",
              "html_url": "https://github.com/hashicorp/vault/issues/8844#issuecomment-656948026"
            },
            {
              "id": 656948571,
              "created_at": 1594427098000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/656948571",
              "actor": "kalafut",
              "body": "This is good info @chancez , and relates to https://github.com/hashicorp/vault/pull/9415.",
              "user": "kalafut",
              "html_url": "https://github.com/hashicorp/vault/issues/8844#issuecomment-656948571"
            },
            {
              "id": 3535801213,
              "created_at": 1594427099000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3535801213",
              "actor": "chancez"
            },
            {
              "id": 3535801214,
              "created_at": 1594427099000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3535801214",
              "actor": "chancez"
            },
            {
              "id": 659705555,
              "created_at": 1594937901000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/659705555",
              "actor": "tvoran",
              "body": "Now that #9416 has been merged to fix #9415, setting `AWS_ROLE_SESSION_NAME` should no longer be required in vault 1.4.4 and 1.5.0 (when they're released, that is).",
              "user": "tvoran",
              "html_url": "https://github.com/hashicorp/vault/issues/8844#issuecomment-659705555"
            }
          ]
        },
        {
          "id": "657812401",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ5ODY3Mzgy",
          "number": 9495,
          "html_url": "https://github.com/hashicorp/vault/pull/9495",
          "title": "postgresql: increase max length of display name before being truncated in username",
          "user": {
            "type": "user",
            "login": "beyondbill"
          },
          "labels": [],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 1,
          "created_at": 1594869701000,
          "updated_at": 1594940222000,
          "author_association": "NONE",
          "body": "Fixes https://github.com/hashicorp/vault/issues/8560\r\n\r\nDisplay name, including auth method `oidc` and full `sub` claim in our case, is at length of 25 characters. It will be truncated to the first 8 characters today in postgresql username. We won't be able to get the full `sub` claim out of postgresql username. Since `sub` claim is the only information in postgresql username that we can use to trace user identity, we need `sub` claim in its full form within postgresql username in order to run auditing if necessary.\r\n\r\nIncreasing the threshold of truncating to 30 will solve the issue. Beyond the context of `oidc` and `sub`, the benefit is the same in general: this PR will provide better information on who requested a postgresql user from Vault.\r\n\r\nThere's already a very similar [PR](https://github.com/hashicorp/vault/pull/8582) opened but it seems abandoned without testing. I have added unit tests to make sure username generation is fully covered.",
          "events": []
        },
        {
          "id": "654443249",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ3MTcwNzg3",
          "number": 9449,
          "html_url": "https://github.com/hashicorp/vault/pull/9449",
          "title": "sdk/gomod: remove dependency on vault",
          "user": {
            "type": "user",
            "login": "calvn"
          },
          "labels": [],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 3,
          "created_at": 1594344101000,
          "updated_at": 1594941851000,
          "closed_at": 1594941848000,
          "author_association": "MEMBER",
          "body": "Due to the import of `internalshared/reloadutil` in the sdk package, we end up indirectly importing the vault package, which results in a go mod error when trying to vendor dependencies. Errors aside, we should be avoiding the import of the vault package from the sdk package since that could introduce circular dependencies. \r\n\r\n```\r\n go mod why\r\ngo: finding module for package github.com/hashicorp/vault/internalshared/reloadutil\r\ngo: finding module for package github.com/opencontainers/image-spec/specs-go/v1\r\ngo: finding module for package gotest.tools/v3/assert\r\ngo: finding module for package github.com/opencontainers/runc/libcontainer/user\r\ngo: finding module for package github.com/containerd/continuity/fs\r\ngo: finding module for package github.com/docker/go-units\r\ngo: finding module for package github.com/morikuni/aec\r\ngo: finding module for package gotest.tools/v3/skip\r\ngo: finding module for package github.com/opencontainers/runc/libcontainer/system\r\ngo: finding module for package github.com/Microsoft/go-winio\r\ngo: finding module for package github.com/gorilla/mux\r\ngo: finding module for package gotest.tools/v3/env\r\ngo: finding module for package gotest.tools/v3/assert/cmp\r\ngo: finding module for package github.com/Azure/go-ansiterm\r\ngo: finding module for package github.com/Azure/go-ansiterm/winterm\r\ngo: finding module for package github.com/Microsoft/hcsshim/osversion\r\ngo: finding module for package github.com/containerd/continuity/pathdriver\r\ngo: found github.com/hashicorp/vault/internalshared/reloadutil in github.com/hashicorp/vault v1.4.3\r\ngo: found github.com/docker/go-units in github.com/docker/go-units v0.4.0\r\ngo: found github.com/containerd/continuity/fs in github.com/containerd/continuity v0.0.0-20200709052629-daa8e1ccc0bc\r\ngo: found github.com/opencontainers/runc/libcontainer/system in github.com/opencontainers/runc v0.1.1\r\ngo: found github.com/opencontainers/image-spec/specs-go/v1 in github.com/opencontainers/image-spec v1.0.1\r\ngo: found github.com/Microsoft/go-winio in github.com/Microsoft/go-winio v0.4.14\r\ngo: found gotest.tools/v3/assert in gotest.tools/v3 v3.0.2\r\ngo: found github.com/Microsoft/hcsshim/osversion in github.com/Microsoft/hcsshim v0.8.9\r\ngo: found github.com/gorilla/mux in github.com/gorilla/mux v1.7.4\r\ngo: found github.com/morikuni/aec in github.com/morikuni/aec v1.0.0\r\ngo: found github.com/Azure/go-ansiterm/winterm in github.com/Azure/go-ansiterm v0.0.0-20170929234023-d6e3b3328b78\r\ngo: github.com/hashicorp/vault@v1.4.3 requires\r\n\tgithub.com/hashicorp/go-kms-wrapping@v0.5.1 requires\r\n\tgithub.com/hashicorp/vault/sdk@v0.1.14-0.20191229212425-c478d00be0d6: invalid version: unknown revision c478d00be0d6\r\n```\r\n\r\nThis PR addresses that by duplicating the code from `reloadutil` into the sdk package, which is fine since that package does not contain other vault-specific imports. Ideally, we would want it to live in one place, but this is the path of least resistance to make things work currently. We can update vault to use the sdk's `reloadutil` at a later point in time.",
          "milestone": {
            "id": "5107883",
            "number": 65,
            "title": "1.5"
          },
          "events": []
        },
        {
          "id": "658684224",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDUwNjE2OTEx",
          "number": 9511,
          "html_url": "https://github.com/hashicorp/vault/pull/9511",
          "title": "Docs: replaces storage backend with secrets engine in the gcp secrets docs",
          "user": {
            "type": "user",
            "login": "austingebauer"
          },
          "labels": [
            {
              "id": "1024442799",
              "node_id": "MDU6TGFiZWwxMDI0NDQyNzk5",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/docs",
              "name": "docs",
              "color": "b2ffb7",
              "description": "",
              "default": false
            },
            {
              "id": "1874015060",
              "node_id": "MDU6TGFiZWwxODc0MDE1MDYw",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/docs-cherrypick",
              "name": "docs-cherrypick",
              "color": "0e8a16",
              "description": "",
              "default": false
            },
            {
              "id": "2039543413",
              "node_id": "MDU6TGFiZWwyMDM5NTQzNDEz",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/secret/gcp",
              "name": "secret/gcp",
              "color": "59e560",
              "description": "",
              "default": false
            }
          ],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594944520000,
          "updated_at": 1594946633000,
          "closed_at": 1594946628000,
          "author_association": "MEMBER",
          "body": "This PR changes `storage backend` -> `secrets engine` in the GCP secrets engine documentation.",
          "events": []
        },
        {
          "id": "658880497",
          "node_id": "MDU6SXNzdWU2NTg4ODA0OTc=",
          "number": 9513,
          "html_url": "https://github.com/hashicorp/vault/issues/9513",
          "title": "Okta MFA - Better error handling in the response from Okta",
          "user": {
            "type": "user",
            "login": "RyanSiu1995"
          },
          "labels": [],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594963653000,
          "updated_at": 1594963653000,
          "author_association": "NONE",
          "body": "**Is your feature request related to a problem? Please describe.**\r\nMy current company makes use of the Okta MFA in auth/okta feature.\r\nBut the error message/indicator is not useful for those who are first using this.\r\nThe current MFA in Okta does not properly handle the response. \r\nFor example, if the User does not complete the MFA with Okta verify app, the error will be shown as the following.\r\n```\r\nAuthentication failed: <html> <head><title>504 Gateway Time-out</title></head> <body> <center><h1>504 Gateway Time-out</h1></center> <hr><center>nginx/1.17.7</center> </body> </html> <!-- a padding to disable MSIE and Chrome friendly error page --> <!-- a padding to disable MSIE and Chrome friendly error page --> <!-- a padding to disable MSIE and Chrome friendly error page --> <!-- a padding to disable MSIE and Chrome friendly error page --> <!-- a padding to disable MSIE and Chrome friendly error page --> <!-- a padding to disable MSIE and Chrome friendly error page -->\r\n```\r\n\r\n**Describe the solution you'd like**\r\nThis feature is particular made for Okta response so I believe that we could collect the possible result and handle them gratefully instead of direct printing the error message from Okta response.\r\n\r\n",
          "events": []
        },
        {
          "id": "578003958",
          "node_id": "MDExOlB1bGxSZXF1ZXN0Mzg1NjY0ODY1",
          "number": 8509,
          "html_url": "https://github.com/hashicorp/vault/pull/8509",
          "title": "Add option allowed_domains_template enabling identity templating for issuing PKI certs",
          "user": {
            "type": "user",
            "login": "andrejvanderzee"
          },
          "labels": [
            {
              "id": "1658610325",
              "node_id": "MDU6TGFiZWwxNjU4NjEwMzI1",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/secret/pki",
              "name": "secret/pki",
              "color": "59e560",
              "description": "",
              "default": false
            }
          ],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 17,
          "created_at": 1583768666000,
          "updated_at": 1594968534000,
          "closed_at": 1594227146000,
          "author_association": "CONTRIBUTOR",
          "body": "Implementation of identity templating when issuing a PKI cert using the exported sdk/framework merged in  #8088\r\n\r\nDuplicate of #6558\r\n\r\nSimilar to  #7548",
          "milestone": {
            "id": "5563100",
            "number": 73,
            "title": "1.5.1"
          },
          "events": [
            {
              "id": 3111233206,
              "created_at": 1583768723000,
              "event": "renamed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3111233206",
              "actor": "andrejvanderzee",
              "rename": {
                "from": "Added option allowed_domains_template enabling identity templating for issuing PKI ",
                "to": "Added option allowed_domains_template enabling identity templating for issuing PKI certs"
              }
            },
            {
              "id": 597310482,
              "created_at": 1583873794000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/597310482",
              "actor": "andrejvanderzee",
              "body": "@jefferai Any chance merging the long-awaited closure of security hole of spoofing CNs in issuing x509 certificates?",
              "user": "andrejvanderzee",
              "html_url": "https://github.com/hashicorp/vault/pull/8509#issuecomment-597310482"
            },
            {
              "id": 3116419527,
              "created_at": 1583873794000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3116419527",
              "actor": "jefferai"
            },
            {
              "id": 3116419529,
              "created_at": 1583873794000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3116419529",
              "actor": "jefferai"
            },
            {
              "id": 3149778183,
              "created_at": 1584717919000,
              "event": "labeled",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3149778183",
              "actor": "vishalnayak",
              "label": "secret/pki"
            },
            {
              "id": 614149621,
              "created_at": 1586968915000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/614149621",
              "actor": "tyrannosaurus-becks",
              "body": "Hi! Thanks for submitting this pull request. \r\n\r\nI notice there are some test failures that appear related:\r\n```\r\n=== Errors\r\nbuiltin/logical/pki/cert_util_test.go:149:35: not enough arguments in call to generateCreationBundle\r\n\thave (*backend, *inputBundle, nil, nil)\r\n\twant (*backend, *logical.Request, *inputBundle, *certutil.CAInfoBundle, *x509.CertificateRequest)\r\nbuiltin/logical/pki/cert_util_test.go:181:35: not enough arguments in call to generateCreationBundle\r\n\thave (*backend, *inputBundle, nil, nil)\r\n\twant (*backend, *logical.Request, *inputBundle, *certutil.CAInfoBundle, *x509.CertificateRequest)\r\n```\r\n\r\nHappy to take a closer look after the tests are passing.",
              "user": "tyrannosaurus-becks",
              "html_url": "https://github.com/hashicorp/vault/pull/8509#issuecomment-614149621"
            },
            {
              "id": 630674485,
              "created_at": 1589877486000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/630674485",
              "actor": "qk4l",
              "body": "@andrejvanderzee , thank you for non stoping decision in implementation this features. As I've counted it's third PR and I hope the last one. =)\r\n\r\nCould you please provide status info, if you have time to finish it, so we all can finally use this must-have feature?\r\n\r\nThanks again for you work.",
              "user": "qk4l",
              "html_url": "https://github.com/hashicorp/vault/pull/8509#issuecomment-630674485"
            },
            {
              "id": 3350734118,
              "created_at": 1589877487000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3350734118",
              "actor": "andrejvanderzee"
            },
            {
              "id": 3350734121,
              "created_at": 1589877487000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3350734121",
              "actor": "andrejvanderzee"
            },
            {
              "id": 630686610,
              "created_at": 1589878765000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/630686610",
              "actor": "andrejvanderzee",
              "body": "@qk4l Thanks, let me fix the comments today. ",
              "user": "andrejvanderzee",
              "html_url": "https://github.com/hashicorp/vault/pull/8509#issuecomment-630686610"
            },
            {
              "id": 3350824892,
              "created_at": 1589878765000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3350824892",
              "actor": "qk4l"
            },
            {
              "id": 3350824895,
              "created_at": 1589878765000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3350824895",
              "actor": "qk4l"
            },
            {
              "id": 3350865511,
              "created_at": 1589879352000,
              "event": "head_ref_force_pushed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3350865511",
              "actor": "andrejvanderzee"
            },
            {
              "id": 3351039293,
              "created_at": 1589881994000,
              "event": "head_ref_force_pushed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3351039293",
              "actor": "andrejvanderzee"
            },
            {
              "id": 630748979,
              "created_at": 1589886355000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/630748979",
              "actor": "andrejvanderzee",
              "body": "Hi @qk4l and @tyrannosaurus-becks  I have pushed fixes for the failing test.\r\n\r\nNow `test-go-race` is failing on the new raft storage. That is not related to this PR I assume?",
              "user": "andrejvanderzee",
              "html_url": "https://github.com/hashicorp/vault/pull/8509#issuecomment-630748979"
            },
            {
              "id": 3351303315,
              "created_at": 1589886355000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3351303315",
              "actor": "tyrannosaurus-becks"
            },
            {
              "id": 3351303318,
              "created_at": 1589886355000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3351303318",
              "actor": "tyrannosaurus-becks"
            },
            {
              "id": 3351303320,
              "created_at": 1589886355000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3351303320",
              "actor": "qk4l"
            },
            {
              "id": 3351303321,
              "created_at": 1589886355000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3351303321",
              "actor": "qk4l"
            },
            {
              "id": 3353311297,
              "created_at": 1589915202000,
              "event": "renamed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3353311297",
              "actor": "andrejvanderzee",
              "rename": {
                "from": "Added option allowed_domains_template enabling identity templating for issuing PKI certs",
                "to": "Add option allowed_domains_template enabling identity templating for issuing PKI certs"
              }
            },
            {
              "id": 3353332112,
              "created_at": 1589915565000,
              "event": "head_ref_force_pushed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3353332112",
              "actor": "andrejvanderzee"
            },
            {
              "id": 3353338179,
              "created_at": 1589915667000,
              "event": "head_ref_force_pushed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3353338179",
              "actor": "andrejvanderzee"
            },
            {
              "id": 631028872,
              "created_at": 1589915885000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/631028872",
              "actor": "andrejvanderzee",
              "body": "Minimized the PR and pushed again...",
              "user": "andrejvanderzee",
              "html_url": "https://github.com/hashicorp/vault/pull/8509#issuecomment-631028872"
            },
            {
              "id": 634675749,
              "created_at": 1590587519000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/634675749",
              "actor": "andrejvanderzee",
              "body": "Hi @qk4l and @tyrannosaurus-becks any update on this MR?",
              "user": "andrejvanderzee",
              "html_url": "https://github.com/hashicorp/vault/pull/8509#issuecomment-634675749"
            },
            {
              "id": 3378247375,
              "created_at": 1590587519000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3378247375",
              "actor": "tyrannosaurus-becks"
            },
            {
              "id": 3378247382,
              "created_at": 1590587519000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3378247382",
              "actor": "tyrannosaurus-becks"
            },
            {
              "id": 3378247398,
              "created_at": 1590587519000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3378247398",
              "actor": "qk4l"
            },
            {
              "id": 3378247400,
              "created_at": 1590587519000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3378247400",
              "actor": "qk4l"
            },
            {
              "created_at": 1591625695000,
              "event": "cross-referenced",
              "actor": "ncabatoff",
              "source": {
                "type": "issue",
                "issue": {
                  "url": "https://api.github.com/repos/hashicorp/vault/issues/6558",
                  "repository_url": "https://api.github.com/repos/hashicorp/vault",
                  "labels_url": "https://api.github.com/repos/hashicorp/vault/issues/6558/labels{/name}",
                  "comments_url": "https://api.github.com/repos/hashicorp/vault/issues/6558/comments",
                  "events_url": "https://api.github.com/repos/hashicorp/vault/issues/6558/events",
                  "html_url": "https://github.com/hashicorp/vault/pull/6558",
                  "id": 431201722,
                  "node_id": "MDExOlB1bGxSZXF1ZXN0MjY4OTI5MTY2",
                  "number": 6558,
                  "title": "[Do not merge] Identity templating support for allowed_domains-option for PKI secret engine's issue API call",
                  "user": {
                    "login": "andrejvanderzee",
                    "id": 1555310,
                    "node_id": "MDQ6VXNlcjE1NTUzMTA=",
                    "avatar_url": "https://avatars0.githubusercontent.com/u/1555310?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/andrejvanderzee",
                    "html_url": "https://github.com/andrejvanderzee",
                    "followers_url": "https://api.github.com/users/andrejvanderzee/followers",
                    "following_url": "https://api.github.com/users/andrejvanderzee/following{/other_user}",
                    "gists_url": "https://api.github.com/users/andrejvanderzee/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/andrejvanderzee/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/andrejvanderzee/subscriptions",
                    "organizations_url": "https://api.github.com/users/andrejvanderzee/orgs",
                    "repos_url": "https://api.github.com/users/andrejvanderzee/repos",
                    "events_url": "https://api.github.com/users/andrejvanderzee/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/andrejvanderzee/received_events",
                    "type": "User",
                    "site_admin": false
                  },
                  "labels": [
                    {
                      "id": 1934459558,
                      "node_id": "MDU6TGFiZWwxOTM0NDU5NTU4",
                      "url": "https://api.github.com/repos/hashicorp/vault/labels/do-not-merge",
                      "name": "do-not-merge",
                      "color": "ff0000",
                      "default": false,
                      "description": ""
                    },
                    {
                      "id": 1488905226,
                      "node_id": "MDU6TGFiZWwxNDg4OTA1MjI2",
                      "url": "https://api.github.com/repos/hashicorp/vault/labels/enhancement",
                      "name": "enhancement",
                      "color": "0d8232",
                      "default": true,
                      "description": ""
                    },
                    {
                      "id": 1658610325,
                      "node_id": "MDU6TGFiZWwxNjU4NjEwMzI1",
                      "url": "https://api.github.com/repos/hashicorp/vault/labels/secret/pki",
                      "name": "secret/pki",
                      "color": "59e560",
                      "default": false,
                      "description": ""
                    }
                  ],
                  "state": "closed",
                  "locked": false,
                  "assignees": [],
                  "comments": 11,
                  "created_at": "2019-04-09T21:19:20Z",
                  "updated_at": "2020-06-12T13:25:05Z",
                  "closed_at": "2020-06-12T13:25:04Z",
                  "author_association": "CONTRIBUTOR",
                  "repository": {
                    "id": 31288958,
                    "node_id": "MDEwOlJlcG9zaXRvcnkzMTI4ODk1OA==",
                    "name": "vault",
                    "full_name": "hashicorp/vault",
                    "private": false,
                    "owner": {
                      "login": "hashicorp",
                      "id": 761456,
                      "node_id": "MDEyOk9yZ2FuaXphdGlvbjc2MTQ1Ng==",
                      "avatar_url": "https://avatars2.githubusercontent.com/u/761456?v=4",
                      "gravatar_id": "",
                      "url": "https://api.github.com/users/hashicorp",
                      "html_url": "https://github.com/hashicorp",
                      "followers_url": "https://api.github.com/users/hashicorp/followers",
                      "following_url": "https://api.github.com/users/hashicorp/following{/other_user}",
                      "gists_url": "https://api.github.com/users/hashicorp/gists{/gist_id}",
                      "starred_url": "https://api.github.com/users/hashicorp/starred{/owner}{/repo}",
                      "subscriptions_url": "https://api.github.com/users/hashicorp/subscriptions",
                      "organizations_url": "https://api.github.com/users/hashicorp/orgs",
                      "repos_url": "https://api.github.com/users/hashicorp/repos",
                      "events_url": "https://api.github.com/users/hashicorp/events{/privacy}",
                      "received_events_url": "https://api.github.com/users/hashicorp/received_events",
                      "type": "Organization",
                      "site_admin": false
                    },
                    "html_url": "https://github.com/hashicorp/vault",
                    "description": "A tool for secrets management, encryption as a service, and privileged access management",
                    "fork": false,
                    "url": "https://api.github.com/repos/hashicorp/vault",
                    "forks_url": "https://api.github.com/repos/hashicorp/vault/forks",
                    "keys_url": "https://api.github.com/repos/hashicorp/vault/keys{/key_id}",
                    "collaborators_url": "https://api.github.com/repos/hashicorp/vault/collaborators{/collaborator}",
                    "teams_url": "https://api.github.com/repos/hashicorp/vault/teams",
                    "hooks_url": "https://api.github.com/repos/hashicorp/vault/hooks",
                    "issue_events_url": "https://api.github.com/repos/hashicorp/vault/issues/events{/number}",
                    "events_url": "https://api.github.com/repos/hashicorp/vault/events",
                    "assignees_url": "https://api.github.com/repos/hashicorp/vault/assignees{/user}",
                    "branches_url": "https://api.github.com/repos/hashicorp/vault/branches{/branch}",
                    "tags_url": "https://api.github.com/repos/hashicorp/vault/tags",
                    "blobs_url": "https://api.github.com/repos/hashicorp/vault/git/blobs{/sha}",
                    "git_tags_url": "https://api.github.com/repos/hashicorp/vault/git/tags{/sha}",
                    "git_refs_url": "https://api.github.com/repos/hashicorp/vault/git/refs{/sha}",
                    "trees_url": "https://api.github.com/repos/hashicorp/vault/git/trees{/sha}",
                    "statuses_url": "https://api.github.com/repos/hashicorp/vault/statuses/{sha}",
                    "languages_url": "https://api.github.com/repos/hashicorp/vault/languages",
                    "stargazers_url": "https://api.github.com/repos/hashicorp/vault/stargazers",
                    "contributors_url": "https://api.github.com/repos/hashicorp/vault/contributors",
                    "subscribers_url": "https://api.github.com/repos/hashicorp/vault/subscribers",
                    "subscription_url": "https://api.github.com/repos/hashicorp/vault/subscription",
                    "commits_url": "https://api.github.com/repos/hashicorp/vault/commits{/sha}",
                    "git_commits_url": "https://api.github.com/repos/hashicorp/vault/git/commits{/sha}",
                    "comments_url": "https://api.github.com/repos/hashicorp/vault/comments{/number}",
                    "issue_comment_url": "https://api.github.com/repos/hashicorp/vault/issues/comments{/number}",
                    "contents_url": "https://api.github.com/repos/hashicorp/vault/contents/{+path}",
                    "compare_url": "https://api.github.com/repos/hashicorp/vault/compare/{base}...{head}",
                    "merges_url": "https://api.github.com/repos/hashicorp/vault/merges",
                    "archive_url": "https://api.github.com/repos/hashicorp/vault/{archive_format}{/ref}",
                    "downloads_url": "https://api.github.com/repos/hashicorp/vault/downloads",
                    "issues_url": "https://api.github.com/repos/hashicorp/vault/issues{/number}",
                    "pulls_url": "https://api.github.com/repos/hashicorp/vault/pulls{/number}",
                    "milestones_url": "https://api.github.com/repos/hashicorp/vault/milestones{/number}",
                    "notifications_url": "https://api.github.com/repos/hashicorp/vault/notifications{?since,all,participating}",
                    "labels_url": "https://api.github.com/repos/hashicorp/vault/labels{/name}",
                    "releases_url": "https://api.github.com/repos/hashicorp/vault/releases{/id}",
                    "deployments_url": "https://api.github.com/repos/hashicorp/vault/deployments",
                    "created_at": "2015-02-25T00:15:59Z",
                    "updated_at": "2020-07-17T20:30:27Z",
                    "pushed_at": "2020-07-17T20:57:34Z",
                    "git_url": "git://github.com/hashicorp/vault.git",
                    "ssh_url": "git@github.com:hashicorp/vault.git",
                    "clone_url": "https://github.com/hashicorp/vault.git",
                    "svn_url": "https://github.com/hashicorp/vault",
                    "homepage": "https://www.vaultproject.io/",
                    "size": 123698,
                    "stargazers_count": 16436,
                    "watchers_count": 16436,
                    "language": "Go",
                    "has_issues": true,
                    "has_projects": false,
                    "has_downloads": true,
                    "has_wiki": false,
                    "has_pages": false,
                    "forks_count": 2534,
                    "archived": false,
                    "disabled": false,
                    "open_issues_count": 708,
                    "license": {
                      "key": "mpl-2.0",
                      "name": "Mozilla Public License 2.0",
                      "spdx_id": "MPL-2.0",
                      "url": "https://api.github.com/licenses/mpl-2.0",
                      "node_id": "MDc6TGljZW5zZTE0"
                    },
                    "forks": 2534,
                    "open_issues": 708,
                    "watchers": 16436,
                    "default_branch": "master"
                  },
                  "pull_request": {
                    "url": "https://api.github.com/repos/hashicorp/vault/pulls/6558",
                    "html_url": "https://github.com/hashicorp/vault/pull/6558",
                    "diff_url": "https://github.com/hashicorp/vault/pull/6558.diff",
                    "patch_url": "https://github.com/hashicorp/vault/pull/6558.patch"
                  },
                  "body": "This MR applies identity templating to the `allowed_domains` option of the PKI secret engine's `issue` API call. For example, the PKI secret engine configuration below only allows domains that are equal to the auth method alias's name. \r\n\r\n```\r\nsecret_engine \"k8s-apiserver\" {\r\n   ...\r\n  path \"roles/devops\" {\r\n    allowed_domains = \"{{identity.entity.aliases.auth_plugin_05c79452.name}}\"\r\n    enforce_hostnames = false\r\n    allow_bare_domains = true\r\n    server_flag = false\r\n    client_flag = true\r\n  }\r\n}\r\n```\r\n\r\nThis is an improvement over the `allow_token_displayname`, which is considered insecure and deprecated, in favor of using exported entity data with more attributes like aliases and metadata, from the authentication methods to secret engines.\r\n\r\nWe have tested the MR at our testing environment, and it works as a solution for #6457.\r\n"
                }
              }
            },
            {
              "created_at": 1591625717000,
              "event": "cross-referenced",
              "actor": "ncabatoff",
              "source": {
                "type": "issue",
                "issue": {
                  "url": "https://api.github.com/repos/hashicorp/vault/issues/7216",
                  "repository_url": "https://api.github.com/repos/hashicorp/vault",
                  "labels_url": "https://api.github.com/repos/hashicorp/vault/issues/7216/labels{/name}",
                  "comments_url": "https://api.github.com/repos/hashicorp/vault/issues/7216/comments",
                  "events_url": "https://api.github.com/repos/hashicorp/vault/issues/7216/events",
                  "html_url": "https://github.com/hashicorp/vault/pull/7216",
                  "id": 474706302,
                  "node_id": "MDExOlB1bGxSZXF1ZXN0MzAyNTk3ODI5",
                  "number": 7216,
                  "title": "[Do not merge] Identity templating for PKI roles allowed_domains and allowed_uri_sans",
                  "user": {
                    "login": "jdollard",
                    "id": 140834,
                    "node_id": "MDQ6VXNlcjE0MDgzNA==",
                    "avatar_url": "https://avatars0.githubusercontent.com/u/140834?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/jdollard",
                    "html_url": "https://github.com/jdollard",
                    "followers_url": "https://api.github.com/users/jdollard/followers",
                    "following_url": "https://api.github.com/users/jdollard/following{/other_user}",
                    "gists_url": "https://api.github.com/users/jdollard/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/jdollard/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/jdollard/subscriptions",
                    "organizations_url": "https://api.github.com/users/jdollard/orgs",
                    "repos_url": "https://api.github.com/users/jdollard/repos",
                    "events_url": "https://api.github.com/users/jdollard/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/jdollard/received_events",
                    "type": "User",
                    "site_admin": false
                  },
                  "labels": [
                    {
                      "id": 1934459558,
                      "node_id": "MDU6TGFiZWwxOTM0NDU5NTU4",
                      "url": "https://api.github.com/repos/hashicorp/vault/labels/do-not-merge",
                      "name": "do-not-merge",
                      "color": "ff0000",
                      "default": false,
                      "description": ""
                    },
                    {
                      "id": 1658610325,
                      "node_id": "MDU6TGFiZWwxNjU4NjEwMzI1",
                      "url": "https://api.github.com/repos/hashicorp/vault/labels/secret/pki",
                      "name": "secret/pki",
                      "color": "59e560",
                      "default": false,
                      "description": ""
                    }
                  ],
                  "state": "open",
                  "locked": false,
                  "assignees": [],
                  "comments": 8,
                  "created_at": "2019-07-30T17:20:54Z",
                  "updated_at": "2020-07-01T16:16:50Z",
                  "author_association": "CONTRIBUTOR",
                  "repository": {
                    "id": 31288958,
                    "node_id": "MDEwOlJlcG9zaXRvcnkzMTI4ODk1OA==",
                    "name": "vault",
                    "full_name": "hashicorp/vault",
                    "private": false,
                    "owner": {
                      "login": "hashicorp",
                      "id": 761456,
                      "node_id": "MDEyOk9yZ2FuaXphdGlvbjc2MTQ1Ng==",
                      "avatar_url": "https://avatars2.githubusercontent.com/u/761456?v=4",
                      "gravatar_id": "",
                      "url": "https://api.github.com/users/hashicorp",
                      "html_url": "https://github.com/hashicorp",
                      "followers_url": "https://api.github.com/users/hashicorp/followers",
                      "following_url": "https://api.github.com/users/hashicorp/following{/other_user}",
                      "gists_url": "https://api.github.com/users/hashicorp/gists{/gist_id}",
                      "starred_url": "https://api.github.com/users/hashicorp/starred{/owner}{/repo}",
                      "subscriptions_url": "https://api.github.com/users/hashicorp/subscriptions",
                      "organizations_url": "https://api.github.com/users/hashicorp/orgs",
                      "repos_url": "https://api.github.com/users/hashicorp/repos",
                      "events_url": "https://api.github.com/users/hashicorp/events{/privacy}",
                      "received_events_url": "https://api.github.com/users/hashicorp/received_events",
                      "type": "Organization",
                      "site_admin": false
                    },
                    "html_url": "https://github.com/hashicorp/vault",
                    "description": "A tool for secrets management, encryption as a service, and privileged access management",
                    "fork": false,
                    "url": "https://api.github.com/repos/hashicorp/vault",
                    "forks_url": "https://api.github.com/repos/hashicorp/vault/forks",
                    "keys_url": "https://api.github.com/repos/hashicorp/vault/keys{/key_id}",
                    "collaborators_url": "https://api.github.com/repos/hashicorp/vault/collaborators{/collaborator}",
                    "teams_url": "https://api.github.com/repos/hashicorp/vault/teams",
                    "hooks_url": "https://api.github.com/repos/hashicorp/vault/hooks",
                    "issue_events_url": "https://api.github.com/repos/hashicorp/vault/issues/events{/number}",
                    "events_url": "https://api.github.com/repos/hashicorp/vault/events",
                    "assignees_url": "https://api.github.com/repos/hashicorp/vault/assignees{/user}",
                    "branches_url": "https://api.github.com/repos/hashicorp/vault/branches{/branch}",
                    "tags_url": "https://api.github.com/repos/hashicorp/vault/tags",
                    "blobs_url": "https://api.github.com/repos/hashicorp/vault/git/blobs{/sha}",
                    "git_tags_url": "https://api.github.com/repos/hashicorp/vault/git/tags{/sha}",
                    "git_refs_url": "https://api.github.com/repos/hashicorp/vault/git/refs{/sha}",
                    "trees_url": "https://api.github.com/repos/hashicorp/vault/git/trees{/sha}",
                    "statuses_url": "https://api.github.com/repos/hashicorp/vault/statuses/{sha}",
                    "languages_url": "https://api.github.com/repos/hashicorp/vault/languages",
                    "stargazers_url": "https://api.github.com/repos/hashicorp/vault/stargazers",
                    "contributors_url": "https://api.github.com/repos/hashicorp/vault/contributors",
                    "subscribers_url": "https://api.github.com/repos/hashicorp/vault/subscribers",
                    "subscription_url": "https://api.github.com/repos/hashicorp/vault/subscription",
                    "commits_url": "https://api.github.com/repos/hashicorp/vault/commits{/sha}",
                    "git_commits_url": "https://api.github.com/repos/hashicorp/vault/git/commits{/sha}",
                    "comments_url": "https://api.github.com/repos/hashicorp/vault/comments{/number}",
                    "issue_comment_url": "https://api.github.com/repos/hashicorp/vault/issues/comments{/number}",
                    "contents_url": "https://api.github.com/repos/hashicorp/vault/contents/{+path}",
                    "compare_url": "https://api.github.com/repos/hashicorp/vault/compare/{base}...{head}",
                    "merges_url": "https://api.github.com/repos/hashicorp/vault/merges",
                    "archive_url": "https://api.github.com/repos/hashicorp/vault/{archive_format}{/ref}",
                    "downloads_url": "https://api.github.com/repos/hashicorp/vault/downloads",
                    "issues_url": "https://api.github.com/repos/hashicorp/vault/issues{/number}",
                    "pulls_url": "https://api.github.com/repos/hashicorp/vault/pulls{/number}",
                    "milestones_url": "https://api.github.com/repos/hashicorp/vault/milestones{/number}",
                    "notifications_url": "https://api.github.com/repos/hashicorp/vault/notifications{?since,all,participating}",
                    "labels_url": "https://api.github.com/repos/hashicorp/vault/labels{/name}",
                    "releases_url": "https://api.github.com/repos/hashicorp/vault/releases{/id}",
                    "deployments_url": "https://api.github.com/repos/hashicorp/vault/deployments",
                    "created_at": "2015-02-25T00:15:59Z",
                    "updated_at": "2020-07-17T20:30:27Z",
                    "pushed_at": "2020-07-17T20:57:34Z",
                    "git_url": "git://github.com/hashicorp/vault.git",
                    "ssh_url": "git@github.com:hashicorp/vault.git",
                    "clone_url": "https://github.com/hashicorp/vault.git",
                    "svn_url": "https://github.com/hashicorp/vault",
                    "homepage": "https://www.vaultproject.io/",
                    "size": 123698,
                    "stargazers_count": 16436,
                    "watchers_count": 16436,
                    "language": "Go",
                    "has_issues": true,
                    "has_projects": false,
                    "has_downloads": true,
                    "has_wiki": false,
                    "has_pages": false,
                    "forks_count": 2534,
                    "archived": false,
                    "disabled": false,
                    "open_issues_count": 708,
                    "license": {
                      "key": "mpl-2.0",
                      "name": "Mozilla Public License 2.0",
                      "spdx_id": "MPL-2.0",
                      "url": "https://api.github.com/licenses/mpl-2.0",
                      "node_id": "MDc6TGljZW5zZTE0"
                    },
                    "forks": 2534,
                    "open_issues": 708,
                    "watchers": 16436,
                    "default_branch": "master"
                  },
                  "pull_request": {
                    "url": "https://api.github.com/repos/hashicorp/vault/pulls/7216",
                    "html_url": "https://github.com/hashicorp/vault/pull/7216",
                    "diff_url": "https://github.com/hashicorp/vault/pull/7216.diff",
                    "patch_url": "https://github.com/hashicorp/vault/pull/7216.patch"
                  },
                  "body": "This PR expands upon PR 6558.  It adds support for identity templating in the allowed_domains and uri_sans options of PKI engine roles.  \r\n\r\nSample role configuration that leverages this templating functionality:\r\nvault write pki/roles/foo \\\r\n  allowed_domains='{{identity.entity.aliases.auth_userpass_d908e1ec.name}}.foo.com' \\\r\n  allowed_uri_sans='spiffe://foo.com/{{identity.entity.aliases.auth_userpass_d908e1ec.name}}' \\\r\n  allow_subdomains=true\r\n"
                }
              }
            },
            {
              "id": 640643393,
              "created_at": 1591625732000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/640643393",
              "actor": "ncabatoff",
              "body": "Thank you for working on this feature, it is clearly in high demand.  We're sorry it took so long to come to a consensus internally on how to proceed, but we finally have.  As you may be aware, there are currently 2 open PRs trying to implement identity templating for PKI, of which yours is one: #7216 and #8509.  It would be great if you would coordinate amongst yourselves to see who has the time and inclination to move forward with the proposal.\r\n\r\nThe proposal:\r\n\r\n* Add a boolean role option `allowed_domains_template` to control whether the `allowed_domains` option will be interpreted as possibly containing an identity template that should be expanded.  This will provide consistency with what was done in the ssh secrets engine with the `allowed_users_template` parameter (#7548).\r\n* This looks a bit like what #8509 is doing, but in #8509 `allowed_domains_template` is a string that is given as an alternative to `allowed_domains`, rather than a toggle that controls how `allowed_domains` is interpreted.\r\n\r\nOther requirements:\r\n* There need to be tests that exercise the new behaviour; there may be other tests as well, but there should be at least one that actually exercises the full behaviour, i.e. create a role with `allowed_domains_template=true`, then try to generate certs with that role that rely on the expanded template and cover both the happy path (e.g. CN in the cert request matches expanded `allowed_domains`) and the less happy paths.  `TestBackend_URI_SANs` is a decent example of the pattern we have in mind.\r\n* Use the framework method `PopulateIdentityTemplate.`\r\n\r\nNot a strict requirement but a suggestion: limit the PR to `allowed_domains`.  #7216 includes templating for  `allowed_uri_sans`. This isn't a deal breaker, but the more narrowly focused the PR, the easier it will be to get it approved.  We would prefer to see `allowed_uri_sans` handled in a separate PR (in the same way, with a new `allowed_uri_sans_template` role option.)",
              "user": "ncabatoff",
              "html_url": "https://github.com/hashicorp/vault/pull/8509#issuecomment-640643393"
            },
            {
              "id": 3428342983,
              "created_at": 1591775805000,
              "event": "head_ref_force_pushed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3428342983",
              "actor": "andrejvanderzee"
            },
            {
              "id": 3474088266,
              "created_at": 1592934297000,
              "event": "head_ref_force_pushed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3474088266",
              "actor": "andrejvanderzee"
            },
            {
              "id": 3474105469,
              "created_at": 1592934549000,
              "event": "head_ref_force_pushed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3474105469",
              "actor": "andrejvanderzee"
            },
            {
              "id": 3474131634,
              "created_at": 1592934890000,
              "event": "head_ref_force_pushed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3474131634",
              "actor": "andrejvanderzee"
            },
            {
              "id": 648328417,
              "created_at": 1592935687000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/648328417",
              "actor": "andrejvanderzee",
              "body": "@ncabatoff Sorry for the delay it was a busy time for me. \r\n\r\nToday I was ably to implement the requirements that you have sent in your last post. Please let me know if something is still missing or not according to standards. \r\n\r\nThank you.",
              "user": "andrejvanderzee",
              "html_url": "https://github.com/hashicorp/vault/pull/8509#issuecomment-648328417"
            },
            {
              "id": 3474188316,
              "created_at": 1592935687000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3474188316",
              "actor": "ncabatoff"
            },
            {
              "id": 3474188321,
              "created_at": 1592935687000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3474188321",
              "actor": "ncabatoff"
            },
            {
              "id": 3474227260,
              "created_at": 1592936357000,
              "event": "head_ref_force_pushed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3474227260",
              "actor": "andrejvanderzee"
            },
            {
              "id": 3485524027,
              "created_at": 1593158050000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3485524027",
              "actor": "whiteley"
            },
            {
              "id": 655451554,
              "created_at": 1594206635000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/655451554",
              "actor": "andrejvanderzee",
              "body": "Hi @ncabatoff  @qk4l  @tyrannosaurus-becks \r\nAny update on this MR?",
              "user": "andrejvanderzee",
              "html_url": "https://github.com/hashicorp/vault/pull/8509#issuecomment-655451554"
            },
            {
              "id": 3524690013,
              "created_at": 1594206635000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3524690013",
              "actor": "tyrannosaurus-becks"
            },
            {
              "id": 3524690015,
              "created_at": 1594206635000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3524690015",
              "actor": "tyrannosaurus-becks"
            },
            {
              "id": 3524690023,
              "created_at": 1594206635000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3524690023",
              "actor": "ncabatoff"
            },
            {
              "id": 3524690029,
              "created_at": 1594206635000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3524690029",
              "actor": "ncabatoff"
            },
            {
              "id": 3524690031,
              "created_at": 1594206635000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3524690031",
              "actor": "qk4l"
            },
            {
              "id": 3524690036,
              "created_at": 1594206635000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3524690036",
              "actor": "qk4l"
            }
          ]
        },
        {
          "id": "659135099",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDUxMDE4MTM1",
          "number": 9514,
          "html_url": "https://github.com/hashicorp/vault/pull/9514",
          "title": "replace .Data.[key] with .Data.data.[key]",
          "user": {
            "type": "user",
            "login": "oneacl"
          },
          "labels": [],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 1,
          "created_at": 1594982617000,
          "updated_at": 1594982620000,
          "author_association": "NONE",
          "body": "Line 267 was correctly templating .Data.data.key but on the other lines the second .data was missing.",
          "events": []
        },
        {
          "id": "658491091",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDUwNDQ2ODA0",
          "number": 9506,
          "html_url": "https://github.com/hashicorp/vault/pull/9506",
          "title": "add upgrade sequence for DR and PR clusters to Upgrade Overview page",
          "user": {
            "type": "user",
            "login": "dedamico"
          },
          "labels": [],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594927380000,
          "updated_at": 1594986165000,
          "author_association": "CONTRIBUTOR",
          "body": "We were going to originally put this in the HC KB but thought it would be more appropriate to be in the Vault overview doc.  Thanks!",
          "events": []
        },
        {
          "id": "657227611",
          "node_id": "MDU6SXNzdWU2NTcyMjc2MTE=",
          "number": 9484,
          "html_url": "https://github.com/hashicorp/vault/issues/9484",
          "title": "VAULT_RAFT_PATH env var does not work or docs are unclear",
          "user": {
            "type": "user",
            "login": "srhb"
          },
          "labels": [],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 1,
          "created_at": 1594807454000,
          "updated_at": 1594990685000,
          "author_association": "NONE",
          "body": "<!-- Please reserve GitHub issues for bug reports and feature requests.\r\n\r\nFor questions, the best place to get answers is on our [discussion forum](https://discuss.hashicorp.com/c/vault), as they will get more visibility from experienced users than the issue tracker.\r\n\r\nPlease note: We take Vault's security and our users' trust very seriously. If you believe you have found a security issue in Vault, please responsibly disclose by contacting us at security@hashicorp.com. Our PGP key is available at [our security page](https://www.hashicorp.com/security/).\r\n\r\n-->\r\n\r\n**Describe the bug**\r\nAccording to the raft backend docs,\r\n\r\n> path (string: \"\")  The file system path where all the Vault data gets stored. This value can be overridden by setting the VAULT_RAFT_PATH environment variable.\r\n\r\nHowever, unless overridden really means \"you must still set the option in the config file\", it appears that `NewFSM` prevents the use of `VAULT_RAFT_PATH` because the env var is never checked there before bailing. https://github.com/hashicorp/vault/blob/3118ed77b72c3367ebfbcdb73a41f96f70b5e05d/physical/raft/fsm.go#L89-L92\r\n\r\nLikely, either `NewFSM` should also get the env var, or the documentation should be fixed.\r\n\r\n**To Reproduce**\r\nSet `VAULT_RAFT_PATH`. Do not set path in config.\r\nStart vault.\r\n\r\n**Expected behavior**\r\nVault starts up as if path were defined with the same value as `VAULT_RAFT_PATH`\r\n\r\n**Actual behaviour**\r\n`Error initializing storage of type raft: failed to create fsm: 'path' must be set`\r\n\r\n**Environment:**\r\n* Vault Server Version 1.3.6",
          "events": [
            {
              "id": 660092219,
              "created_at": 1594990685000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/660092219",
              "actor": "aphorise",
              "body": ">     * Vault Server Version 1.3.6\r\n\r\n@srhb I suspect its the same behavior in the [latest 1.4.3 & release-candidates](https://releases.hashicorp.com/vault/) as the source looks similar - can you kindly confirm?",
              "user": "aphorise",
              "html_url": "https://github.com/hashicorp/vault/issues/9484#issuecomment-660092219"
            },
            {
              "id": 3558017688,
              "created_at": 1594990685000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3558017688",
              "actor": "srhb"
            },
            {
              "id": 3558017695,
              "created_at": 1594990685000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3558017695",
              "actor": "srhb"
            }
          ]
        },
        {
          "id": "658487849",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDUwNDQzODky",
          "number": 9505,
          "html_url": "https://github.com/hashicorp/vault/pull/9505",
          "title": "Backport 1.5: Add a lock to seal migration (#9485)",
          "user": {
            "type": "user",
            "login": "mjarmy"
          },
          "labels": [
            {
              "id": "965254381",
              "node_id": "MDU6TGFiZWw5NjUyNTQzODE=",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/backport",
              "name": "backport",
              "color": "ed8496",
              "description": "",
              "default": false
            },
            {
              "id": "1657574876",
              "node_id": "MDU6TGFiZWwxNjU3NTc0ODc2",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/core",
              "name": "core",
              "color": "0052cc",
              "description": "Issues and Pull-Requests specific to Vault Core",
              "default": false
            }
          ],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594927134000,
          "updated_at": 1594992414000,
          "closed_at": 1594992414000,
          "author_association": "CONTRIBUTOR",
          "body": "* add a lock to seal migration\r\n\r\n* switch to CompareAndSwapInt32\r\n\r\n* switch to uber go-atomic",
          "events": []
        },
        {
          "id": "659285976",
          "node_id": "MDU6SXNzdWU2NTkyODU5NzY=",
          "number": 9516,
          "html_url": "https://github.com/hashicorp/vault/issues/9516",
          "title": "transit support for salted hashes",
          "user": {
            "type": "user",
            "login": "hoerup"
          },
          "labels": [],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594994863000,
          "updated_at": 1594994863000,
          "author_association": "NONE",
          "body": "**Is your feature request related to a problem? Please describe.**\r\nGetting salted hashes done correctly can be a bit of a challenge for some teams, so it would be nice if transit engine could help with that as well.\r\n\r\n**Describe the solution you'd like**\r\nFirst part could be an addition of a generatesalt=1 parameter to the existing /transit/hash endpoint. When specified vault will generate a salt, and prepend/append to the input string before hashing. The result will be a string like \"salt:hash\"\r\n\r\nThe second part is a a new /transit/hashverify endpoint taking 2 parameters: \r\n1) the input string that needs to be verified\r\n2) the salted hash generated by /transit/hash\r\n",
          "events": []
        },
        {
          "id": "657494540",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ5NjAxMDE0",
          "number": 9488,
          "html_url": "https://github.com/hashicorp/vault/pull/9488",
          "title": "Set an env var we can use to see if we're running in -race mode.",
          "user": {
            "type": "user",
            "login": "ncabatoff"
          },
          "labels": [],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594831210000,
          "updated_at": 1594997647000,
          "author_association": "CONTRIBUTOR",
          "body": "",
          "events": []
        },
        {
          "id": "658797032",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDUwNzE3OTMw",
          "number": 9512,
          "html_url": "https://github.com/hashicorp/vault/pull/9512",
          "title": "Remove prefix for exception paths; Add sys/internal/ui/mounts",
          "user": {
            "type": "user",
            "login": "vishalnayak"
          },
          "labels": [],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594955688000,
          "updated_at": 1594997743000,
          "closed_at": 1594997739000,
          "author_association": "MEMBER",
          "body": "",
          "milestone": {
            "id": "5107883",
            "number": 65,
            "title": "1.5"
          },
          "events": []
        },
        {
          "id": "659325889",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDUxMTgzNTc2",
          "number": 9517,
          "html_url": "https://github.com/hashicorp/vault/pull/9517",
          "title": "Backport: Remove prefix for exception paths; add sys/internal/ui/mounts (#9512)",
          "user": {
            "type": "user",
            "login": "vishalnayak"
          },
          "labels": [],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594997928000,
          "updated_at": 1594998010000,
          "closed_at": 1594998007000,
          "author_association": "MEMBER",
          "body": "",
          "milestone": {
            "id": "5107883",
            "number": 65,
            "title": "1.5"
          },
          "events": []
        },
        {
          "id": "653998732",
          "node_id": "MDU6SXNzdWU2NTM5OTg3MzI=",
          "number": 9431,
          "html_url": "https://github.com/hashicorp/vault/issues/9431",
          "title": "Error initializing: Put https://HOSTIP:8200/v1/sys/init: dial tcp HOSTIP:8200: i/o timeout",
          "user": {
            "type": "user",
            "login": "bhanukumar22"
          },
          "labels": [],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 1,
          "created_at": 1594295392000,
          "updated_at": 1594998311000,
          "closed_at": 1594998310000,
          "author_association": "NONE",
          "body": "###########  config.hcl ########################\r\n\r\ndisable_mlock = true\r\n\r\nstorage \"file\" {\r\n  path = \"/secrets\"\r\n}\r\n\r\nlistener \"tcp\" {\r\n address     = \"containerIP:8200\"\r\n tls_cert_file = \"/secrets/vault.crt\"\r\n tls_key_file  = \"/secrets/vault.key\"\r\n\r\n\r\n##########################################################\r\n# ==> Vault server configuration:\r\n\r\n             Api Address: https://container host ip:8200\r\n                     Cgo: disabled\r\n         Cluster Address: https://container host ip:8201\r\n              Listener 1: tcp (addr: \"container ip:8200\", cluster address: \"container ip:8201\", max_request_duration: \"1m30s\", max_request_size: \"33554432\", tls: \"enabled\")\r\n               Log Level: info\r\n                   Mlock: supported: true, enabled: false\r\n                 Storage: file\r\n                 Version: Vault v1.2.3\r\n\r\n==> Vault server started! Log data will stream in below:\r\n",
          "events": [
            {
              "id": 660158013,
              "created_at": 1594998310000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/660158013",
              "actor": "bhanukumar22",
              "body": "Issue with podman version. Was installing vault in podman containers",
              "user": "bhanukumar22",
              "html_url": "https://github.com/hashicorp/vault/issues/9431#issuecomment-660158013"
            },
            {
              "id": 3558546238,
              "created_at": 1594998310000,
              "event": "closed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3558546238",
              "actor": "bhanukumar22"
            }
          ]
        },
        {
          "id": "658564156",
          "node_id": "MDU6SXNzdWU2NTg1NjQxNTY=",
          "number": 9509,
          "html_url": "https://github.com/hashicorp/vault/issues/9509",
          "title": "Vault fails to validate certificate for MongoDB database connection (DocumentDB).",
          "user": {
            "type": "user",
            "login": "cyrus-mc"
          },
          "labels": [],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 3,
          "created_at": 1594933059000,
          "updated_at": 1595005587000,
          "author_association": "NONE",
          "body": "**Describe the bug**\r\n\r\nWhen configuring a database secret to mongoDB (in my case AWS DocumentDB) vault errors with \"x509: certificate signed by unknown authority\" even though I pass in via tls_ca the Certificate Authority used to sign the DocumentD certificates. \r\n\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n\r\n1. Run `vault write database/config/my-mongodb-database plugin_name=mongodb-database-plugin allowed_roles=\"my_role\" connection_url=\"mongodb://{{username}}:{{password}}@unit-test01.cluster-cz6h536kutdi.xxxxxxx:27017/admin?tls=true\" username=\"master\" password=\"xxxx\" tls_ca=@rds-ca-2019-root.pem`\r\n\r\nVault will respond with\r\n\r\n```\r\nError writing data to database/config/my-mongodb-database: Error making API request.\r\n\r\nURL: PUT http://localhost:8200/v1/database/config/my-mongodb-database\r\nCode: 400. Errors:\r\n\r\n* error creating database object: error verifying connection: server selection error: server selection timeout, current topology: { Type: Unknown, Servers: [{ Addr: unit-test01.cluster-cz6h536kutdi.xxxxxx.com:27017, Type: Unknown, State: Connected, Average RTT: 0, Last error: connection() : x509: certificate signed by unknown authority }, ] }\r\n```\r\n\r\n**Expected behavior**\r\n\r\nThe expectation is that the secret will be successfully added. According to the documentation the value of tls_ca is passed as option to `tlsCAFile` for Mongo. \r\n\r\n```\r\n mongo --tls --host unit-test01.cluster-cz6h536kutdi.xxxxx.com:27017 -u master -p xxxxx --tlsCAFile rds-ca-2019-root.pem\r\nMongoDB shell version v4.2.8\r\nconnecting to: mongodb://unit-test01.cluster-cz6h536kutdi.xxxxxx.com:27017/?compressors=disabled&gssapiServiceName=mongodb\r\nImplicit session: session { \"id\" : UUID(\"9058bb07-5d3a-42b6-938a-6ccb4d515a90\") }\r\nMongoDB server version: 3.6.0\r\nWARNING: shell and server versions do not match\r\n\r\nWarning: Non-Genuine MongoDB Detected\r\n\r\nThis server or service appears to be an emulation of MongoDB rather than an official MongoDB product.\r\n\r\nSome documented MongoDB features may work differently, be entirely missing or incomplete, or have unexpected performance characteristics.\r\n\r\nTo learn more please visit: https://dochub.mongodb.org/core/non-genuine-mongodb-server-warning.\r\n\r\nrs0:PRIMARY>\r\n```\r\n\r\nWhich as shown above, works if I call mongo shell directly. \r\n\r\n**Environment:**\r\n\r\n* Vault Server Version:\r\n\r\n```\r\n vault status\r\nKey             Value\r\n---             -----\r\nSeal Type       shamir\r\nInitialized     true\r\nSealed          false\r\nTotal Shares    1\r\nThreshold       1\r\nVersion         1.4.3\r\nCluster Name    vault-cluster-78863a82\r\nCluster ID      8da576e2-1f92-c03c-292b-efcbcdd421fb\r\nHA Enabled      false\r\n```\r\n\r\n* Vault CLI Version (retrieve with `vault version`):\r\n\r\n```\r\n vault version\r\nVault v1.4.3\r\n```\r\n\r\n* Server Operating System/Architecture:\r\n\r\nI have tried this running Vault locally (in dev mode on Mac) as well as within a containerized/Kubernetes setup. Both exhibit the same issue. \r\n\r\n",
          "events": [
            {
              "id": 659774705,
              "created_at": 1594949300000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/659774705",
              "actor": "cyrus-mc",
              "body": "I can't figure this out. I figured up the code and debugged and everything looks to be set correctly. Even followed https://docs.aws.amazon.com/documentdb/latest/developerguide/connect_programmatically.html, which is pretty much the same way Vault instantiates a connection.\r\n\r\nThe example AWS provides connects just fine to the database, but Vault wants to error on the Ping step. ",
              "user": "cyrus-mc",
              "html_url": "https://github.com/hashicorp/vault/issues/9509#issuecomment-659774705"
            },
            {
              "id": 660228108,
              "created_at": 1595005514000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/660228108",
              "actor": "cyrus-mc",
              "body": "I think I figured out the issue. The issue resolves around the fact that in my connection string I am have `tls=true`. \r\n\r\nLooking through the mongoDB code, what happens is that a call to `ApplyURI` clears the `TLSConfig`\r\n\r\nHere is the relevant code\r\n\r\n```\r\nfunc (c *ClientOptions) ApplyURI(uri string) *ClientOptions {\r\n\tif c.err != nil {\r\n\t\treturn c\r\n\t}\r\n\r\n...\r\n\r\nif cs.SSL {\r\n\t\ttlsConfig := new(tls.Config)\r\n\r\n\t\tif cs.SSLCaFileSet {\r\n\t\t\tc.err = addCACertFromFile(tlsConfig, cs.SSLCaFile)\r\n\t\t\tif c.err != nil {\r\n\t\t\t\treturn c\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif cs.SSLInsecure {\r\n\t\t\ttlsConfig.InsecureSkipVerify = true\r\n\t\t}\r\n\r\n\t\tvar x509Subject string\r\n\t\tvar keyPasswd string\r\n\t\tif cs.SSLClientCertificateKeyPasswordSet && cs.SSLClientCertificateKeyPassword != nil {\r\n\t\t\tkeyPasswd = cs.SSLClientCertificateKeyPassword()\r\n\t\t}\r\n\t\tif cs.SSLClientCertificateKeyFileSet {\r\n\t\t\tx509Subject, err = addClientCertFromConcatenatedFile(tlsConfig, cs.SSLClientCertificateKeyFile, keyPasswd)\r\n\t\t} else if cs.SSLCertificateFileSet || cs.SSLPrivateKeyFileSet {\r\n\t\t\tx509Subject, err = addClientCertFromSeparateFiles(tlsConfig, cs.SSLCertificateFile,\r\n\t\t\t\tcs.SSLPrivateKeyFile, keyPasswd)\r\n\t\t}\r\n\t\tif err != nil {\r\n\t\t\tc.err = err\r\n\t\t\treturn c\r\n\t\t}\r\n\r\n\t\t// If a username wasn't specified fork x509, add one from the certificate.\r\n\t\tif c.Auth != nil && strings.ToLower(c.Auth.AuthMechanism) == \"mongodb-x509\" &&\r\n\t\t\tc.Auth.Username == \"\" {\r\n\r\n\t\t\t// The Go x509 package gives the subject with the pairs in reverse order that we want.\r\n\t\t\tc.Auth.Username = extractX509UsernameFromSubject(x509Subject)\r\n\t\t}\r\n\r\n\t\tc.TLSConfig = tlsConfig\r\n\t}\r\n\r\n...\r\n}\r\n```\r\n\r\nThis ends up clearing the rootCAs that are set in `connection_producer.go` for mongo as the call to ApplyURI is done after the call to MergeClientOptions which results in the TLSConfig being reset and not containing the rootCAs we specified. ",
              "user": "cyrus-mc",
              "html_url": "https://github.com/hashicorp/vault/issues/9509#issuecomment-660228108"
            },
            {
              "id": 660228819,
              "created_at": 1595005587000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/660228819",
              "actor": "cyrus-mc",
              "body": "The workaround for now is to just not set the option `ssl=true` or `tls=true`. However I think the code should accept a valid  mongoDB connection string so some refactoring of this code would be required. ",
              "user": "cyrus-mc",
              "html_url": "https://github.com/hashicorp/vault/issues/9509#issuecomment-660228819"
            },
            {
              "created_at": 1595008196000,
              "event": "cross-referenced",
              "actor": "cyrus-mc",
              "source": {
                "type": "issue",
                "issue": {
                  "url": "https://api.github.com/repos/hashicorp/vault/issues/9519",
                  "repository_url": "https://api.github.com/repos/hashicorp/vault",
                  "labels_url": "https://api.github.com/repos/hashicorp/vault/issues/9519/labels{/name}",
                  "comments_url": "https://api.github.com/repos/hashicorp/vault/issues/9519/comments",
                  "events_url": "https://api.github.com/repos/hashicorp/vault/issues/9519/events",
                  "html_url": "https://github.com/hashicorp/vault/pull/9519",
                  "id": 659473791,
                  "node_id": "MDExOlB1bGxSZXF1ZXN0NDUxMzEzMzIw",
                  "number": 9519,
                  "title": "fix: Correctly handle TLS config when ssl=true or tls=true connection string option set.",
                  "user": {
                    "login": "cyrus-mc",
                    "id": 9330844,
                    "node_id": "MDQ6VXNlcjkzMzA4NDQ=",
                    "avatar_url": "https://avatars1.githubusercontent.com/u/9330844?v=4",
                    "gravatar_id": "",
                    "url": "https://api.github.com/users/cyrus-mc",
                    "html_url": "https://github.com/cyrus-mc",
                    "followers_url": "https://api.github.com/users/cyrus-mc/followers",
                    "following_url": "https://api.github.com/users/cyrus-mc/following{/other_user}",
                    "gists_url": "https://api.github.com/users/cyrus-mc/gists{/gist_id}",
                    "starred_url": "https://api.github.com/users/cyrus-mc/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/cyrus-mc/subscriptions",
                    "organizations_url": "https://api.github.com/users/cyrus-mc/orgs",
                    "repos_url": "https://api.github.com/users/cyrus-mc/repos",
                    "events_url": "https://api.github.com/users/cyrus-mc/events{/privacy}",
                    "received_events_url": "https://api.github.com/users/cyrus-mc/received_events",
                    "type": "User",
                    "site_admin": false
                  },
                  "labels": [],
                  "state": "open",
                  "locked": false,
                  "assignees": [],
                  "comments": 2,
                  "created_at": "2020-07-17T17:49:56Z",
                  "updated_at": "2020-07-17T18:00:17Z",
                  "author_association": "NONE",
                  "repository": {
                    "id": 31288958,
                    "node_id": "MDEwOlJlcG9zaXRvcnkzMTI4ODk1OA==",
                    "name": "vault",
                    "full_name": "hashicorp/vault",
                    "private": false,
                    "owner": {
                      "login": "hashicorp",
                      "id": 761456,
                      "node_id": "MDEyOk9yZ2FuaXphdGlvbjc2MTQ1Ng==",
                      "avatar_url": "https://avatars2.githubusercontent.com/u/761456?v=4",
                      "gravatar_id": "",
                      "url": "https://api.github.com/users/hashicorp",
                      "html_url": "https://github.com/hashicorp",
                      "followers_url": "https://api.github.com/users/hashicorp/followers",
                      "following_url": "https://api.github.com/users/hashicorp/following{/other_user}",
                      "gists_url": "https://api.github.com/users/hashicorp/gists{/gist_id}",
                      "starred_url": "https://api.github.com/users/hashicorp/starred{/owner}{/repo}",
                      "subscriptions_url": "https://api.github.com/users/hashicorp/subscriptions",
                      "organizations_url": "https://api.github.com/users/hashicorp/orgs",
                      "repos_url": "https://api.github.com/users/hashicorp/repos",
                      "events_url": "https://api.github.com/users/hashicorp/events{/privacy}",
                      "received_events_url": "https://api.github.com/users/hashicorp/received_events",
                      "type": "Organization",
                      "site_admin": false
                    },
                    "html_url": "https://github.com/hashicorp/vault",
                    "description": "A tool for secrets management, encryption as a service, and privileged access management",
                    "fork": false,
                    "url": "https://api.github.com/repos/hashicorp/vault",
                    "forks_url": "https://api.github.com/repos/hashicorp/vault/forks",
                    "keys_url": "https://api.github.com/repos/hashicorp/vault/keys{/key_id}",
                    "collaborators_url": "https://api.github.com/repos/hashicorp/vault/collaborators{/collaborator}",
                    "teams_url": "https://api.github.com/repos/hashicorp/vault/teams",
                    "hooks_url": "https://api.github.com/repos/hashicorp/vault/hooks",
                    "issue_events_url": "https://api.github.com/repos/hashicorp/vault/issues/events{/number}",
                    "events_url": "https://api.github.com/repos/hashicorp/vault/events",
                    "assignees_url": "https://api.github.com/repos/hashicorp/vault/assignees{/user}",
                    "branches_url": "https://api.github.com/repos/hashicorp/vault/branches{/branch}",
                    "tags_url": "https://api.github.com/repos/hashicorp/vault/tags",
                    "blobs_url": "https://api.github.com/repos/hashicorp/vault/git/blobs{/sha}",
                    "git_tags_url": "https://api.github.com/repos/hashicorp/vault/git/tags{/sha}",
                    "git_refs_url": "https://api.github.com/repos/hashicorp/vault/git/refs{/sha}",
                    "trees_url": "https://api.github.com/repos/hashicorp/vault/git/trees{/sha}",
                    "statuses_url": "https://api.github.com/repos/hashicorp/vault/statuses/{sha}",
                    "languages_url": "https://api.github.com/repos/hashicorp/vault/languages",
                    "stargazers_url": "https://api.github.com/repos/hashicorp/vault/stargazers",
                    "contributors_url": "https://api.github.com/repos/hashicorp/vault/contributors",
                    "subscribers_url": "https://api.github.com/repos/hashicorp/vault/subscribers",
                    "subscription_url": "https://api.github.com/repos/hashicorp/vault/subscription",
                    "commits_url": "https://api.github.com/repos/hashicorp/vault/commits{/sha}",
                    "git_commits_url": "https://api.github.com/repos/hashicorp/vault/git/commits{/sha}",
                    "comments_url": "https://api.github.com/repos/hashicorp/vault/comments{/number}",
                    "issue_comment_url": "https://api.github.com/repos/hashicorp/vault/issues/comments{/number}",
                    "contents_url": "https://api.github.com/repos/hashicorp/vault/contents/{+path}",
                    "compare_url": "https://api.github.com/repos/hashicorp/vault/compare/{base}...{head}",
                    "merges_url": "https://api.github.com/repos/hashicorp/vault/merges",
                    "archive_url": "https://api.github.com/repos/hashicorp/vault/{archive_format}{/ref}",
                    "downloads_url": "https://api.github.com/repos/hashicorp/vault/downloads",
                    "issues_url": "https://api.github.com/repos/hashicorp/vault/issues{/number}",
                    "pulls_url": "https://api.github.com/repos/hashicorp/vault/pulls{/number}",
                    "milestones_url": "https://api.github.com/repos/hashicorp/vault/milestones{/number}",
                    "notifications_url": "https://api.github.com/repos/hashicorp/vault/notifications{?since,all,participating}",
                    "labels_url": "https://api.github.com/repos/hashicorp/vault/labels{/name}",
                    "releases_url": "https://api.github.com/repos/hashicorp/vault/releases{/id}",
                    "deployments_url": "https://api.github.com/repos/hashicorp/vault/deployments",
                    "created_at": "2015-02-25T00:15:59Z",
                    "updated_at": "2020-07-17T20:30:27Z",
                    "pushed_at": "2020-07-17T20:57:34Z",
                    "git_url": "git://github.com/hashicorp/vault.git",
                    "ssh_url": "git@github.com:hashicorp/vault.git",
                    "clone_url": "https://github.com/hashicorp/vault.git",
                    "svn_url": "https://github.com/hashicorp/vault",
                    "homepage": "https://www.vaultproject.io/",
                    "size": 123698,
                    "stargazers_count": 16436,
                    "watchers_count": 16436,
                    "language": "Go",
                    "has_issues": true,
                    "has_projects": false,
                    "has_downloads": true,
                    "has_wiki": false,
                    "has_pages": false,
                    "forks_count": 2534,
                    "archived": false,
                    "disabled": false,
                    "open_issues_count": 708,
                    "license": {
                      "key": "mpl-2.0",
                      "name": "Mozilla Public License 2.0",
                      "spdx_id": "MPL-2.0",
                      "url": "https://api.github.com/licenses/mpl-2.0",
                      "node_id": "MDc6TGljZW5zZTE0"
                    },
                    "forks": 2534,
                    "open_issues": 708,
                    "watchers": 16436,
                    "default_branch": "master"
                  },
                  "pull_request": {
                    "url": "https://api.github.com/repos/hashicorp/vault/pulls/9519",
                    "html_url": "https://github.com/hashicorp/vault/pull/9519",
                    "diff_url": "https://github.com/hashicorp/vault/pull/9519.diff",
                    "patch_url": "https://github.com/hashicorp/vault/pull/9519.patch"
                  },
                  "body": "fix for #9509 \r\n\r\nMerge writeOpts and authOpts after call too ApplyURI. "
                }
              }
            }
          ]
        },
        {
          "id": "659453838",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDUxMjk1NDUx",
          "number": 9518,
          "html_url": "https://github.com/hashicorp/vault/pull/9518",
          "title": "docs: specify which JWT/OIDC role params support JSON pointer syntax in API docs",
          "user": {
            "type": "user",
            "login": "austingebauer"
          },
          "labels": [
            {
              "id": "1660995226",
              "node_id": "MDU6TGFiZWwxNjYwOTk1MjI2",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/auth/jwt-oidc",
              "name": "auth/jwt-oidc",
              "color": "f968e8",
              "description": "",
              "default": false
            },
            {
              "id": "1024442799",
              "node_id": "MDU6TGFiZWwxMDI0NDQyNzk5",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/docs",
              "name": "docs",
              "color": "b2ffb7",
              "description": "",
              "default": false
            },
            {
              "id": "1874015060",
              "node_id": "MDU6TGFiZWwxODc0MDE1MDYw",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/docs-cherrypick",
              "name": "docs-cherrypick",
              "color": "0e8a16",
              "description": "",
              "default": false
            }
          ],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1595006827000,
          "updated_at": 1595006827000,
          "author_association": "MEMBER",
          "body": "This PR improves the JWT/OIDC docs by making it more obvious which role parameters support JSON pointer syntax.",
          "events": []
        },
        {
          "id": "659473791",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDUxMzEzMzIw",
          "number": 9519,
          "html_url": "https://github.com/hashicorp/vault/pull/9519",
          "title": "fix: Correctly handle TLS config when ssl=true or tls=true connection string option set.",
          "user": {
            "type": "user",
            "login": "cyrus-mc"
          },
          "labels": [],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 2,
          "created_at": 1595008196000,
          "updated_at": 1595008817000,
          "author_association": "NONE",
          "body": "fix for #9509 \r\n\r\nMerge writeOpts and authOpts after call too ApplyURI. ",
          "events": []
        },
        {
          "id": "656217938",
          "node_id": "MDU6SXNzdWU2NTYyMTc5Mzg=",
          "number": 9474,
          "html_url": "https://github.com/hashicorp/vault/issues/9474",
          "title": "Error initializing storage of type raft: failed to create fsm: invalid argument",
          "user": {
            "type": "user",
            "login": "rod4n4m1"
          },
          "labels": [
            {
              "id": "1467741097",
              "node_id": "MDU6TGFiZWwxNDY3NzQxMDk3",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/ecosystem",
              "name": "ecosystem",
              "color": "f2bc59",
              "description": "",
              "default": false
            },
            {
              "id": "2042198327",
              "node_id": "MDU6TGFiZWwyMDQyMTk4MzI3",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/helmchart",
              "name": "helmchart",
              "color": "f29ba2",
              "description": "Helm chart for deploying Vault on Kubernetes. Also consider hashicorp/vault-helm",
              "default": false
            },
            {
              "id": "1661184440",
              "node_id": "MDU6TGFiZWwxNjYxMTg0NDQw",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/storage/raft",
              "name": "storage/raft",
              "color": "93a2ed",
              "description": "",
              "default": false
            }
          ],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 9,
          "created_at": 1594682947000,
          "updated_at": 1595010026000,
          "author_association": "NONE",
          "body": "<!-- Please reserve GitHub issues for bug reports and feature requests.\r\n\r\nFor questions, the best place to get answers is on our [discussion forum](https://discuss.hashicorp.com/c/vault), as they will get more visibility from experienced users than the issue tracker.\r\n\r\nPlease note: We take Vault's security and our users' trust very seriously. If you believe you have found a security issue in Vault, please responsibly disclose by contacting us at security@hashicorp.com. Our PGP key is available at [our security page](https://www.hashicorp.com/security/).\r\n\r\n-->\r\n\r\n**Describe the bug**\r\nWhen trying to use Raft as the backend storage for a Vault running as a container inside minikube (Kubernetes), the following error message is threw: `Error initializing storage of type raft: failed to create fsm: invalid argument`\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Start minikube\r\n2. Create a K8s deployment YAML file\r\n```yaml\r\n---\r\napiVersion: apps/v1\r\nkind: Deployment\r\nmetadata:\r\n  name: vault1\r\n  labels:\r\n    app: vault1\r\nspec:\r\n  replicas: 1\r\n  selector:\r\n    matchLabels:\r\n      app: vault1\r\n  template:\r\n    metadata:\r\n      labels:\r\n        app: vault1\r\n    spec:\r\n      containers:\r\n      - name: vault1\r\n        command: [\"vault\", \"server\", \"-config\", \"/vault/config/vault1.json\"]\r\n        image: \"vault:1.4.2\"\r\n        imagePullPolicy: IfNotPresent\r\n        env:\r\n          - name: VAULT_API_ADDR\r\n            value: https://vault:8200\r\n          - name: VAULT_CLUSTER_ADDR\r\n            value: https://vault1.default.svc.cluster.local:8201\r\n          - name: VAULT_LOG_LEVEL\r\n            value: Debug\r\n          - name: VAULT_TOKEN\r\n            valueFrom:\r\n              secretKeyRef:\r\n                name: vault-token\r\n                key: token\r\n        securityContext:\r\n          capabilities:\r\n            add:\r\n              - IPC_LOCK\r\n        volumeMounts:\r\n          - name: config\r\n            mountPath: /vault/config/vault1.json\r\n            subPath: vault1.json\r\n          - name: vault1-raft\r\n            mountPath: /vault/data\r\n          - name: certs\r\n            mountPath: /vault/certs\r\n      volumes:\r\n        - name: config\r\n          configMap:\r\n            name: vault1-config\r\n        - name: certs\r\n          secret:\r\n            secretName: vault1-certs\r\n        - name: vault1-raft\r\n          hostPath:\r\n            path: /Users/rodanami/hashi-vault/ha/volumes/vault1/data\r\n---\r\napiVersion: v1\r\nkind: Service\r\nmetadata:\r\n  name: vault1\r\n  labels:\r\n    app: vault1\r\nspec:\r\n  type: ClusterIP\r\n  ports:\r\n    - port: 8200\r\n      targetPort: 8200\r\n      protocol: TCP\r\n      name: vault1\r\n  selector:\r\n    app: vault1\r\n```\r\n3. Create Secrets and Configmap\r\n```\r\nkubectl create secret generic vault-token \\\r\n  --from-literal=username=\"root\" \\\r\n  --from-literal=token=\"s.XXXXXXXXXXXXXX\"\r\n\r\nkubectl create secret generic vault1-certs \\\r\n    --from-file=certs/ca.crt \\\r\n    --from-file=certs/vault1.crt \\\r\n    --from-file=certs/vault1.key\r\n\r\nkubectl create configmap vault1-config --from-file=configs/vault1.json\r\n```\r\n\r\n4. Apply the deployment\r\n`kubectl apply -f k8s-vault1-deploy.yaml`\r\n\r\n5. Get POD log to see an unique log entry\r\n```\r\nkubectl logs vault1-546767687-w4sfm\r\nError initializing storage of type raft: failed to create fsm: invalid argument\r\n```\r\n\r\n**Expected behavior**\r\nVault server initializes using Raft backend storage.\r\n\r\n**Environment:**\r\n* Vault Server Version (retrieve with `vault status`): 1.4.2 (Default image)\r\n* Vault CLI Version (retrieve with `vault version`): `Vault v1.4.2`\r\n* Server Operating System/Architecture: Default Docker image from Hashicorp, CLI runs on `Darwin Kernel Version 19.5.0`\r\n\r\nVault server configuration file(s):\r\n\r\n```javascritpt\r\n{\r\n  \"storage\": {\r\n    \"raft\": {\r\n      \"path\": \"/vault/data/\",\r\n      \"node_id\": \"vault1\"\r\n    }\r\n  },\r\n  \"listener\": {\r\n    \"tcp\":{\r\n      \"address\": \"0.0.0.0:8200\",\r\n      \"cluster_address\": \"0.0.0.0:8201\",\r\n      \"tls_disable\": 0,\r\n      \"tls_cert_file\": \"/vault/certs/vault1.crt\",\r\n      \"tls_key_file\": \"/vault/certs/vault1.key\"\r\n    }\r\n  },\r\n  \"seal\": {\r\n    \"transit\": {\r\n      \"address\": \"https://vault-transit:8200\",\r\n      \"disable_renewal\": \"false\",\r\n      \"key_name\": \"autounseal\",\r\n      \"mount_path\": \"transit/\",\r\n      \"tls_ca_cert\": \"/vault/certs/ca.crt\",\r\n      \"tls_client_cert\": \"/vault/certs/vault1.crt\",\r\n      \"tls_client_key\": \"/vault/certs/vault1.key\",\r\n      \"tls_server_name\": \"vault-transit\",\r\n      \"tls_skip_verify\": \"false\"\r\n    }\r\n  },\r\n  \"ui\": true,\r\n  \"max_lease_ttl\": \"760h\",\r\n  \"default_lease_ttl\": \"760h\"\r\n}\r\n```\r\n\r\n**Additional context**\r\nHost Filesystem:\r\n```\r\nrodanami@rodanami:~/hashi-vault/ha/volumes/vault1$ find .\r\n.\r\n./data\r\n./data/vault.db\r\n```\r\nHost Filesystem permissions:\r\n```\r\nrodanami@rodanami:~/hashi-vault/ha/volumes/vault1$ ls -laR\r\ntotal 0\r\ndrwxr-xr-x  3 rodanami  staff    96B Jul 13 20:18 ./\r\ndrwxr-xr-x  6 rodanami  staff   192B Jul 13 16:04 ../\r\ndrwxr-xr-x  3 rodanami  staff    96B Jul 13 19:31 data/\r\n\r\n./data:\r\ntotal 32\r\ndrwxr-xr-x  3 rodanami  staff    96B Jul 13 19:31 ./\r\ndrwxr-xr-x  3 rodanami  staff    96B Jul 13 20:18 ../\r\n-rw-r--r--  1 rodanami  staff    16K Jul 13 19:31 vault.db\r\n```\r\n\r\nraft directory, raft.db, snapshots were NOT created here for unknown reason.",
          "events": [
            {
              "id": 657903406,
              "created_at": 1594687892000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/657903406",
              "actor": "calvn",
              "body": "The underlying error is raised by `bolt.Open`, and it's likely due to the the path specified for `raft` storage being a shared volume (similar to the issue reported [here](https://github.com/boltdb/bolt/issues/272)).\r\n\r\nCan you try setting up a [persistent volume](https://minikube.sigs.k8s.io/docs/handbook/persistent_volumes/) to use as the path for Raft storage and see if that works?\r\n\r\nUpdate: Alternatively, you can follow the instructions [over here](https://www.vaultproject.io/docs/platform/k8s/helm/examples/ha-with-raft) to use the Vault Helm chart to a deploy an HA Vault cluster with Integrated Storage.",
              "user": "calvn",
              "html_url": "https://github.com/hashicorp/vault/issues/9474#issuecomment-657903406"
            },
            {
              "id": 658116503,
              "created_at": 1594724496000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/658116503",
              "actor": "rod4n4m1",
              "body": "Thanks @calvn ! It does make sense since I'm using a local folder synchronized with a Box.com folder for raft data. Let me try creating a minikube PV for raft that is not shared with Box or shared.",
              "user": "rod4n4m1",
              "html_url": "https://github.com/hashicorp/vault/issues/9474#issuecomment-658116503"
            },
            {
              "id": 3543650766,
              "created_at": 1594724496000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3543650766",
              "actor": "calvn"
            },
            {
              "id": 3543650769,
              "created_at": 1594724496000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3543650769",
              "actor": "calvn"
            },
            {
              "id": 658357621,
              "created_at": 1594753446000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/658357621",
              "actor": "rod4n4m1",
              "body": "Unfortunately I'm still getting the same error message even though I'm using a PV now.\r\n\r\n```\r\nrodanami@rodanami:~/hashi-vault/ha$ kubectl logs vault1-7b76b7cc6d-7gnql\r\nError initializing storage of type raft: failed to create fsm: invalid argument\r\n```\r\n\r\nvault.json\r\n```\r\n{\r\n  \"storage\": {\r\n    \"raft\": {\r\n      \"path\": \"/vault/data\",\r\n      \"node_id\": \"vault1\"\r\n    }\r\n  },\r\n```\r\nvault1-deploy.yaml\r\n```\r\n---\r\napiVersion: apps/v1\r\nkind: Deployment\r\nmetadata:\r\n  name: vault1\r\n  labels:\r\n    app: vault1\r\nspec:\r\n  replicas: 1\r\n  selector:\r\n    matchLabels:\r\n      app: vault1\r\n  template:\r\n    metadata:\r\n      labels:\r\n        app: vault1\r\n    spec:\r\n      containers:\r\n      - name: vault1\r\n        command: [\"vault\", \"server\", \"-config\", \"/vault/config/vault1.json\"]\r\n        image: registry.hub.docker.com/library/vault:1.4.2\r\n        imagePullPolicy: IfNotPresent\r\n        env:\r\n          - name: VAULT_API_ADDR\r\n            value: https://vault:8200\r\n          - name: VAULT_CLUSTER_ADDR\r\n            value: https://vault1.default.svc.cluster.local:8201\r\n          - name: VAULT_LOG_LEVEL\r\n            value: Debug\r\n          - name: VAULT_TOKEN\r\n            valueFrom:\r\n              secretKeyRef:\r\n                name: vault-token\r\n                key: token\r\n        securityContext:\r\n          capabilities:\r\n            add:\r\n              - IPC_LOCK\r\n        ports:\r\n        - containerPort: 8200\r\n          name: vault-port\r\n          protocol: TCP\r\n        - containerPort: 8201\r\n          name: cluster-port\r\n          protocol: TCP\r\n        volumeMounts:\r\n          - name: config\r\n            mountPath: /vault/config/vault1.json\r\n            subPath: vault1.json\r\n          - name: certs\r\n            mountPath: /vault/certs\r\n          - name: vault1-storage\r\n            mountPath: /vault\r\n      volumes:\r\n        - name: config\r\n          configMap:\r\n            name: vault1-config\r\n        - name: certs\r\n          secret:\r\n            secretName: vault1-certs\r\n        - name: vault1-storage\r\n          persistentVolumeClaim:\r\n            claimName: vault1-pv-claim\r\n```\r\n\r\nPVC\r\n```\r\nrodanami@rodanami:~/hashi-vault/ha$ kubectl describe pvc vault1-pv-claim\r\nName:          vault1-pv-claim\r\nNamespace:     default\r\nStorageClass:  \r\nStatus:        Bound\r\nVolume:        vault1-volume\r\nLabels:        <none>\r\nAnnotations:   pv.kubernetes.io/bind-completed: yes\r\nFinalizers:    [kubernetes.io/pvc-protection]\r\nCapacity:      2Gi\r\nAccess Modes:  RWO\r\nVolumeMode:    Filesystem\r\nMounted By:    vault1-7b76b7cc6d-7gnql\r\nEvents:        <none>\r\n```\r\n\r\nLocal path:\r\n```\r\nrodanami@rodanami:/usr/local/mnt/vault-ha/vault1$ find .\r\n.\r\n./file\r\n./config\r\n./config/vault1.json\r\n./logs\r\n./certs\r\n./data\r\n./data/vault.db\r\n```\r\n\r\nIf I don't create the `data` directory manually, it complains with `Error initializing storage of type raft: failed to create fsm: open /vault/data/vault.db: no such file or directory`.\r\n\r\nI have updated minikube and kubectl to the latest version, but no changes.",
              "user": "rod4n4m1",
              "html_url": "https://github.com/hashicorp/vault/issues/9474#issuecomment-658357621"
            },
            {
              "id": 659630466,
              "created_at": 1594928737000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/659630466",
              "actor": "rod4n4m1",
              "body": "I tested `vault:1.4.3` today and got the same issue. \r\n\r\nEverything works fine with the `file` storage backend in the same directory. It's strange that raft module creates a `data/vault.db` and then throws this error.  I didn't find any relevant error from minikube kubelet. Also, this new directory is not shared on MacOS level and not synchronized with any external filesystem. I'll try to shutdown my Box Sync and CrashPlan and any other software that may be reading a file in my disk.\r\n",
              "user": "rod4n4m1",
              "html_url": "https://github.com/hashicorp/vault/issues/9474#issuecomment-659630466"
            },
            {
              "id": 659657079,
              "created_at": 1594931678000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/659657079",
              "actor": "rod4n4m1",
              "body": "No luck @calvn, same error even shutdown all possible software in my MacBook. I tried to mimic the `go Bolt` error that you referred in the same directory where I'm mounting my persistent volumes:\r\n\r\n```\r\nrodanami@rodanami:/usr/local/mnt/go$ docker run -i -t -v /usr/local/mnt/go:/gopath/src/test golang /bin/bash\r\n```\r\n\r\n```\r\nroot@67d8b50c6627:/gopath/src/test# cat main.go \r\npackage main\r\n\r\nimport (\r\n    \"github.com/boltdb/bolt\"\r\n    \"log\"\r\n)\r\n\r\nfunc main() {\r\n    db, err := bolt.Open(\"data.db\", 0600, nil)\r\n    if err != nil {\r\n        log.Fatal(err)\r\n    } else {\r\n\tlog.Println(\"Successful!\")\r\n    }\r\n    defer db.Close()\r\n}\r\n```\r\n\r\n```\r\nroot@67d8b50c6627:/gopath/src/test# go version\r\ngo version go1.14.5 linux/amd64\r\n```\r\n\r\n```\r\nroot@67d8b50c6627:/gopath/src/test# go run main.go\r\n2020/07/16 20:33:12 Successful!\r\n```\r\n\r\nI don't think this raft error is related to the same `go Bolt` issue from 2014.",
              "user": "rod4n4m1",
              "html_url": "https://github.com/hashicorp/vault/issues/9474#issuecomment-659657079"
            },
            {
              "id": 3555057377,
              "created_at": 1594931806000,
              "event": "mentioned",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3555057377",
              "actor": "calvn"
            },
            {
              "id": 3555057383,
              "created_at": 1594931806000,
              "event": "subscribed",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3555057383",
              "actor": "calvn"
            },
            {
              "id": 659661943,
              "created_at": 1594932267000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/659661943",
              "actor": "calvn",
              "body": "Can you also output the actual persistent volumes (via `kubectl describe pv`) and share the YAML for the PVC?",
              "user": "calvn",
              "html_url": "https://github.com/hashicorp/vault/issues/9474#issuecomment-659661943"
            },
            {
              "id": 659668329,
              "created_at": 1594933006000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/659668329",
              "actor": "calvn",
              "body": "If you're able to use helm, can you give the helm guide [over here](https://www.vaultproject.io/docs/platform/k8s/helm/examples/ha-with-raft) a try to see if you can get it running on your laptop?\r\n\r\n\r\nSince we're using minikube, run this command instead to get a 3-node cluster with Raft set up on a single k8s node.\r\n```\r\nhelm install vault hashicorp/vault --set='server.ha.enabled=true' --set='server.ha.raft.enabled=true' --set='server.affinity=null'\r\n```\r\n",
              "user": "calvn",
              "html_url": "https://github.com/hashicorp/vault/issues/9474#issuecomment-659668329"
            },
            {
              "id": 3555132897,
              "created_at": 1594933028000,
              "event": "labeled",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3555132897",
              "actor": "calvn",
              "label": "helmchart"
            },
            {
              "id": 3555134920,
              "created_at": 1594933063000,
              "event": "labeled",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3555134920",
              "actor": "calvn",
              "label": "ecosystem"
            },
            {
              "id": 3555134921,
              "created_at": 1594933063000,
              "event": "labeled",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3555134921",
              "actor": "calvn",
              "label": "storage/raft"
            },
            {
              "id": 660144421,
              "created_at": 1594996856000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/660144421",
              "actor": "rod4n4m1",
              "body": "Sure, below is the persistent volume and related persistent volume claim\r\n\r\nPV\r\n```\r\n---\r\napiVersion: v1\r\nkind: PersistentVolume\r\nmetadata:\r\n  name: vault1-volume\r\n  labels:\r\n    type: local\r\n    vault: vault1\r\nspec:\r\n  capacity:\r\n    storage: 2Gi\r\n  accessModes:\r\n    - ReadWriteOnce\r\n  hostPath:\r\n    path: \"/usr/local/mnt/vault-ha/vault1\"\r\n```\r\n\r\nPVC\r\n```\r\n---\r\napiVersion: v1\r\nkind: PersistentVolumeClaim\r\nmetadata:\r\n  name: vault1-pv-claim\r\nspec:\r\n  storageClassName: \"\"\r\n  accessModes:\r\n    - ReadWriteOnce\r\n  resources:\r\n    requests:\r\n      storage: 100Mi\r\n  volumeName: vault1-volume\r\n```\r\n\r\nAlso, I'm mapping the minikube node filesystem to my MacBook filesystem:\r\n\r\n`minikube mount /usr/local/mnt/vault-ha:/usr/local/mnt/vault-ha &`\r\n\r\nI'll try `helm` over this weekend to see if makes any difference. Thanks",
              "user": "rod4n4m1",
              "html_url": "https://github.com/hashicorp/vault/issues/9474#issuecomment-660144421"
            },
            {
              "id": 660267705,
              "created_at": 1595010026000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/660267705",
              "actor": "calvn",
              "body": "> Also, I'm mapping the minikube node filesystem to my MacBook filesystem:\r\n\r\nThe issue could be the mapping between the minikube node and MacOS. Can you try a path for raft that's not mapped to the host?",
              "user": "calvn",
              "html_url": "https://github.com/hashicorp/vault/issues/9474#issuecomment-660267705"
            }
          ]
        },
        {
          "id": "657478461",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ5NTg3NDY1",
          "number": 9487,
          "html_url": "https://github.com/hashicorp/vault/pull/9487",
          "title": "API and upgrade docs for global plugin reload",
          "user": {
            "type": "user",
            "login": "sgmiller"
          },
          "labels": [],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594829750000,
          "updated_at": 1595011168000,
          "closed_at": 1595011165000,
          "author_association": "CONTRIBUTOR",
          "events": []
        },
        {
          "id": "657553870",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ5NjUwNDQz",
          "number": 9491,
          "html_url": "https://github.com/hashicorp/vault/pull/9491",
          "title": "Add CL entry for mount_type addition (#9489)",
          "user": {
            "type": "user",
            "login": "sgmiller"
          },
          "labels": [],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594836866000,
          "updated_at": 1595011182000,
          "closed_at": 1595011179000,
          "author_association": "CONTRIBUTOR",
          "body": "Backport to release branch",
          "events": []
        },
        {
          "id": "659248281",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDUxMTE3NzE3",
          "number": 9515,
          "html_url": "https://github.com/hashicorp/vault/pull/9515",
          "title": "Get rid of sdk internal reloadutil package for now.",
          "user": {
            "type": "user",
            "login": "ncabatoff"
          },
          "labels": [],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 1,
          "created_at": 1594991706000,
          "updated_at": 1595013462000,
          "closed_at": 1595013376000,
          "author_association": "CONTRIBUTOR",
          "body": "Motivated by this failure: https://circleci.hashicorp.engineering/gh/hashicorp/vault-enterprise/42316#tests/containers/1",
          "events": []
        },
        {
          "id": "659551769",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDUxMzgzMjU1",
          "number": 9521,
          "html_url": "https://github.com/hashicorp/vault/pull/9521",
          "title": "Revert \"Get rid of sdk internal reloadutil package for now.\"",
          "user": {
            "type": "user",
            "login": "jefferai"
          },
          "labels": [],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 1,
          "created_at": 1595013496000,
          "updated_at": 1595013647000,
          "closed_at": 1595013525000,
          "author_association": "MEMBER",
          "body": "Reverts hashicorp/vault#9515\r\n\r\nAnything in internalshared is by definition being used by a non-Vault piece of code, which this just broke.",
          "events": []
        },
        {
          "id": "659572658",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDUxNDAyMzIw",
          "number": 9522,
          "html_url": "https://github.com/hashicorp/vault/pull/9522",
          "title": "Revert \"Revert \"Get rid of sdk internal reloadutil package for now.\"\"",
          "user": {
            "type": "user",
            "login": "jefferai"
          },
          "labels": [],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1595014955000,
          "updated_at": 1595014989000,
          "closed_at": 1595014962000,
          "author_association": "MEMBER",
          "body": "Reverts hashicorp/vault#9521",
          "events": []
        },
        {
          "id": "656981439",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ5MTgxNTY3",
          "number": 9483,
          "html_url": "https://github.com/hashicorp/vault/pull/9483",
          "title": "Update date-fns",
          "user": {
            "type": "user",
            "login": "noelledaley"
          },
          "labels": [],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1594773868000,
          "updated_at": 1595016954000,
          "closed_at": 1595016948000,
          "author_association": "CONTRIBUTOR",
          "body": "# Update date-fns\r\nUpdate date-fns to 2.0.0 which requires us update all of our date-related helpers. The most notable change we had to account for is that all of the date-fns functions no longer accept strings as arguments. You'll notice we also had to switch some of the formatting arguments from `YYYY` to `yyyy` as a result. See the full list of breaking changes when upgrading to date-fns 2.0.0 [here](https://github.com/date-fns/date-fns/blob/master/CHANGELOG.md#changed-4).\r\n\r\n## Testing\r\nThis PR requires a considerable QA as it changes the behavior of our `date-from-now` and `date-format` helpers. We now return an empty string and console log an error if the formatting doesn't work, so there's a chance some dates may be missing in the UI.\r\n\r\nNavigate to the various pages of the UI where `date-format` or `date-from-now` is used, such as the replication secondaries add modal which displays the expiration date. These pages should still display the date as expected.\r\n\r\nHere's an example of the replication secondaries add modal:\r\n![image](https://user-images.githubusercontent.com/903288/87821711-28ad1b80-c825-11ea-893b-1201f657a345.png)\r\n",
          "events": []
        },
        {
          "id": "623515497",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDIyMTY4NzQz",
          "number": 9070,
          "html_url": "https://github.com/hashicorp/vault/pull/9070",
          "title": "Add missed algorithms aes128-gcm96, ecdsa-p384, ecdsa-p521 in UI",
          "user": {
            "type": "user",
            "login": "binlab"
          },
          "labels": [
            {
              "id": "872623767",
              "node_id": "MDU6TGFiZWw4NzI2MjM3Njc=",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/ui",
              "name": "ui",
              "color": "88e56e",
              "description": "",
              "default": false
            }
          ],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 2,
          "created_at": 1590189136000,
          "updated_at": 1595017569000,
          "closed_at": 1595013133000,
          "author_association": "CONTRIBUTOR",
          "body": "The issue described here - https://github.com/hashicorp/vault/issues/9069. This should solve it",
          "milestone": {
            "id": "5579414",
            "number": 74,
            "title": "1.4.4"
          },
          "events": []
        },
        {
          "id": "576830428",
          "node_id": "MDU6SXNzdWU1NzY4MzA0Mjg=",
          "number": 8486,
          "html_url": "https://github.com/hashicorp/vault/issues/8486",
          "title": "Enable writing PKI certificate and private key data to a user specified Vault path(s)",
          "user": {
            "type": "user",
            "login": "allisonis"
          },
          "labels": [
            {
              "id": "1658842398",
              "node_id": "MDU6TGFiZWwxNjU4ODQyMzk4",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/feature-request",
              "name": "feature-request",
              "color": "2a7eba",
              "description": "",
              "default": false
            },
            {
              "id": "1658610325",
              "node_id": "MDU6TGFiZWwxNjU4NjEwMzI1",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/secret/pki",
              "name": "secret/pki",
              "color": "59e560",
              "description": "",
              "default": false
            }
          ],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 3,
          "created_at": 1583489692000,
          "updated_at": 1595018400000,
          "author_association": "NONE",
          "body": "**Is your feature request related to a problem? Please describe.**\r\nWhen generating CA (if exported type) or leaf certificates in issued by Vault a user must manually manage private key and certificate data. Operators must go through multiple steps to safely store the private key, initial CSR, and all certificate data, etc.\r\n \r\nThere are cases where a user must load CA certificates generated by Vault into external systems.. When generating a intermediate with Vault using the [exported type](https://www.vaultproject.io/api-docs/secret/pki/#inlinecode-type-16) the CSR and private key are returned to the caller. This information must be stored in some way on the machine where the request originates from. Once the CSR is generated the caller must save the CSR to a file and send it to Vault in order to have the \"root\" [sign the intermediate](https://www.vaultproject.io/api-docs/secret/pki/#sign-intermediate) CSR. This creates a complicated dance of modifying and  managing CA certificate key material,  certificate data, and attempting to safely store it. \r\n\r\nTo support automation or to generally save the certificate and key material, users may write the data returned to the caller in a static vault path to pull from. \r\n\r\n**Describe the solution you'd like**\r\nWhen [generating an intermediate](https://www.vaultproject.io/api-docs/secret/pki/#generate-intermediate) or[ issuing a certificate](https://www.vaultproject.io/api-docs/secret/pki/#generate-certificate) a user should be able to paas a flag that would re direct the response from the request, i.e  csr and private_key, certificate data to a user specified Vault path(s).\r\n\r\nMany users or automated tooling will pull the sensitive key material from a secret path at run time. This feature would enable operators to not have to manually handle key material and certificates and but directly interact with Vault and improve the workflow overall. As well as reduce the risk associated with managing CA Certificates, or private keys manually. \r\n\r\nThis feature request  would improve the workflow for any type of certificate generation supported in the PKI backend. \r\n\r\nExample 1: \r\nGenerate CSR and private key and write output to a user specified Vault path using  a new param *output-vault-path*.\r\n\r\n```\r\nvault write pki_int/intermediate/generate/internal common_name=\"myvault.com Intermediate Authority\" ttl=43800h *output_vault_path=secret/pki/:name*\r\n```\r\n\r\nThe response containing the csr,and private_key would be written to specific vault paths under the user specified `output-vault-path`\r\n\r\nExample 2: \r\nSign intermediate  and write output to a user specified Vault path using  a new param *output-vault-path*. \r\nIn this example you could also allow a user to specify the previously defined path where the CSR was saved  in example 1  as a new `csr_path` parameter instead of a reference to a locally stored file.\r\n\r\n```\r\n$ vault write pki/root/sign-intermediate csr=@pki_int.csr OR *csr_path=secret/pki/:name/csr* use_csr_values=\"true\" *output-vault-path*=\"secret/pki/:name\" \r\n```\r\n\r\nThe response containing the certificate, expiration, ca_chain, issuing_ca, serial_number would be written to specific vault paths under the user specified `output-vault-path`\r\n\r\nExample 3:\r\nIssue certificate with new param *output-vault-path*\r\n\r\n```\r\n$ vault write pki_int/issue/example-dot-com \\\r\n    common_name=blah.example.com  \\\r\n    output-vault-path=\"secret/pki/:name\" \r\n```\r\n\r\nThe response containing the certificate, private_key, private_key_type, expiration, ca_chain issuing_ca, serial_number would be written to specific vault paths under the user specified `output-vault-path`\r\n\r\n\r\n**Explain any additional use-cases**\r\nAny PKI method that generates certificates or key material.\r\n* Generate Certificate: [ pki/issue/:name](https://www.vaultproject.io/api-docs/secret/pki/#generate-certificate)\r\n* Generating Intermediates:[/pki/intermediate/generate/:type](https://www.vaultproject.io/api-docs/secret/pki/#generate-intermediate)\r\n* Sign Intermediate:  [pki/root/sign](https://www.vaultproject.io/api-docs/secret/pki/#generate-certificate)\r\n",
          "events": [
            {
              "id": 3105999628,
              "created_at": 1583511827000,
              "event": "labeled",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3105999628",
              "actor": "catsby",
              "label": "feature-request"
            },
            {
              "id": 3106000166,
              "created_at": 1583511834000,
              "event": "labeled",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/events/3106000166",
              "actor": "catsby",
              "label": "secret/pki"
            },
            {
              "id": 597211341,
              "created_at": 1583861055000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/597211341",
              "actor": "drawks",
              "body": "This would be a cool feature. I will point out that you can use response wrapping to effectively do a very similar work flow to what you've detailed.",
              "user": "drawks",
              "html_url": "https://github.com/hashicorp/vault/issues/8486#issuecomment-597211341"
            },
            {
              "id": 597406719,
              "created_at": 1583892425000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/597406719",
              "actor": "allisonis",
              "body": "I have had to create tooling to handle this limitation but I think it could improve the security and usability of the PKI backend significantly! ",
              "user": "allisonis",
              "html_url": "https://github.com/hashicorp/vault/issues/8486#issuecomment-597406719"
            },
            {
              "id": 660327793,
              "created_at": 1595018400000,
              "event": "commented",
              "url": "https://api.github.com/repos/hashicorp/vault/issues/comments/660327793",
              "actor": "allisonis",
              "body": "bump",
              "user": "allisonis",
              "html_url": "https://github.com/hashicorp/vault/issues/8486#issuecomment-660327793"
            }
          ]
        },
        {
          "id": "659546238",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDUxMzc4Mjg0",
          "number": 9520,
          "html_url": "https://github.com/hashicorp/vault/pull/9520",
          "title": "UI/transit add missed algorithms follow up",
          "user": {
            "type": "user",
            "login": "noelledaley"
          },
          "labels": [
            {
              "id": "872623767",
              "node_id": "MDU6TGFiZWw4NzI2MjM3Njc=",
              "url": "https://api.github.com/repos/hashicorp/vault/labels/ui",
              "name": "ui",
              "color": "88e56e",
              "description": "",
              "default": false
            }
          ],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1595013105000,
          "updated_at": 1595018497000,
          "closed_at": 1595017540000,
          "author_association": "CONTRIBUTOR",
          "body": "# Show correct transit key version date\r\nThis PR is a follow up to https://github.com/hashicorp/vault/pull/9070, which adds the `aes128-gcm96`, `ecdsa-p384`, and `ecdsa-p521` transit key versions to the UI. The PR surfaced another bug where we were showing the incorrect timestamp on the transit key show page for the `aes128-gcm96` key type. To solve it, we updated the serializer to convert the timestamp to milliseconds (which is what our date helpers expect). We already have to do for several other key types as well. This [PR from last year](https://github.com/hashicorp/vault/pull/6827) fixes the same problem.\r\n\r\n## The Changes: Transit Keys\r\nThese transit key types are now shown in the UI. Without the fix, the timestamp for version 1 and 2 used to say \"more than 50 years ago\".\r\n![image](https://user-images.githubusercontent.com/903288/87818861-301df600-c820-11ea-99a2-4c90e8bbf129.png)\r\n\r\n![image](https://user-images.githubusercontent.com/903288/87818869-344a1380-c820-11ea-8239-9fcf9abaa79e.png)\r\n<img width=\"901\" alt=\"Screen Shot 2020-07-17 at 11 27 07 AM\" src=\"https://user-images.githubusercontent.com/903288/87819039-7410fb00-c820-11ea-949d-19fb592ea45b.png\">\r\n\r\n## Testing\r\nIn the UI, create each type of transit key. Navigate to the versions tab and rotate the encryption key. You should be able to see the version with the correct version timestamp.\r\n",
          "milestone": {
            "id": "5579414",
            "number": 74,
            "title": "1.4.4"
          },
          "events": []
        },
        {
          "id": "659621954",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDUxNDQ3MDI1",
          "number": 9524,
          "html_url": "https://github.com/hashicorp/vault/pull/9524",
          "title": "Ui/update datefns",
          "user": {
            "type": "user",
            "login": "noelledaley"
          },
          "labels": [],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1595018488000,
          "updated_at": 1595019425000,
          "author_association": "CONTRIBUTOR",
          "body": "# Update date-fns\r\nUpdate date-fns to 2.0.0 which requires us update all of our date-related helpers. The most notable change we had to account for is that all of the date-fns functions no longer accept strings as arguments. You'll notice we also had to switch some of the formatting arguments from `YYYY` to `yyyy` as a result. See the full list of breaking changes when upgrading to date-fns 2.0.0 [here](https://github.com/date-fns/date-fns/blob/master/CHANGELOG.md#changed-4).\r\n\r\n## Testing\r\nThis PR requires a considerable QA as it changes the behavior of our `date-from-now` and `date-format` helpers. We now return an empty string and console log an error if the formatting doesn't work, so there's a chance some dates may be missing in the UI.\r\n\r\nNavigate to the various pages of the UI where `date-format` or `date-from-now` is used, such as the replication secondaries add modal which displays the expiration date. These pages should still display the date as expected.\r\n\r\nHere's an example of the replication secondaries add modal:\r\n![image](https://user-images.githubusercontent.com/903288/87821711-28ad1b80-c825-11ea-893b-1201f657a345.png)\r\n",
          "events": []
        },
        {
          "id": "659634715",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDUxNDU4NDc0",
          "number": 9525,
          "html_url": "https://github.com/hashicorp/vault/pull/9525",
          "title": "Update documentation to support new OIDC mode parameter",
          "user": {
            "type": "user",
            "login": "broamski"
          },
          "labels": [],
          "state": "open",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1595019429000,
          "updated_at": 1595019429000,
          "author_association": "CONTRIBUTOR",
          "body": "Relies on https://github.com/hashicorp/vault-plugin-auth-jwt/pull/125",
          "events": []
        },
        {
          "id": "659599942",
          "node_id": "MDExOlB1bGxSZXF1ZXN0NDUxNDI3MDMz",
          "number": 9523,
          "html_url": "https://github.com/hashicorp/vault/pull/9523",
          "title": "Ui/upgrade date fns",
          "user": {
            "type": "user",
            "login": "noelledaley"
          },
          "labels": [],
          "state": "closed",
          "locked": false,
          "assignees": [],
          "comments": 0,
          "created_at": 1595016886000,
          "updated_at": 1595019454000,
          "closed_at": 1595019452000,
          "author_association": "CONTRIBUTOR",
          "body": "# Update date-fns\r\nUpdate date-fns to 2.0.0 which requires us update all of our date-related helpers. The most notable change we had to account for is that all of the date-fns functions no longer accept strings as arguments. You'll notice we also had to switch some of the formatting arguments from `YYYY` to `yyyy` as a result. See the full list of breaking changes when upgrading to date-fns 2.0.0 [here](https://github.com/date-fns/date-fns/blob/master/CHANGELOG.md#changed-4).\r\n\r\n## Testing\r\nThis PR requires a considerable QA as it changes the behavior of our `date-from-now` and `date-format` helpers. We now return an empty string and console log an error if the formatting doesn't work, so there's a chance some dates may be missing in the UI.\r\n\r\nNavigate to the various pages of the UI where `date-format` or `date-from-now` is used, such as the replication secondaries add modal which displays the expiration date. These pages should still display the date as expected.\r\n\r\nHere's an example of the replication secondaries add modal:\r\n![image](https://user-images.githubusercontent.com/903288/87821711-28ad1b80-c825-11ea-893b-1201f657a345.png)\r\n",
          "events": []
        }
      ]
    }
  ],
  "count": 1,
  "_metadata": {
    "integration_key": {
      "tenant_id": "foo",
      "integration_id": "140"
    },
    "integration_type": "github",
    "data_type": "issues",
    "page_number": 0
  }
}