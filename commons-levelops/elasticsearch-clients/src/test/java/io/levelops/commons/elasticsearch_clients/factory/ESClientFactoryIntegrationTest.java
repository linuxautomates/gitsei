package io.levelops.commons.elasticsearch_clients.factory;

import co.elastic.clients.elasticsearch.ElasticsearchClient;
import co.elastic.clients.elasticsearch._types.ElasticsearchException;
import co.elastic.clients.elasticsearch.indices.GetAliasResponse;
import co.elastic.clients.elasticsearch.indices.get_alias.IndexAliases;
import io.levelops.commons.elasticsearch_clients.models.ESClusterInfo;
import org.apache.commons.collections4.CollectionUtils;
import org.apache.commons.collections4.MapUtils;

import java.io.IOException;
import java.security.GeneralSecurityException;
import java.util.Arrays;
import java.util.Collections;
import java.util.HashSet;
import java.util.List;
import java.util.Map;
import java.util.Set;
import java.util.stream.Collectors;

public class ESClientFactoryIntegrationTest {
    public List<String> getAllIndexNamesForAlias (ElasticsearchClient esClient, final String aliasName) {
        try {
            boolean aliasExists = esClient.indices().existsAlias(r -> r.name(aliasName)).value();
            if(!aliasExists) {
                return Collections.EMPTY_LIST;
            }
            GetAliasResponse getAliasResponse = esClient.indices().getAlias(r -> r.name(aliasName));
            if(MapUtils.isEmpty(getAliasResponse.result())) {
                return Collections.EMPTY_LIST;
            }
            Set<String> indexNames = new HashSet<>();
            for (Map.Entry<String, IndexAliases> e : getAliasResponse.result().entrySet()) {
                String currentIndexName = e.getKey();
                Set<String> currentIndexAliasNames = MapUtils.emptyIfNull(e.getValue().aliases()).keySet();
                if(currentIndexAliasNames.contains(aliasName)) {
                    indexNames.add(currentIndexName);
                }
            }
            return CollectionUtils.emptyIfNull(indexNames).stream().collect(Collectors.toList());
        } catch (ElasticsearchException | IOException e) {
            System.out.println(e.toString());
            return Collections.EMPTY_LIST;
        }
    }

    public void deleteAllIndexes() throws GeneralSecurityException, IOException {
        String deleteIndexNamesString = "WORK_ITEMS_unitedlex_1651449600,WORK_ITEMS_ey_1651449600,WORK_ITEMS_abinbev_1651449600,WORK_ITEMS_unitedlex_1651276800,WORK_ITEMS_ey_1651276800,WORK_ITEMS_abinbev_1651276800,WORK_ITEMS_unitedlex_1651190400,WORK_ITEMS_ey_1651190400,WORK_ITEMS_abinbev_1651190400,WORK_ITEMS_unitedlex_1651104000,WORK_ITEMS_ey_1651104000,WORK_ITEMS_abinbev_1651104000,WORK_ITEMS_unitedlex_1651017600,WORK_ITEMS_ey_1651017600,WORK_ITEMS_abinbev_1651017600,WORK_ITEMS_unitedlex_1650931200,WORK_ITEMS_ey_1650931200,WORK_ITEMS_abinbev_1650931200,WORK_ITEMS_unitedlex_1650844800,WORK_ITEMS_ey_1650844800,WORK_ITEMS_abinbev_1650844800,WORK_ITEMS_unitedlex_1650758400,WORK_ITEMS_ey_1650758400,WORK_ITEMS_abinbev_1650758400,WORK_ITEMS_unitedlex_1650672000,WORK_ITEMS_ey_1650672000,WORK_ITEMS_abinbev_1650672000,WORK_ITEMS_unitedlex_1650585600,WORK_ITEMS_ey_1650585600,WORK_ITEMS_abinbev_1650585600,WORK_ITEMS_unitedlex_1650499200,WORK_ITEMS_ey_1650499200,WORK_ITEMS_abinbev_1650499200,WORK_ITEMS_unitedlex_1650412800,WORK_ITEMS_ey_1650412800,WORK_ITEMS_abinbev_1650412800,WORK_ITEMS_unitedlex_1650326400,WORK_ITEMS_ey_1650326400,WORK_ITEMS_abinbev_1650326400,WORK_ITEMS_unitedlex_1650240000,WORK_ITEMS_ey_1650240000,WORK_ITEMS_abinbev_1650240000,WORK_ITEMS_unitedlex_1650153600,WORK_ITEMS_ey_1650153600,WORK_ITEMS_abinbev_1650153600,WORK_ITEMS_unitedlex_1650067200,WORK_ITEMS_ey_1650067200,WORK_ITEMS_abinbev_1650067200,WORK_ITEMS_unitedlex_1649980800,WORK_ITEMS_ey_1649980800,WORK_ITEMS_abinbev_1649980800,WORK_ITEMS_unitedlex_1649894400,WORK_ITEMS_ey_1649894400,WORK_ITEMS_abinbev_1649894400,WORK_ITEMS_unitedlex_1649808000,WORK_ITEMS_ey_1649808000,WORK_ITEMS_abinbev_1649808000,WORK_ITEMS_unitedlex_1649721600,WORK_ITEMS_ey_1649721600,WORK_ITEMS_abinbev_1649721600,WORK_ITEMS_unitedlex_1649635200,WORK_ITEMS_ey_1649635200,WORK_ITEMS_abinbev_1649635200,WORK_ITEMS_unitedlex_1649548800,WORK_ITEMS_ey_1649548800,WORK_ITEMS_abinbev_1649548800,WORK_ITEMS_unitedlex_1649462400,WORK_ITEMS_ey_1649462400,WORK_ITEMS_abinbev_1649462400,WORK_ITEMS_unitedlex_1649376000,WORK_ITEMS_ey_1649376000,WORK_ITEMS_abinbev_1649376000,WORK_ITEMS_unitedlex_1649289600,WORK_ITEMS_ey_1649289600,WORK_ITEMS_abinbev_1649289600,WORK_ITEMS_unitedlex_1649203200,WORK_ITEMS_ey_1649203200,WORK_ITEMS_abinbev_1649203200,WORK_ITEMS_unitedlex_1649116800,WORK_ITEMS_ey_1649116800,WORK_ITEMS_abinbev_1649116800,WORK_ITEMS_unitedlex_1649030400,WORK_ITEMS_ey_1649030400,WORK_ITEMS_abinbev_1649030400,WORK_ITEMS_unitedlex_1648944000,WORK_ITEMS_ey_1648944000,WORK_ITEMS_abinbev_1648944000,WORK_ITEMS_unitedlex_1648857600,WORK_ITEMS_ey_1648857600,WORK_ITEMS_abinbev_1648857600,WORK_ITEMS_unitedlex_1648684800,WORK_ITEMS_ey_1648684800,WORK_ITEMS_abinbev_1648684800,WORK_ITEMS_unitedlex_1648598400,WORK_ITEMS_ey_1648598400,WORK_ITEMS_abinbev_1648598400,WORK_ITEMS_unitedlex_1648512000,WORK_ITEMS_ey_1648512000,WORK_ITEMS_abinbev_1648512000,WORK_ITEMS_unitedlex_1648425600,WORK_ITEMS_ey_1648425600,WORK_ITEMS_abinbev_1648425600,WORK_ITEMS_unitedlex_1648339200,WORK_ITEMS_ey_1648339200,WORK_ITEMS_abinbev_1648339200,WORK_ITEMS_unitedlex_1648252800,WORK_ITEMS_ey_1648252800,WORK_ITEMS_abinbev_1648252800,WORK_ITEMS_unitedlex_1648166400,WORK_ITEMS_ey_1648166400,WORK_ITEMS_abinbev_1648166400,WORK_ITEMS_unitedlex_1648080000,WORK_ITEMS_ey_1648080000,WORK_ITEMS_abinbev_1648080000,WORK_ITEMS_unitedlex_1647993600,WORK_ITEMS_ey_1647993600,WORK_ITEMS_abinbev_1647993600,WORK_ITEMS_unitedlex_1647907200,WORK_ITEMS_ey_1647907200,WORK_ITEMS_abinbev_1647907200,WORK_ITEMS_unitedlex_1647820800,WORK_ITEMS_ey_1647820800,WORK_ITEMS_abinbev_1647820800,WORK_ITEMS_unitedlex_1647734400,WORK_ITEMS_ey_1647734400,WORK_ITEMS_abinbev_1647734400,WORK_ITEMS_unitedlex_1647648000,WORK_ITEMS_ey_1647648000,WORK_ITEMS_abinbev_1647648000,WORK_ITEMS_unitedlex_1647561600,WORK_ITEMS_ey_1647561600,WORK_ITEMS_abinbev_1647561600,WORK_ITEMS_unitedlex_1647475200,WORK_ITEMS_ey_1647475200,WORK_ITEMS_abinbev_1647475200,WORK_ITEMS_unitedlex_1647388800,WORK_ITEMS_ey_1647388800,WORK_ITEMS_abinbev_1647388800,WORK_ITEMS_unitedlex_1647302400,WORK_ITEMS_ey_1647302400,WORK_ITEMS_abinbev_1647302400,WORK_ITEMS_unitedlex_1647216000,WORK_ITEMS_ey_1647216000,WORK_ITEMS_abinbev_1647216000,WORK_ITEMS_unitedlex_1647129600,WORK_ITEMS_ey_1647129600,WORK_ITEMS_abinbev_1647129600,WORK_ITEMS_unitedlex_1647043200,WORK_ITEMS_ey_1647043200,WORK_ITEMS_abinbev_1647043200,WORK_ITEMS_unitedlex_1646956800,WORK_ITEMS_ey_1646956800,WORK_ITEMS_abinbev_1646956800,WORK_ITEMS_unitedlex_1646870400,WORK_ITEMS_ey_1646870400,WORK_ITEMS_abinbev_1646870400,WORK_ITEMS_unitedlex_1646784000,WORK_ITEMS_ey_1646784000,WORK_ITEMS_abinbev_1646784000,WORK_ITEMS_unitedlex_1646697600,WORK_ITEMS_ey_1646697600,WORK_ITEMS_abinbev_1646697600,WORK_ITEMS_unitedlex_1646611200,WORK_ITEMS_abinbev_1646611200,WORK_ITEMS_unitedlex_1646524800,WORK_ITEMS_abinbev_1646524800,WORK_ITEMS_unitedlex_1646438400,WORK_ITEMS_abinbev_1646438400,WORK_ITEMS_unitedlex_1646352000,WORK_ITEMS_abinbev_1646352000,WORK_ITEMS_unitedlex_1646265600,WORK_ITEMS_ey_1646265600,WORK_ITEMS_abinbev_1646265600,WORK_ITEMS_unitedlex_1646179200,WORK_ITEMS_ey_1646179200,WORK_ITEMS_abinbev_1646179200,WORK_ITEMS_unitedlex_1646006400,WORK_ITEMS_ey_1646006400,WORK_ITEMS_abinbev_1646006400,WORK_ITEMS_unitedlex_1645920000,WORK_ITEMS_ey_1645920000,WORK_ITEMS_abinbev_1645920000,WORK_ITEMS_unitedlex_1645833600,WORK_ITEMS_ey_1645833600,WORK_ITEMS_abinbev_1645833600,WORK_ITEMS_unitedlex_1645747200,WORK_ITEMS_ey_1645747200,WORK_ITEMS_abinbev_1645747200,WORK_ITEMS_unitedlex_1645660800,WORK_ITEMS_ey_1645660800,WORK_ITEMS_abinbev_1645660800,WORK_ITEMS_unitedlex_1645574400,WORK_ITEMS_ey_1645574400,WORK_ITEMS_abinbev_1645574400,WORK_ITEMS_unitedlex_1645488000,WORK_ITEMS_ey_1645488000,WORK_ITEMS_abinbev_1645488000,WORK_ITEMS_unitedlex_1645401600,WORK_ITEMS_ey_1645401600,WORK_ITEMS_abinbev_1645401600,WORK_ITEMS_unitedlex_1645315200,WORK_ITEMS_ey_1645315200,WORK_ITEMS_abinbev_1645315200,WORK_ITEMS_unitedlex_1645228800,WORK_ITEMS_ey_1645228800,WORK_ITEMS_abinbev_1645228800,WORK_ITEMS_unitedlex_1645142400,WORK_ITEMS_ey_1645142400,WORK_ITEMS_abinbev_1645142400,WORK_ITEMS_unitedlex_1645056000,WORK_ITEMS_ey_1645056000,WORK_ITEMS_abinbev_1645056000,WORK_ITEMS_unitedlex_1644969600,WORK_ITEMS_ey_1644969600,WORK_ITEMS_abinbev_1644969600,WORK_ITEMS_unitedlex_1644883200,WORK_ITEMS_ey_1644883200,WORK_ITEMS_abinbev_1644883200,WORK_ITEMS_unitedlex_1644796800,WORK_ITEMS_ey_1644796800,WORK_ITEMS_abinbev_1644796800,WORK_ITEMS_unitedlex_1644710400,WORK_ITEMS_ey_1644710400,WORK_ITEMS_abinbev_1644710400,WORK_ITEMS_unitedlex_1644624000,WORK_ITEMS_ey_1644624000,WORK_ITEMS_abinbev_1644624000,WORK_ITEMS_unitedlex_1644537600,WORK_ITEMS_ey_1644537600,WORK_ITEMS_abinbev_1644537600,WORK_ITEMS_unitedlex_1644451200,WORK_ITEMS_ey_1644451200,WORK_ITEMS_abinbev_1644451200,WORK_ITEMS_unitedlex_1644364800,WORK_ITEMS_ey_1644364800,WORK_ITEMS_abinbev_1644364800,WORK_ITEMS_unitedlex_1644278400,WORK_ITEMS_ey_1644278400,WORK_ITEMS_abinbev_1644278400,WORK_ITEMS_unitedlex_1644192000,WORK_ITEMS_ey_1644192000,WORK_ITEMS_abinbev_1644192000,WORK_ITEMS_unitedlex_1644105600,WORK_ITEMS_ey_1644105600,WORK_ITEMS_abinbev_1644105600,WORK_ITEMS_unitedlex_1644019200,WORK_ITEMS_ey_1644019200,WORK_ITEMS_abinbev_1644019200,WORK_ITEMS_unitedlex_1643932800,WORK_ITEMS_ey_1643932800,WORK_ITEMS_abinbev_1643932800,WORK_ITEMS_unitedlex_1643846400,WORK_ITEMS_ey_1643846400,WORK_ITEMS_abinbev_1643846400,WORK_ITEMS_unitedlex_1643760000,WORK_ITEMS_ey_1643760000,WORK_ITEMS_abinbev_1643760000,WORK_ITEMS_unitedlex_1643587200,WORK_ITEMS_ey_1643587200,WORK_ITEMS_abinbev_1643587200,WORK_ITEMS_unitedlex_1643500800,WORK_ITEMS_ey_1643500800,WORK_ITEMS_abinbev_1643500800,WORK_ITEMS_unitedlex_1643414400,WORK_ITEMS_ey_1643414400,WORK_ITEMS_abinbev_1643414400,WORK_ITEMS_unitedlex_1643328000,WORK_ITEMS_ey_1643328000,WORK_ITEMS_abinbev_1643328000,WORK_ITEMS_unitedlex_1643241600,WORK_ITEMS_ey_1643241600,WORK_ITEMS_abinbev_1643241600,WORK_ITEMS_unitedlex_1643155200,WORK_ITEMS_ey_1643155200,WORK_ITEMS_abinbev_1643155200,WORK_ITEMS_unitedlex_1643068800,WORK_ITEMS_ey_1643068800,WORK_ITEMS_abinbev_1643068800,WORK_ITEMS_unitedlex_1642982400,WORK_ITEMS_ey_1642982400,WORK_ITEMS_abinbev_1642982400,WORK_ITEMS_unitedlex_1642896000,WORK_ITEMS_ey_1642896000,WORK_ITEMS_abinbev_1642896000,WORK_ITEMS_unitedlex_1642809600,WORK_ITEMS_ey_1642809600,WORK_ITEMS_abinbev_1642809600,WORK_ITEMS_unitedlex_1642723200,WORK_ITEMS_ey_1642723200,WORK_ITEMS_abinbev_1642723200,WORK_ITEMS_unitedlex_1642636800,WORK_ITEMS_ey_1642636800,WORK_ITEMS_abinbev_1642636800,WORK_ITEMS_unitedlex_1642550400,WORK_ITEMS_abinbev_1642550400,WORK_ITEMS_unitedlex_1642464000,WORK_ITEMS_abinbev_1642464000,WORK_ITEMS_unitedlex_1642377600,WORK_ITEMS_abinbev_1642377600,WORK_ITEMS_unitedlex_1642291200,WORK_ITEMS_abinbev_1642291200,WORK_ITEMS_unitedlex_1642204800,WORK_ITEMS_abinbev_1642204800,WORK_ITEMS_unitedlex_1642118400,WORK_ITEMS_abinbev_1642118400,WORK_ITEMS_unitedlex_1642032000,WORK_ITEMS_abinbev_1642032000,WORK_ITEMS_unitedlex_1641945600,WORK_ITEMS_abinbev_1641945600,WORK_ITEMS_unitedlex_1641859200,WORK_ITEMS_abinbev_1641859200,WORK_ITEMS_unitedlex_1641772800,WORK_ITEMS_abinbev_1641772800,WORK_ITEMS_unitedlex_1641686400,WORK_ITEMS_abinbev_1641686400,WORK_ITEMS_unitedlex_1641600000,WORK_ITEMS_abinbev_1641600000,WORK_ITEMS_unitedlex_1641513600,WORK_ITEMS_abinbev_1641513600,WORK_ITEMS_unitedlex_1641427200,WORK_ITEMS_abinbev_1641427200,WORK_ITEMS_unitedlex_1641340800,WORK_ITEMS_abinbev_1641340800,WORK_ITEMS_unitedlex_1641254400,WORK_ITEMS_abinbev_1641254400,WORK_ITEMS_unitedlex_1641168000,WORK_ITEMS_abinbev_1641168000,WORK_ITEMS_unitedlex_1641081600,WORK_ITEMS_abinbev_1641081600,WORK_ITEMS_unitedlex_1640908800,WORK_ITEMS_abinbev_1640908800,WORK_ITEMS_unitedlex_1640822400,WORK_ITEMS_abinbev_1640822400,WORK_ITEMS_unitedlex_1640736000,WORK_ITEMS_abinbev_1640736000,WORK_ITEMS_unitedlex_1640649600,WORK_ITEMS_abinbev_1640649600,WORK_ITEMS_unitedlex_1640563200,WORK_ITEMS_abinbev_1640563200,WORK_ITEMS_unitedlex_1640476800,WORK_ITEMS_abinbev_1640476800,WORK_ITEMS_unitedlex_1640390400,WORK_ITEMS_abinbev_1640390400,WORK_ITEMS_unitedlex_1640304000,WORK_ITEMS_abinbev_1640304000,WORK_ITEMS_unitedlex_1640217600,WORK_ITEMS_abinbev_1640217600,WORK_ITEMS_unitedlex_1640131200,WORK_ITEMS_abinbev_1640131200,WORK_ITEMS_unitedlex_1640044800,WORK_ITEMS_abinbev_1640044800,WORK_ITEMS_unitedlex_1639958400,WORK_ITEMS_abinbev_1639958400,WORK_ITEMS_unitedlex_1639872000,WORK_ITEMS_abinbev_1639872000,WORK_ITEMS_unitedlex_1639785600,WORK_ITEMS_abinbev_1639785600,WORK_ITEMS_unitedlex_1639699200,WORK_ITEMS_abinbev_1639699200,WORK_ITEMS_unitedlex_1639612800,WORK_ITEMS_abinbev_1639612800,WORK_ITEMS_unitedlex_1639526400,WORK_ITEMS_abinbev_1639526400,WORK_ITEMS_unitedlex_1639440000,WORK_ITEMS_abinbev_1639440000,WORK_ITEMS_unitedlex_1639353600,WORK_ITEMS_abinbev_1639353600,WORK_ITEMS_unitedlex_1639267200,WORK_ITEMS_abinbev_1639267200,WORK_ITEMS_unitedlex_1639180800,WORK_ITEMS_abinbev_1639180800,WORK_ITEMS_unitedlex_1639094400,WORK_ITEMS_abinbev_1639094400,WORK_ITEMS_unitedlex_1639008000,WORK_ITEMS_abinbev_1639008000,WORK_ITEMS_unitedlex_1638921600,WORK_ITEMS_abinbev_1638921600,WORK_ITEMS_unitedlex_1638835200,WORK_ITEMS_abinbev_1638835200,WORK_ITEMS_abinbev_1638748800,WORK_ITEMS_abinbev_1638662400,WORK_ITEMS_abinbev_1638576000,WORK_ITEMS_abinbev_1638489600,WORK_ITEMS_abinbev_1638403200,WORK_ITEMS_abinbev_1638230400,WORK_ITEMS_abinbev_1638144000,WORK_ITEMS_abinbev_1638057600,WORK_ITEMS_abinbev_1637971200,WORK_ITEMS_abinbev_1637884800,WORK_ITEMS_abinbev_1637798400,WORK_ITEMS_abinbev_1637712000,WORK_ITEMS_abinbev_1637625600,WORK_ITEMS_abinbev_1637539200,WORK_ITEMS_abinbev_1637452800,WORK_ITEMS_abinbev_1637366400,WORK_ITEMS_unitedlex_1637280000,WORK_ITEMS_abinbev_1637280000,WORK_ITEMS_unitedlex_1637193600,WORK_ITEMS_abinbev_1637193600,WORK_ITEMS_unitedlex_1637107200,WORK_ITEMS_abinbev_1637107200,WORK_ITEMS_unitedlex_1637020800,WORK_ITEMS_abinbev_1637020800,WORK_ITEMS_unitedlex_1636934400,WORK_ITEMS_abinbev_1636934400,WORK_ITEMS_unitedlex_1636848000,WORK_ITEMS_abinbev_1636848000,WORK_ITEMS_unitedlex_1636761600,WORK_ITEMS_abinbev_1636761600,WORK_ITEMS_unitedlex_1636675200,WORK_ITEMS_abinbev_1636675200,WORK_ITEMS_unitedlex_1636588800,WORK_ITEMS_abinbev_1636588800,WORK_ITEMS_unitedlex_1636502400,WORK_ITEMS_abinbev_1636502400,WORK_ITEMS_unitedlex_1636416000,WORK_ITEMS_abinbev_1636416000,WORK_ITEMS_unitedlex_1636329600,WORK_ITEMS_abinbev_1636329600,WORK_ITEMS_unitedlex_1636243200,WORK_ITEMS_abinbev_1636243200,WORK_ITEMS_unitedlex_1636156800,WORK_ITEMS_abinbev_1636156800,WORK_ITEMS_unitedlex_1636070400,WORK_ITEMS_abinbev_1636070400,WORK_ITEMS_unitedlex_1635984000,WORK_ITEMS_abinbev_1635984000,WORK_ITEMS_unitedlex_1635897600,WORK_ITEMS_abinbev_1635897600,WORK_ITEMS_unitedlex_1635811200,WORK_ITEMS_abinbev_1635811200,WORK_ITEMS_unitedlex_1635638400,WORK_ITEMS_abinbev_1635638400,WORK_ITEMS_unitedlex_1635552000,WORK_ITEMS_abinbev_1635552000,WORK_ITEMS_unitedlex_1635465600,WORK_ITEMS_abinbev_1635465600,WORK_ITEMS_unitedlex_1635379200,WORK_ITEMS_abinbev_1635379200,WORK_ITEMS_unitedlex_1635292800,WORK_ITEMS_abinbev_1635292800,WORK_ITEMS_unitedlex_1635206400,WORK_ITEMS_abinbev_1635206400,WORK_ITEMS_unitedlex_1635120000,WORK_ITEMS_abinbev_1635120000,WORK_ITEMS_unitedlex_1635033600,WORK_ITEMS_abinbev_1635033600,WORK_ITEMS_unitedlex_1634947200,WORK_ITEMS_abinbev_1634947200,WORK_ITEMS_unitedlex_1634860800,WORK_ITEMS_abinbev_1634860800,WORK_ITEMS_unitedlex_1634774400,WORK_ITEMS_abinbev_1634774400,WORK_ITEMS_unitedlex_1634688000,WORK_ITEMS_abinbev_1634688000,WORK_ITEMS_unitedlex_1634601600,WORK_ITEMS_abinbev_1634601600,WORK_ITEMS_unitedlex_1634515200,WORK_ITEMS_abinbev_1634515200,WORK_ITEMS_unitedlex_1634428800,WORK_ITEMS_abinbev_1634428800,WORK_ITEMS_unitedlex_1634342400,WORK_ITEMS_abinbev_1634342400,WORK_ITEMS_unitedlex_1634256000,WORK_ITEMS_abinbev_1634256000,WORK_ITEMS_unitedlex_1634169600,WORK_ITEMS_abinbev_1634169600,WORK_ITEMS_unitedlex_1634083200,WORK_ITEMS_abinbev_1634083200,WORK_ITEMS_unitedlex_1633996800,WORK_ITEMS_abinbev_1633996800,WORK_ITEMS_unitedlex_1633910400,WORK_ITEMS_abinbev_1633910400,WORK_ITEMS_unitedlex_1633824000,WORK_ITEMS_abinbev_1633824000,WORK_ITEMS_unitedlex_1633737600,WORK_ITEMS_abinbev_1633737600,WORK_ITEMS_unitedlex_1633651200,WORK_ITEMS_abinbev_1633651200,WORK_ITEMS_unitedlex_1633564800,WORK_ITEMS_abinbev_1633564800,WORK_ITEMS_unitedlex_1633478400,WORK_ITEMS_abinbev_1633478400,WORK_ITEMS_unitedlex_1633392000,WORK_ITEMS_abinbev_1633392000,WORK_ITEMS_unitedlex_1633305600,WORK_ITEMS_abinbev_1633305600,WORK_ITEMS_unitedlex_1633219200,WORK_ITEMS_abinbev_1633219200,WORK_ITEMS_unitedlex_1633132800,WORK_ITEMS_abinbev_1633132800,WORK_ITEMS_unitedlex_1632960000,WORK_ITEMS_abinbev_1632960000,WORK_ITEMS_unitedlex_1632873600,WORK_ITEMS_abinbev_1632873600,WORK_ITEMS_unitedlex_1632787200,WORK_ITEMS_abinbev_1632787200,WORK_ITEMS_unitedlex_1632700800,WORK_ITEMS_abinbev_1632700800,WORK_ITEMS_unitedlex_1632614400,WORK_ITEMS_abinbev_1632614400,WORK_ITEMS_unitedlex_1632528000,WORK_ITEMS_abinbev_1632528000,WORK_ITEMS_unitedlex_1632441600,WORK_ITEMS_abinbev_1632441600,WORK_ITEMS_unitedlex_1632355200,WORK_ITEMS_abinbev_1632355200,WORK_ITEMS_unitedlex_1632268800,WORK_ITEMS_unitedlex_1632182400,WORK_ITEMS_abinbev_1632182400,WORK_ITEMS_unitedlex_1632096000,WORK_ITEMS_abinbev_1632096000,WORK_ITEMS_unitedlex_1632009600,WORK_ITEMS_abinbev_1632009600,WORK_ITEMS_unitedlex_1631923200,WORK_ITEMS_abinbev_1631923200,WORK_ITEMS_unitedlex_1631836800,WORK_ITEMS_abinbev_1631836800,WORK_ITEMS_abinbev_1631750400,WORK_ITEMS_abinbev_1631664000,WORK_ITEMS_abinbev_1631577600,WORK_ITEMS_abinbev_1631491200,WORK_ITEMS_abinbev_1631232000,WORK_ITEMS_abinbev_1631145600,WORK_ITEMS_abinbev_1631059200,WORK_ITEMS_abinbev_1630972800,WORK_ITEMS_abinbev_1630886400,WORK_ITEMS_abinbev_1630800000,WORK_ITEMS_abinbev_1630713600,WORK_ITEMS_abinbev_1630627200,WORK_ITEMS_abinbev_1630540800,WORK_ITEMS_abinbev_1630368000,WORK_ITEMS_abinbev_1630281600,WORK_ITEMS_abinbev_1630195200,WORK_ITEMS_abinbev_1630108800,WORK_ITEMS_abinbev_1630022400,WORK_ITEMS_abinbev_1629936000,WORK_ITEMS_abinbev_1629849600,WORK_ITEMS_abinbev_1629763200";
        List<String> deleteIndexNames = Arrays.asList(deleteIndexNamesString.split(","));

        ESClusterInfo esClusterInfo1 = ESClusterInfo.builder()
                .name("CLUSTER_1")
                .ipAddresses(List.of("cluster1-es-http.default.es.local")).port(9200)
                .userName("elastic").password("pass_1")
                .defaultCluster(true)
                .sslCertPath("cert1.crt")
                .build();
        ESClusterInfo esClusterInfo2 = ESClusterInfo.builder()
                .name("CLUSTER_2")
                .ipAddresses(List.of("cluster2-es-http.default.es.local")).port(9200)
                .userName("elastic").password("pass_2")
                .defaultCluster(false)
                .sslCertPath("cert2.crt")
                .build();
        ESClientFactory esClientFactory = new ESClientFactory(List.of(esClusterInfo1, esClusterInfo2));
        ElasticsearchClient elasticsearchClient = esClientFactory.getESClient("foo");
//        GetIndexResponse response = elasticsearchClient.indices().get(r -> r
//                .index("*")
//                .expandWildcards(ExpandWildcard.All));

        for (String deleteIndexName : deleteIndexNames ) {
            System.out.println("Before " + deleteIndexName);
            boolean indexExists = elasticsearchClient.indices().exists(r -> r.index(deleteIndexName)).value();
            System.out.println(deleteIndexName + " Exists " + indexExists);
            if(indexExists) {
//                elasticsearchClient.indices().delete(r -> r
//                        .index(deleteIndexName));
            }
            System.out.println("After " + deleteIndexName);
        }
    }
}