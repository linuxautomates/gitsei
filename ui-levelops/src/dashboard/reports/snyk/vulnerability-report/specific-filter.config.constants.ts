import { WIDGET_CONFIGURATION_KEYS } from "constants/widgets";
import UniversalInputTimeRangeWrapper from "dashboard/graph-filters/components/GenericFilterComponents/UniversalInputTimeRangeWrapper";
import UniversalSelectFilterWrapper from "dashboard/graph-filters/components/GenericFilterComponents/UniversalSelectFilterWrapper";
import { withDeleteAPIProps } from "dashboard/report-filters/common/common-api-filter-props";
import { get } from "lodash";
import { DropDownData, LevelOpsFilter } from "model/filters/levelopsFilters";
import { STACK_FILTERS } from "./constants";

export const StackFilterConfig: LevelOpsFilter = {
  id: "stacks",
  renderComponent: UniversalSelectFilterWrapper,
  label: "Stacks",
  beKey: "stacks",
  labelCase: "title_case",
  filterMetaData: {
    clearSupport: true,
    options: args => {
      const { allFilters } = args;
      const across = get(allFilters, ["across"], "");
      return STACK_FILTERS.filter(item => item.value !== across);
    },
    sortOptions: true
  } as DropDownData,
  tab: WIDGET_CONFIGURATION_KEYS.AGGREGATIONS
};

export const PriorityScoreFilterConfig: LevelOpsFilter = {
  id: "priority_score",
  renderComponent: UniversalInputTimeRangeWrapper,
  label: "Priority Score",
  beKey: "score_range",
  labelCase: "none",
  deleteSupport: true,
  apiFilterProps: args => ({ withDelete: withDeleteAPIProps(args) }),
  filterMetaData: {
    greaterThanKey: "$gt",
    lessThanKey: "$lt"
  },
  tab: WIDGET_CONFIGURATION_KEYS.FILTERS
};
