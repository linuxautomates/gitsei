import { nccGroupIssuesReportTransform } from "custom-hooks/helpers/helper";
import { REPORT_FILTERS_CONFIG, TIME_FILTER_RANGE_CHOICE_MAPPER } from "dashboard/constants/applications/names";
import { nccGroupDrilldown } from "dashboard/constants/drilldown.constants";
import { nccGroupReportSupportedFilters } from "dashboard/constants/supported-filters.constant";
import { ChartContainerType } from "dashboard/helpers/helper";
import { VulnerabilityReportType } from "model/report/ncc-group/vulnerability-report/vulnerabilityReport.constants";
import { ChartType } from "shared-resources/containers/chart-container/ChartType";
import {
  nccGroupVulnerabilityReportChartTypes,
  nccGroupVulnerabilityReportTimeFilterRangeChoiceMapper
} from "./constants";
import { VulnerabilityReportFiltersConfig } from "./filters.config";

const nccGroupVulnerabilityReport: { ncc_group_vulnerability_report: VulnerabilityReportType } = {
  ncc_group_vulnerability_report: {
    name: "NCC Group Vulnerability Report",
    application: "nccgroup",
    chart_type: ChartType?.BAR,
    chart_container: ChartContainerType.WIDGET_API_WRAPPER,
    uri: "ncc_group_issues_aggs",
    method: "list",
    filters: {},
    stack_filters: ["project", "risk", "category", "component", "tag"],
    defaultAcross: "category",
    chart_props: nccGroupVulnerabilityReportChartTypes,
    supported_filters: nccGroupReportSupportedFilters,
    xaxis: true,
    drilldown: nccGroupDrilldown,
    across: ["project", "risk", "category", "component", "tag"],
    [REPORT_FILTERS_CONFIG]: VulnerabilityReportFiltersConfig,
    [TIME_FILTER_RANGE_CHOICE_MAPPER]: nccGroupVulnerabilityReportTimeFilterRangeChoiceMapper,
    transformFunction: data => nccGroupIssuesReportTransform(data)
  }
};

export default nccGroupVulnerabilityReport;
