import { MICROSOFT_ISSUES_REPORT } from "constants/restUri";
import { microsoftIssuesReportTransformer } from "custom-hooks/helpers/helper";
import { MICROSOFT_APPLICATION_NAME, MICROSOFT_ISSUES_REPORT_NAME } from "dashboard/constants/applications/names";
import { microsoftDrilldown } from "dashboard/constants/drilldown.constants";
import { microsoftIssueSupportedFilters } from "dashboard/constants/supported-filters.constant";
import { ChartContainerType } from "dashboard/helpers/helper";
import { VulnerabilityReportType } from "model/report/microsoft/vulnerability-report/vulnerabilityReport.constants";
import { ChartType } from "shared-resources/containers/chart-container/ChartType";
import { MicrosoftVulnerabilityReportChartTypes } from "./constants";

const MicrosoftVulnerabilityReport: { [MICROSOFT_ISSUES_REPORT_NAME]: VulnerabilityReportType } = {
  [MICROSOFT_ISSUES_REPORT_NAME]: {
    name: "Microsoft Threat Modeling Issues Report",
    application: MICROSOFT_APPLICATION_NAME,
    chart_type: ChartType?.BAR,
    chart_container: ChartContainerType.WIDGET_API_WRAPPER,
    xaxis: true,
    show_max: true,
    stack_filters: ["category", "priority", "tag", "project"],
    across: ["category", "priority", "tag", "project"],
    defaultAcross: "category",
    chart_props: MicrosoftVulnerabilityReportChartTypes,
    uri: MICROSOFT_ISSUES_REPORT,
    method: "list",
    filters: {},
    supported_filters: microsoftIssueSupportedFilters,
    last_n_max_limit: 50,
    transformFunction: microsoftIssuesReportTransformer,
    drilldown: microsoftDrilldown
  }
};

export default MicrosoftVulnerabilityReport;
